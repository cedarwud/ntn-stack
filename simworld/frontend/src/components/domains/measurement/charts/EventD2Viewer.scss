/**
 * Event D2 Viewer Styles
 * 專為 D2 移動參考位置事件設計的樣式
 * 與 A4 樣式有所區別，突出 D2 的雙距離測量特性
 */

.event-d2-viewer {
    display: flex;
    flex-direction: column;
    height: 100vh;
    background: var(--background-primary);
    color: var(--text-primary);
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    overflow: hidden;

    .d2-viewer__content {
        display: flex;
        flex: 1;
        gap: 16px;
        padding: 16px;
        overflow: hidden;

        // 控制面板 - D2 專用配色
        .event-viewer__controls {
            flex: 0 0 350px;
            background: linear-gradient(135deg, 
                rgba(45, 55, 72, 0.95) 0%,
                rgba(74, 85, 104, 0.9) 100%);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-y: auto;
            max-height: calc(100vh - 32px);

            .control-panel {
                display: flex;
                flex-direction: column;
                gap: 24px;

                .control-section {
                    background: rgba(255, 255, 255, 0.05);
                    border-radius: 8px;
                    padding: 16px;
                    border: 1px solid rgba(255, 255, 255, 0.1);

                    &__title {
                        font-size: 16px;
                        font-weight: 600;
                        margin: 0 0 16px 0;
                        color: #E2E8F0;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }

                    .control-group {
                        margin-bottom: 16px;

                        &:last-child {
                            margin-bottom: 0;
                        }

                        &--buttons {
                            display: flex;
                            flex-wrap: wrap;
                            gap: 8px;
                        }

                        .control-item {
                            display: flex;
                            flex-direction: column;
                            gap: 8px;

                            .control-label {
                                font-size: 14px;
                                font-weight: 500;
                                color: #CBD5E0;
                            }

                            .control-input {
                                padding: 8px 12px;
                                border-radius: 6px;
                                border: 1px solid rgba(255, 255, 255, 0.2);
                                background: rgba(255, 255, 255, 0.1);
                                color: white;
                                font-size: 14px;
                                transition: all 0.2s ease;

                                &:focus {
                                    outline: none;
                                    border-color: #4FC3F7;
                                    background: rgba(255, 255, 255, 0.15);
                                    box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.2);
                                }
                            }

                            .control-select {
                                @extend .control-input;
                            }

                            .control-unit {
                                font-size: 12px;
                                color: #A0AEC0;
                                font-weight: 500;
                            }
                        }

                        .control-btn {
                            padding: 8px 16px;
                            border-radius: 6px;
                            border: 1px solid rgba(255, 255, 255, 0.2);
                            background: rgba(255, 255, 255, 0.1);
                            color: #E2E8F0;
                            font-size: 13px;
                            font-weight: 500;
                            cursor: pointer;
                            transition: all 0.2s ease;
                            backdrop-filter: blur(5px);

                            &:hover {
                                background: rgba(255, 255, 255, 0.2);
                                border-color: rgba(255, 255, 255, 0.3);
                                transform: translateY(-1px);
                            }

                            &--active {
                                background: linear-gradient(135deg, #4FC3F7 0%, #29B6F6 100%);
                                border-color: #4FC3F7;
                                color: white;
                                box-shadow: 0 2px 8px rgba(79, 195, 247, 0.3);
                            }
                        }
                    }

                    // D2 專用：模式描述區域
                    .mode-description {
                        background: rgba(79, 195, 247, 0.1);
                        border: 1px solid rgba(79, 195, 247, 0.3);
                        border-radius: 8px;
                        padding: 12px;
                        margin-bottom: 16px;

                        .mode-description-text {
                            font-size: 13px;
                            line-height: 1.5;
                            color: #E2E8F0;
                            margin: 0 0 8px 0;
                        }

                        .mode-indicator {
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            font-size: 12px;
                            color: #CBD5E0;

                            .mode-badge {
                                background: #4FC3F7;
                                color: white;
                                padding: 2px 8px;
                                border-radius: 4px;
                                font-weight: 600;
                                text-transform: uppercase;
                                font-size: 10px;
                            }
                        }
                    }
                }
            }
        }

        // 圖表區域 - D2 專用樣式
        .event-viewer__chart {
            flex: 1;
            background: rgba(30, 41, 59, 0.8);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;

            // D2 特有：雙 Y 軸圖表容器
            .d2-chart-container {
                height: 100%;
                position: relative;

                // 左 Y 軸標籤（衛星距離）
                .y-axis-left-label {
                    position: absolute;
                    left: 10px;
                    top: 50%;
                    transform: rotate(-90deg) translateY(-50%);
                    transform-origin: center;
                    color: #28A745;
                    font-weight: 600;
                    font-size: 14px;
                    white-space: nowrap;
                }

                // 右 Y 軸標籤（地面距離）
                .y-axis-right-label {
                    position: absolute;
                    right: 10px;
                    top: 50%;
                    transform: rotate(90deg) translateY(-50%);
                    transform-origin: center;
                    color: #FD7E14;
                    font-weight: 600;
                    font-size: 14px;
                    white-space: nowrap;
                }
            }

            // 數據模式指示器
            .data-mode-indicator {
                position: absolute;
                top: 10px;
                right: 10px;
                padding: 6px 12px;
                border-radius: 6px;
                font-size: 11px;
                font-weight: 600;
                backdrop-filter: blur(5px);

                &--simulation {
                    background: rgba(0, 123, 255, 0.8);
                    color: white;
                    border: 1px solid #007BFF;
                }

                &--real-data {
                    background: rgba(40, 167, 69, 0.8);
                    color: white;
                    border: 1px solid #28A745;
                }
            }
        }
    }

    // 響應式設計
    @media (max-width: 1024px) {
        .d2-viewer__content {
            flex-direction: column;
            
            .event-viewer__controls {
                flex: 0 0 auto;
                max-height: 300px;
            }
        }
    }

    @media (max-width: 768px) {
        .d2-viewer__content {
            padding: 12px;
            gap: 12px;

            .event-viewer__controls {
                .control-panel {
                    gap: 16px;

                    .control-section {
                        padding: 12px;

                        .control-group--buttons {
                            .control-btn {
                                font-size: 12px;
                                padding: 6px 12px;
                            }
                        }
                    }
                }
            }
        }
    }
}

// 暗色主題變數
:root {
    --background-primary: #0F172A;
    --background-secondary: #1E293B;
    --text-primary: #F1F5F9;
    --text-secondary: #CBD5E0;
    --accent-primary: #4FC3F7;
    --accent-secondary: #29B6F6;
}

// 亮色主題支持
[data-theme="light"] {
    .event-d2-viewer {
        --background-primary: #F8FAFC;
        --background-secondary: #FFFFFF;
        --text-primary: #1A202C;
        --text-secondary: #4A5568;

        .d2-viewer__content {
            .event-viewer__controls {
                background: linear-gradient(135deg, 
                    rgba(255, 255, 255, 0.95) 0%,
                    rgba(248, 250, 252, 0.9) 100%);
                border: 1px solid rgba(0, 0, 0, 0.1);
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);

                .control-section {
                    background: rgba(0, 0, 0, 0.02);
                    border: 1px solid rgba(0, 0, 0, 0.05);

                    &__title {
                        color: #2D3748;
                    }

                    .control-item {
                        .control-label {
                            color: #4A5568;
                        }

                        .control-input {
                            background: rgba(0, 0, 0, 0.05);
                            border: 1px solid rgba(0, 0, 0, 0.1);
                            color: #2D3748;
                        }
                    }

                    .control-btn {
                        background: rgba(0, 0, 0, 0.05);
                        border: 1px solid rgba(0, 0, 0, 0.1);
                        color: #4A5568;
                    }
                }
            }

            .event-viewer__chart {
                background: rgba(255, 255, 255, 0.8);
                border: 1px solid rgba(0, 0, 0, 0.1);
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            }
        }
    }
}