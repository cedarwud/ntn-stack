/**
 * VisualizationSection 組件樣式 - 深色系主題
 * 用於決策透明化和視覺化分析
 */

.visualization-section {
  display: flex;
  flex-direction: column;
  gap: 24px;
  height: 100%;
  background: #1a1a1a;
  color: #e5e7eb;
}

/* Phase 3 整合標識 */
.phase3-badge {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background: linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%);
  border-radius: 8px;
  color: white;
  font-weight: 600;
  margin-bottom: 16px;

  .badge-icon {
    font-size: 1.25rem;
  }

  .badge-text {
    flex: 1;
    font-size: 0.9rem;
  }

  .badge-status {
    background: rgba(255, 255, 255, 0.2);
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.75rem;
  }
}

/* 視覺化選項卡 */
.visualization-tabs {
  .tabs-nav {
    display: flex;
    gap: 8px;
    margin-bottom: 24px;
    border-bottom: 1px solid #444444;

    .vis-tab {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      background: transparent;
      border: none;
      border-radius: 8px 8px 0 0;
      color: #9ca3af;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.2s ease;
      position: relative;

      &:hover {
        background: #374151;
        color: #d1d5db;
      }

      &--active {
        background: #2a2a2a;
        color: #e5e7eb;
        border: 1px solid #444444;
        border-bottom: 1px solid #2a2a2a;

        &::after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          right: 0;
          height: 2px;
          background: #7c3aed;
        }
      }

      .tab-icon {
        font-size: 1.1rem;
      }
    }
  }

  .tab-content {
    min-height: 400px;
  }
}

/* 特徵重要性視覺化 */
.feature-importance-viz {
  .importance-chart {
    background: #2a2a2a;
    border: 1px solid #444444;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 16px;

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;

      .chart-title {
        margin: 0;
        font-size: 1.125rem;
        font-weight: 600;
        color: #e5e7eb;
      }

      .chart-meta {
        font-size: 0.75rem;
        color: #9ca3af;
      }
    }

    .features-list {
      display: flex;
      flex-direction: column;
      gap: 12px;

      .feature-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: #374151;
        border-radius: 8px;

        .feature-label {
          min-width: 150px;
          font-weight: 500;
          color: #e5e7eb;
        }

        .importance-bar {
          flex: 1;
          height: 8px;
          background: #4b5563;
          border-radius: 4px;
          overflow: hidden;
          position: relative;

          .importance-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #1d4ed8);
            border-radius: 4px;
            transition: width 0.5s ease;
          }
        }

        .importance-value {
          min-width: 60px;
          text-align: right;
          font-weight: 600;
          color: #3b82f6;
        }
      }
    }
  }
}

/* 決策解釋視覺化 */
.decision-explanation-viz {
  .explanation-card {
    background: #2a2a2a;
    border: 1px solid #444444;
    border-radius: 12px;
    padding: 20px;

    .explanation-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #444444;

      .explanation-title {
        margin: 0;
        font-size: 1.125rem;
        font-weight: 600;
        color: #e5e7eb;
      }

      .confidence-badge {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 6px 12px;
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        border-radius: 12px;
        color: white;
        font-size: 0.875rem;
        font-weight: 600;

        .confidence-icon {
          font-size: 1rem;
        }
      }
    }

    .decision-details {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;

      .detail-section {
        .detail-title {
          margin: 0 0 12px 0;
          font-size: 1rem;
          font-weight: 600;
          color: #d1d5db;
        }

        .detail-content {
          background: #374151;
          border-radius: 8px;
          padding: 12px;

          .input-features {
            display: flex;
            flex-direction: column;
            gap: 8px;

            .feature-input {
              display: flex;
              justify-content: space-between;
              align-items: center;
              font-size: 0.875rem;

              .feature-name {
                color: #9ca3af;
              }

              .feature-value {
                font-weight: 600;
                color: #e5e7eb;
              }
            }
          }

          .output-action {
            text-align: center;

            .action-value {
              font-size: 1.25rem;
              font-weight: 700;
              color: #fbbf24;
              margin-bottom: 8px;
            }

            .action-description {
              font-size: 0.875rem;
              color: #9ca3af;
            }
          }
        }
      }
    }

    .reasoning-section {
      .reasoning-title {
        margin: 0 0 12px 0;
        font-size: 1rem;
        font-weight: 600;
        color: #d1d5db;
      }

      .decision-path {
        display: flex;
        flex-direction: column;
        gap: 12px;

        .path-step {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px;
          background: #374151;
          border-radius: 8px;
          border-left: 4px solid #7c3aed;

          .step-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: #7c3aed;
            color: white;
            border-radius: 50%;
            font-size: 0.75rem;
            font-weight: 700;
          }

          .step-content {
            flex: 1;

            .step-description {
              font-size: 0.875rem;
              color: #e5e7eb;
              margin-bottom: 4px;
            }

            .step-reasoning {
              font-size: 0.75rem;
              color: #9ca3af;
            }
          }
        }
      }
    }
  }
}

/* 算法比較雷達圖 */
.algorithm-comparison-radar {
  .radar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;

    .radar-title {
      margin: 0;
      font-size: 1.125rem;
      font-weight: 600;
      color: #e5e7eb;
    }

    .algorithms-legend {
      display: flex;
      gap: 16px;

      .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;

        .legend-color {
          width: 12px;
          height: 12px;
          border-radius: 2px;
        }

        .legend-name {
          font-size: 0.875rem;
          font-weight: 500;
          color: #d1d5db;
        }
      }
    }
  }

  .radar-container {
    background: #2a2a2a;
    border: 1px solid #444444;
    border-radius: 12px;
    padding: 20px;

    .metrics-comparison-table {
      .table-header {
        display: grid;
        grid-template-columns: 150px repeat(3, 1fr);
        gap: 16px;
        padding: 12px 0;
        border-bottom: 2px solid #444444;
        margin-bottom: 12px;

        .metric-col,
        .algo-col {
          font-weight: 600;
          color: #d1d5db;
          text-align: center;
        }

        .metric-col {
          text-align: left;
        }
      }

      .table-row {
        display: grid;
        grid-template-columns: 150px repeat(3, 1fr);
        gap: 16px;
        padding: 12px 0;
        border-bottom: 1px solid #374151;

        &:last-child {
          border-bottom: none;
        }

        .metric-col {
          font-weight: 500;
          color: #e5e7eb;
        }

        .algo-col {
          text-align: center;

          .performance-cell {
            display: flex;
            align-items: center;
            gap: 8px;

            .performance-bar {
              flex: 1;
              height: 8px;
              background: #4b5563;
              border-radius: 4px;
              overflow: hidden;
              position: relative;
            }

            .performance-value {
              min-width: 40px;
              font-size: 0.875rem;
              font-weight: 600;
            }
          }
        }
      }
    }
  }
}

/* 佔位符視覺化 */
.placeholder-visualization {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 300px;
  background: #2a2a2a;
  border: 2px dashed #444444;
  border-radius: 12px;

  .placeholder-content {
    text-align: center;
    max-width: 400px;

    .placeholder-icon {
      font-size: 3rem;
      margin-bottom: 16px;
    }

    .placeholder-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: #e5e7eb;
      margin-bottom: 12px;
    }

    .placeholder-text {
      font-size: 0.875rem;
      color: #9ca3af;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .generate-btn {
      padding: 12px 24px;
      background: linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;

      &:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
      }

      &:disabled {
        opacity: 0.6;
        transform: none;
        cursor: not-allowed;
      }
    }
  }
}

/* 視覺化說明卡片 */
.visualization-info {
  .info-card {
    background: #2a2a2a;
    border: 1px solid #444444;
    border-radius: 12px;
    padding: 20px;

    .info-title {
      margin: 0 0 16px 0;
      font-size: 1.125rem;
      font-weight: 600;
      color: #e5e7eb;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .info-content {
      p {
        margin: 0 0 12px 0;
        font-size: 0.875rem;
        line-height: 1.6;
        color: #d1d5db;

        &:last-child {
          margin-bottom: 0;
        }

        strong {
          color: #fbbf24;
          font-weight: 600;
        }
      }
    }
  }
}

/* 響應式設計 */
@media (max-width: 768px) {
  .visualization-tabs .tabs-nav {
    flex-direction: column;
    gap: 4px;

    .vis-tab {
      border-radius: 8px;
      border: 1px solid #444444;

      &--active {
        border-radius: 8px;

        &::after {
          display: none;
        }
      }
    }
  }

  .decision-explanation-viz .explanation-card .decision-details {
    grid-template-columns: 1fr;
  }

  .algorithm-comparison-radar .radar-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }

  .metrics-comparison-table {
    .table-header,
    .table-row {
      grid-template-columns: 1fr;
      gap: 8px;

      .algo-col .performance-cell {
        justify-content: space-between;
      }
    }
  }
}

/* 動畫效果 */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.tab-content > * {
  animation: fadeIn 0.3s ease-out;
} 