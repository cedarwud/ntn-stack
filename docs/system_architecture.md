# ğŸ—ï¸ NTN Stack ç³»çµ±æ¶æ§‹ç¸½è¦½

**ç‰ˆæœ¬**: 3.0.0  
**æ›´æ–°æ—¥æœŸ**: 2025-08-18  
**å°ˆæ¡ˆç‹€æ…‹**: âœ… ç”Ÿç”¢å°±ç·’  
**é©ç”¨æ–¼**: LEO è¡›æ˜Ÿåˆ‡æ›ç ”ç©¶ç³»çµ±

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æª”æä¾› NTN Stack LEO è¡›æ˜Ÿåˆ‡æ›ç ”ç©¶ç³»çµ±çš„**å®Œæ•´æ¶æ§‹è¨­è¨ˆ**ã€Docker é…ç½®å’Œçµ„ä»¶åˆ†å·¥ã€‚ç³»çµ±æ¡ç”¨ Pure Cron é©…å‹•æ¶æ§‹ï¼Œå¯¦ç¾çœŸå¯¦æ•¸æ“šé©…å‹•çš„è¡›æ˜Ÿæ›æ‰‹ç ”ç©¶å¹³å°ã€‚

**ğŸ“‹ ç›¸é—œæ–‡æª”**ï¼š
- **æ•¸æ“šè™•ç†æµç¨‹**ï¼š[æ•¸æ“šè™•ç†æµç¨‹](./data_processing_flow.md) - å…­éšæ®µè™•ç†ç´°ç¯€
- **æŠ€è¡“å¯¦ç¾**ï¼š[æŠ€è¡“å¯¦æ–½æŒ‡å—](./technical_guide.md) - éƒ¨ç½²å’Œé–‹ç™¼
- **ç®—æ³•ç´°ç¯€**ï¼š[ç®—æ³•å¯¦ç¾æ‰‹å†Š](./algorithms_implementation.md) - æ ¸å¿ƒç®—æ³•
- **æ¨™æº–è¦ç¯„**ï¼š[è¡›æ˜Ÿæ›æ‰‹æ¨™æº–](./satellite_handover_standards.md) - 3GPP NTN æ¨™æº–
- **API ä»‹é¢**ï¼š[API åƒè€ƒæ‰‹å†Š](./api_reference.md) - ç«¯é»æ–‡æª”

## ğŸ¯ ç³»çµ±æ¶æ§‹å±¤æ¬¡

```mermaid
graph TB
    subgraph "ç ”ç©¶æ‡‰ç”¨å±¤"
        A1[å­¸è¡“ç ”ç©¶å·¥å…·]
        A2[ç®—æ³•æ¯”è¼ƒåˆ†æ]  
        A3[è«–æ–‡æ•¸æ“šè¼¸å‡º]
    end
    
    subgraph "å‰ç«¯å±•ç¤ºå±¤"
        F1[SimWorld Frontend :5173]
        F2[3D è¡›æ˜Ÿè¦–è¦ºåŒ–]
        F3[å¯¦æ™‚æ•¸æ“šå„€è¡¨æ¿]
    end
    
    subgraph "æ ¸å¿ƒæœå‹™å±¤"
        N1[NetStack API :8080]
        N2[SimWorld Backend :8888]
    end
    
    subgraph "ç®—æ³•å¼•æ“å±¤" 
        E1[åˆ‡æ›æ±ºç­–å¼•æ“]
        E2[è»Œé“é æ¸¬å¼•æ“]
        E3[ML é æ¸¬æ¨¡å‹]
        E4[ç‹€æ…‹åŒæ­¥å¼•æ“]
    end
    
    subgraph "æ•¸æ“šæœå‹™å±¤"
        D1[PostgreSQL æ•¸æ“šåº«]
        D2[Docker Volume å­˜å„²]
        D3[TLE æ•¸æ“šç®¡ç†]
    end
    
    A1 --> F1
    A2 --> N1  
    A3 --> N2
    F1 --> N1
    F2 --> N1
    F3 --> N2
    N1 --> E1
    N1 --> E2
    N2 --> E3
    N2 --> E4
    E1 --> D1
    E2 --> D2
    E3 --> D2
    E4 --> D1
```

## ğŸ”§ æ ¸å¿ƒçµ„ä»¶æ¶æ§‹

### NetStack (5G æ ¸å¿ƒç¶²è·¯) - :8080
**ä¸»è¦è·è²¬**: LEO è¡›æ˜Ÿåˆ‡æ›ç®—æ³•ç ”ç©¶å’Œ 3GPP NTN å”è­°å¯¦ç¾

**æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„**:
- **API Gateway**: çµ±ä¸€ API å…¥å£å’Œè·¯ç”±ç®¡ç†
- **ç®—æ³•å¼•æ“é›†ç¾¤**: åˆ‡æ›æ±ºç­–ã€è»Œé“é æ¸¬ã€ML æ¨¡å‹ã€ç‹€æ…‹åŒæ­¥
- **3GPP NTN å”è­°**: ä¿¡ä»¤ç³»çµ±ã€æ™‚é–“åŒæ­¥ã€é »ç‡è£œå„Ÿ
- **æ•¸æ“šæŒä¹…åŒ–**: PostgreSQL å¯¦é©—æ•¸æ“šå’Œ RL è¨“ç·´è¨˜éŒ„

**å®¹å™¨é…ç½®**:
```yaml
netstack-api:
  port: 8080
  depends_on: [netstack-postgres, netstack-redis]
  volumes: [tle_data, leo_outputs]
  
netstack-postgres:  
  port: 5432
  database: rl_research
  persistent_volume: postgres_data
```

### SimWorld (3D ä»¿çœŸå¼•æ“) - :8888  
**ä¸»è¦è·è²¬**: è¡›æ˜Ÿè»Œé“è¨ˆç®—ã€æ•¸æ“šé è™•ç†å’Œ 3D è¦–è¦ºåŒ–

**æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„**:
- **è»Œé“è¨ˆç®—å¼•æ“**: SGP4 ç²¾ç¢ºè¨ˆç®—å’Œæœ¬åœ°æ•¸æ“šæœå‹™
- **æ•¸æ“šé è™•ç†ç³»çµ±**: æ™‚é–“åºåˆ—ç”Ÿæˆå’Œæ ¼å¼æ¨™æº–åŒ–  
- **3D è¦–è¦ºåŒ–å‰ç«¯**: Three.js è»Œé“å±•ç¤ºå’Œå¯¦æ™‚ç›£æ§
- **çµ±ä¸€ API æœå‹™**: è·¨ç³»çµ±æ•¸æ“šäº¤æ›æ¥å£

**å®¹å™¨é…ç½®**:
```yaml
simworld-backend:
  port: 8888
  depends_on: [simworld-postgres]
  volumes: [satellite_data, leo_outputs]
  
simworld-frontend:
  port: 5173
  build_context: ./simworld/frontend
  nginx_config: production
```

## ğŸŒ Docker Compose æ¶æ§‹

### å®Œæ•´æœå‹™æ‹“æ’²
```yaml
services:
  # NetStack æœå‹™ç¾¤çµ„ (15+ å¾®æœå‹™)
  netstack-api:          # æ ¸å¿ƒ API æœå‹™
  netstack-postgres:     # ä¸»æ•¸æ“šåº«
  netstack-redis:        # ç·©å­˜æœå‹™
  netstack-rl-postgres:  # RL è¨“ç·´æ•¸æ“šåº«
  # ... å…¶ä»– NetStack å¾®æœå‹™

  # SimWorld æœå‹™ç¾¤çµ„  
  simworld-backend:      # å¾Œç«¯è¨ˆç®—æœå‹™
  simworld-frontend:     # å‰ç«¯ UI
  simworld-postgres:     # SimWorld æ•¸æ“šåº«

volumes:
  # æ•¸æ“šæŒä¹…åŒ–
  postgres_data:         # ä¸»æ•¸æ“šåº«æ•¸æ“š
  rl_postgres_data:      # RL è¨“ç·´æ•¸æ“š
  satellite_data:        # TLE å’Œè»Œé“æ•¸æ“š
  leo_outputs:           # å…­éšæ®µè™•ç†è¼¸å‡º

networks:
  ntn-network:           # å…§éƒ¨é€šä¿¡ç¶²è·¯
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.0.0/16
```

### æœå‹™ä¾è³´é—œä¿‚
```
PostgreSQL æ•¸æ“šåº« â†’ NetStack API â†’ SimWorld å‰ç«¯
       â†“                â†“              â†“
   æ•¸æ“šæŒä¹…åŒ–      â†’ ç®—æ³•å¼•æ“    â†’ 3D è¦–è¦ºåŒ–
       â†“                â†“              â†“  
   Volume å­˜å„²    â†’ TLE è™•ç†    â†’ ç”¨æˆ¶ç•Œé¢
```

## ğŸš€ Pure Cron é©…å‹•æ¶æ§‹

### æ ¸å¿ƒç†å¿µ
**å®¹å™¨ = ç´”æ•¸æ“šè¼‰å…¥ï¼ŒCron = è‡ªå‹•æ•¸æ“šæ›´æ–°ï¼Œå¾¹åº•åˆ†é›¢é—œæ³¨é»**

```
ğŸ—ï¸ Docker å»ºæ§‹éšæ®µ     ğŸš€ å®¹å™¨å•Ÿå‹•éšæ®µ      ğŸ•’ Cron èª¿åº¦éšæ®µ
      â†“                     â†“                    â†“
   é è¨ˆç®—åŸºç¤æ•¸æ“š         ç´”æ•¸æ“šè¼‰å…¥é©—è­‰         è‡ªå‹•æ•¸æ“šæ›´æ–°
      â†“                     â†“                    â†“
   æ˜ åƒæª”åŒ…å«æ•¸æ“š         < 30ç§’å¿«é€Ÿå•Ÿå‹•      æ™ºèƒ½å¢é‡è™•ç†
                                              (æ¯6å°æ™‚åŸ·è¡Œ)
```

### æ•¸æ“šæ›´æ–°æ©Ÿåˆ¶
1. **å»ºæ§‹éšæ®µ**: å®Œæ•´ SGP4 é è¨ˆç®—ï¼Œç”ŸæˆåŸºç¤æ•¸æ“šåˆ°æ˜ åƒæª”
2. **å•Ÿå‹•éšæ®µ**: ç´”æ•¸æ“šè¼‰å…¥å’Œé©—è­‰ï¼Œ< 30 ç§’å¿«é€Ÿå•Ÿå‹•
3. **é‹è¡Œéšæ®µ**: å¾Œå° Cron è‡ªå‹•ä¸‹è¼‰å’Œå¢é‡è™•ç†
4. **æ™ºèƒ½æ›´æ–°**: æª¢æ¸¬è®Šæ›´ï¼ŒæŒ‰éœ€é‡æ–°è¨ˆç®—

## ğŸ”„ æ•¸æ“šæµå‘æ¶æ§‹

### ç ”ç©¶å·¥ä½œæµç¨‹
```
å­¸è¡“ç ”ç©¶éœ€æ±‚ â†’ ç®—æ³•é…ç½® â†’ å¯¦é©—åŸ·è¡Œ â†’ æ•¸æ“šåˆ†æ â†’ çµæœè¼¸å‡º
     â†“              â†“           â†“          â†“          â†“
  NetStack API â†’ ç®—æ³•å¼•æ“ â†’ SimWorld â†’ å¯è¦–åŒ– â†’ è«–æ–‡æ•¸æ“š
```

### å…­éšæ®µæ•¸æ“šè™•ç†æµç¨‹
```
TLE æ•¸æ“šè¼‰å…¥ â†’ æ™ºèƒ½ç¯©é¸ â†’ ä¿¡è™Ÿåˆ†æ â†’ æ™‚é–“åºåˆ— â†’ æ•¸æ“šæ•´åˆ â†’ å‹•æ…‹æ± è¦åŠƒ
   Stage 1      Stage 2    Stage 3     Stage 4     Stage 5     Stage 6
     â†“            â†“          â†“           â†“           â†“           â†“
 8,735 é¡†è¡›æ˜Ÿ â†’ 391 é¡†å€™é¸ â†’ 3GPP äº‹ä»¶ â†’ å‰ç«¯æ•¸æ“š â†’ æ ¼å¼çµ±ä¸€ â†’ 90-110 é¡†æ± 
```

### çœŸå¯¦æ•¸æ“šä¾†æºæ¶æ§‹
```
çœŸå¯¦ TLE æ•¸æ“š â†’ SGP4 è¨ˆç®— â†’ è¡›æ˜Ÿç¯©é¸ â†’ æ™‚é–“åºåˆ— â†’ API æœå‹™ â†’ ç ”ç©¶æ‡‰ç”¨
      â†“             â†“         â†“          â†“         â†“          â†“
   CelesTrak â†’ å®Œæ•´ç‰©ç†æ¨¡å‹ â†’ åœ°ç†ç¯©é¸ â†’ é è¨ˆç®— â†’ çµ±ä¸€æ ¼å¼ â†’ å­¸è¡“åˆ†æ
```

## ğŸ—‚ï¸ å­˜å„²æ¶æ§‹è¨­è¨ˆ

### Docker Volume é…ç½®
```
ğŸ“ satellite_data/           # TLE æ•¸æ“šå­˜å„²
â”œâ”€â”€ starlink/
â”‚   â”œâ”€â”€ tle/starlink_YYYYMMDD.tle
â”‚   â””â”€â”€ json/starlink.json
â””â”€â”€ oneweb/
    â”œâ”€â”€ tle/oneweb_YYYYMMDD.tle  
    â””â”€â”€ json/oneweb.json

ğŸ“ leo_outputs/              # å…­éšæ®µè™•ç†è¼¸å‡º
â”œâ”€â”€ stage1_tle_calculation/
â”œâ”€â”€ stage2_intelligent_filtering/
â”œâ”€â”€ stage3_signal_analysis/
â”œâ”€â”€ stage4_timeseries_preprocessing/
â”œâ”€â”€ stage5_data_integration/
â””â”€â”€ stage6_dynamic_pool_planning/
```

### PostgreSQL æ•¸æ“šåº«è¨­è¨ˆ
```sql
-- NetStack ä¸»æ•¸æ“šåº«
netstack_db:
â”œâ”€â”€ experiment_results      # å¯¦é©—çµæœ
â”œâ”€â”€ algorithm_configurations # ç®—æ³•é…ç½®  
â””â”€â”€ performance_metrics     # æ€§èƒ½æŒ‡æ¨™

-- RL è¨“ç·´æ•¸æ“šåº«  
rl_research:
â”œâ”€â”€ satellite_orbital_cache # è»Œé“ç·©å­˜
â”œâ”€â”€ satellite_tle_data      # TLE æ•¸æ“š
â””â”€â”€ training_episodes       # è¨“ç·´è¨˜éŒ„
```

## ğŸŒŸ ç³»çµ±ç‰¹è‰²èˆ‡å„ªå‹¢

### æŠ€è¡“ç‰¹è‰²
- **å®Œæ•´ SGP4 è»Œé“è¨ˆç®—** - éç°¡åŒ–ç®—æ³•ï¼Œç¬¦åˆå­¸è¡“ç ”ç©¶æ¨™æº–  
- **3GPP NTN æ¨™æº–åˆè¦** - A4/A5/D2 äº‹ä»¶å®Œæ•´å¯¦ç¾
- **Pure Cron é©…å‹•æ¶æ§‹** - å®¹å™¨ç´”æ•¸æ“šè¼‰å…¥ï¼ŒCron è‡ªå‹•æ›´æ–°
- **å…­éšæ®µæ™ºèƒ½è™•ç†** - å¾ 8,735 é¡†åˆ° 90-110 é¡†å‹•æ…‹æ± çš„æ™ºèƒ½å„ªåŒ–
- **çœŸå¯¦æ•¸æ“šé©…å‹•** - CelesTrak å®˜æ–¹ TLE æ•¸æ“šï¼Œ6 å°æ™‚è‡ªå‹•æ›´æ–°

### æ€§èƒ½å„ªå‹¢
```
ğŸš€ ç³»çµ±å•Ÿå‹•: < 30 ç§’ (æ‰€æœ‰æœå‹™å¥åº·)
âš¡ API éŸ¿æ‡‰: < 100 ms (è¡›æ˜Ÿä½ç½®æŸ¥è©¢)  
ğŸ§  ç®—æ³•åŸ·è¡Œ: < 50 ms (æ›æ‰‹æ±ºç­–)
ğŸ“Š æ•¸æ“šè™•ç†: 2-5 åˆ†é˜ (å®Œæ•´å…­éšæ®µ)
ğŸ”„ è‡ªå‹•æ›´æ–°: æ¯ 6 å°æ™‚ç„¡æ„Ÿæ›´æ–°
```

## ğŸ” å®‰å…¨æ¶æ§‹è€ƒé‡

### ç¶²è·¯å®‰å…¨
- **å…§éƒ¨ç¶²è·¯éš”é›¢**: Docker network éš”é›¢å¤–éƒ¨è¨ªå•
- **ç«¯å£æš´éœ²æ§åˆ¶**: åƒ…å¿…è¦ç«¯å£å°å¤–é–‹æ”¾
- **API è¨ªå•æ§åˆ¶**: åŸºæ–¼è§’è‰²çš„ API æ¬Šé™ç®¡ç†

### æ•¸æ“šå®‰å…¨  
- **æ•¸æ“šåŠ å¯†**: æ•æ„Ÿæ•¸æ“šéœæ…‹åŠ å¯†å­˜å„²
- **å‚™ä»½ç­–ç•¥**: å®šæœŸè‡ªå‹•åŒ–æ•¸æ“šå‚™ä»½
- **è¨ªå•æ—¥èªŒ**: å®Œæ•´çš„ API è¨ªå•å¯©è¨ˆæ—¥èªŒ

## ğŸ“Š ç›£æ§èˆ‡é‹ç¶­

### å¥åº·æª¢æŸ¥ç­–ç•¥
```yaml
å¥åº·æª¢æŸ¥:
  netstack-api: GET /health (æ¯ 30ç§’)
  simworld-backend: GET /api/health (æ¯ 30ç§’)  
  postgresql: pg_isready (æ¯ 10ç§’)
  
è‡ªå‹•é‡å•Ÿç­–ç•¥:
  restart_policy: unless-stopped
  healthcheck_retries: 3
  healthcheck_timeout: 10s
```

### æ•ˆèƒ½ç›£æ§æŒ‡æ¨™
```
ç³»çµ±å±¤é¢:
â”œâ”€â”€ CPU ä½¿ç”¨ç‡ < 80%
â”œâ”€â”€ è¨˜æ†¶é«”ä½¿ç”¨ç‡ < 85%  
â”œâ”€â”€ ç£ç¢Ÿ I/O < 80%
â””â”€â”€ ç¶²è·¯å»¶é² < 10ms

æ‡‰ç”¨å±¤é¢:  
â”œâ”€â”€ API éŸ¿æ‡‰æ™‚é–“ < 100ms
â”œâ”€â”€ æ•¸æ“šè™•ç†å»¶é² < 5min
â”œâ”€â”€ ç®—æ³•æº–ç¢ºç‡ > 95%
â””â”€â”€ ç³»çµ±å¯ç”¨æ€§ > 99.5%
```

## ğŸš€ éƒ¨ç½²èˆ‡ç¶­è­·

### å¿«é€Ÿéƒ¨ç½²æŒ‡ä»¤
```bash
# å®Œæ•´ç³»çµ±å•Ÿå‹•
make up                    # å•Ÿå‹•æ‰€æœ‰æœå‹™
make status               # æª¢æŸ¥æœå‹™ç‹€æ…‹  
make logs                 # æŸ¥çœ‹é‹è¡Œæ—¥èªŒ

# å€‹åˆ¥æœå‹™ç®¡ç†
make netstack-restart     # é‡å•Ÿ NetStack (1-2åˆ†é˜)
make simworld-restart     # é‡å•Ÿ SimWorld (30ç§’)

# å¥åº·æª¢æŸ¥
curl http://localhost:8080/health     # NetStack API
curl http://localhost:8888/api/health # SimWorld API
curl http://localhost:5173           # å‰ç«¯ç•Œé¢
```

### æ•…éšœæ’é™¤æµç¨‹
1. **æª¢æŸ¥æœå‹™ç‹€æ…‹**: `make status`
2. **æŸ¥çœ‹æ—¥èªŒ**: `docker logs <service_name>`
3. **æª¢æŸ¥è³‡æºä½¿ç”¨**: `docker stats`
4. **ç¶²è·¯é€£é€šæ€§**: `docker network ls`
5. **æ•¸æ“šå®Œæ•´æ€§**: æª¢æŸ¥ Volume æ›è¼‰

## ğŸ“‹ æ¶æ§‹æ±ºç­–è¨˜éŒ„

### é—œéµè¨­è¨ˆé¸æ“‡
1. **å¾®æœå‹™æ¶æ§‹**: NetStack + SimWorld åˆ†é›¢ï¼Œæå‡é–‹ç™¼éˆæ´»æ€§
2. **å®¹å™¨åŒ–éƒ¨ç½²**: Docker Compose ç·¨æ’ï¼Œç°¡åŒ–éƒ¨ç½²æµç¨‹
3. **Pure Cron é©…å‹•**: åˆ†é›¢å»ºæ§‹èˆ‡é‹è¡Œï¼Œæå‡ç³»çµ±ç©©å®šæ€§
4. **æ··åˆå­˜å„²**: PostgreSQL + Volumeï¼Œå¹³è¡¡æ€§èƒ½å’Œéˆæ´»æ€§

### æŠ€è¡“é¸å‹ç†ç”±
- **Python + FastAPI**: ç§‘å­¸è¨ˆç®—ç”Ÿæ…‹ + é«˜æ€§èƒ½ API
- **Three.js**: å¼·å¤§ 3D è¦–è¦ºåŒ–ï¼Œé©åˆè¡›æ˜Ÿè»Œé“å±•ç¤º
- **PostgreSQL**: ç©©å®šé—œä¿‚å‹æ•¸æ“šåº«ï¼Œæ”¯æ´è¤‡é›œæŸ¥è©¢
- **Docker Compose**: ç°¡åŒ–å¤šæœå‹™ç·¨æ’ï¼Œé©åˆç ”ç©¶ç’°å¢ƒ

## âš ï¸ æ¶æ§‹é™åˆ¶èˆ‡æœªä¾†è¦åŠƒ

### ç•¶å‰é™åˆ¶
- **å–®ç¯€é»éƒ¨ç½²**: é™åˆ¶åœ¨å–®æ©Ÿç’°å¢ƒ
- **æ‰‹å‹•æ“´å±•**: éœ€è¦æ‰‹å‹•èª¿æ•´è³‡æºé…ç½®
- **æ•¸æ“šåŒæ­¥**: è·¨æœå‹™ä¸€è‡´æ€§ä¾è³´æ‡‰ç”¨å±¤

### æœªä¾†æ”¹é€²æ–¹å‘
- **å®¹å™¨ç·¨æ’**: å¼•å…¥ Kubernetes æ”¯æ´
- **æœå‹™ç¶²æ ¼**: æ¡ç”¨ Istio æå‡é€šä¿¡ç®¡ç†  
- **åˆ†æ•£å¼å­˜å„²**: æ”¯æ´å¤šç¯€é»æ•¸æ“šåˆ†ä½ˆ
- **è‡ªå‹•æ“´å±•**: åŸºæ–¼è² è¼‰çš„å‹•æ…‹è³‡æºèª¿æ•´

---

**æœ¬æ¶æ§‹æ–‡æª”æä¾›ç³»çµ±å®Œæ•´è¨­è¨ˆæ¦‚è¦½ã€‚è©³ç´°çš„å¯¦ç¾ç´°ç¯€å’Œé…ç½®èªªæ˜è«‹åƒè€ƒç›¸æ‡‰çš„æŠ€è¡“æ–‡æª”ã€‚**

*æœ€å¾Œæ›´æ–°ï¼š2025-08-18 | ç³»çµ±æ¶æ§‹ç‰ˆæœ¬ 3.0.0*