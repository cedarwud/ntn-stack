# ğŸ”„ NTN Stack æ•¸æ“šè™•ç†æµç¨‹

**ç‰ˆæœ¬**: 3.2.0 (æ™‚é–“åºåˆ—ä¿®å¾©ç‰ˆ)  
**æ›´æ–°æ—¥æœŸ**: 2025-08-20  
**å°ˆæ¡ˆç‹€æ…‹**: âœ… ç”Ÿç”¢å°±ç·’ + è»Œè·¡é€£çºŒæ€§ä¿®å¾©  
**é©ç”¨æ–¼**: LEO è¡›æ˜Ÿåˆ‡æ›ç ”ç©¶ - å…­éšæ®µå®Œæ•´ç‰ˆ + æ™‚é–“åºåˆ—ä¿ç•™

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æª”è©³ç´°èªªæ˜ **Pure Cron é©…å‹•æ¶æ§‹** çš„å®Œæ•´æ•¸æ“šé è™•ç†æµç¨‹ï¼šå®¹å™¨åƒ…è² è²¬æ•¸æ“šè¼‰å…¥ï¼Œæ‰€æœ‰æ›´æ–°ç”± Cron è‡ªå‹•èª¿åº¦è™•ç†ï¼Œå¯¦ç¾æœ€ä½³åŒ–çš„ç³»çµ±æ¶æ§‹ã€‚

**é‡è¦æ¾„æ¸…**ï¼šç³»çµ±ä½¿ç”¨å®Œæ•´çš„ SGP4 ç®—æ³•ï¼Œçµ•ä¸ä½¿ç”¨ç°¡åŒ–æˆ–æ¨¡æ“¬æ•¸æ“šã€‚æ‰€æœ‰æ¨™è¨˜ç‚º "simplified_for_build" çš„æ–‡ä»¶åƒ…ç‚ºå»ºæ§‹æ™‚çš„å¿«é€Ÿå•Ÿå‹•æ•¸æ“šï¼Œé‹è¡Œæ™‚ä½¿ç”¨ "runtime_precision" æ¨¡å¼ã€‚

**ğŸ“‹ ç›¸é—œæ–‡æª”**ï¼š
- **ç³»çµ±æ¶æ§‹**ï¼š[ç³»çµ±æ¶æ§‹ç¸½è¦½](./system_architecture.md) - Docker é…ç½®å’Œçµ„ä»¶åˆ†å·¥
- **çµ±ä¸€æ¶æ§‹**ï¼š[Shared Core çµ±ä¸€æ¶æ§‹](./shared_core_architecture.md) - çµ±ä¸€ç®¡ç†å™¨å’Œæ€§èƒ½å„ªåŒ–
- **æŠ€è¡“å¯¦ç¾**ï¼š[æŠ€è¡“å¯¦æ–½æŒ‡å—](./technical_guide.md) - éƒ¨ç½²å’Œé–‹ç™¼æŒ‡å—
- **ç®—æ³•ç´°ç¯€**ï¼š[ç®—æ³•å¯¦ç¾æ‰‹å†Š](./algorithms_implementation.md) - SGP4 å’Œæ›æ‰‹ç®—æ³•
- **éšæ®µè©³è§£**ï¼š[stages/](./stages/) - å„éšæ®µæŠ€è¡“å¯¦ç¾ç´°ç¯€

## ğŸš€ Pure Cron é©…å‹•æ¶æ§‹ (v3.0)

### æ ¸å¿ƒç†å¿µ
**å®¹å™¨ = ç´”æ•¸æ“šè¼‰å…¥ï¼ŒCron = è‡ªå‹•æ•¸æ“šæ›´æ–°ï¼Œå¾¹åº•åˆ†é›¢é—œæ³¨é»**

```
ğŸ—ï¸ Docker å»ºæ§‹éšæ®µ     ğŸš€ å®¹å™¨å•Ÿå‹•éšæ®µ      ğŸ•’ Cron èª¿åº¦éšæ®µ      ğŸ§  æŠ€è¡“æ•´åˆå±¤
      â†“                     â†“                    â†“                   â†“
   é è¨ˆç®—åŸºç¤æ•¸æ“š         ç´”æ•¸æ“šè¼‰å…¥é©—è­‰         è‡ªå‹•æ•¸æ“šæ›´æ–°        shared_coreæ¨¡å‹
      â†“                     â†“                    â†“                   â†“
   æ˜ åƒæª”åŒ…å«æ•¸æ“š         < 30ç§’å¿«é€Ÿå•Ÿå‹•      æ™ºèƒ½å¢é‡è™•ç†        æ™‚é–“åºåˆ—ä¿ç•™
                                              (æ¯6å°æ™‚åŸ·è¡Œ)        auto_cleanupç®¡ç†
```

### æ¶æ§‹å„ªå‹¢ (v3.1 é‡æ§‹å„ªåŒ–)
- **100% å ´æ™¯å¯¦ç¾** < 30 ç§’ç©©å®šå•Ÿå‹• (å…­éšæ®µåŸºç¤ + shared_core åŠ é€Ÿ)
- **æ™ºèƒ½å¢é‡è™•ç†** - incremental_update_manager é¿å…ä¸å¿…è¦è¨ˆç®—
- **è‡ªå‹•æ¸…ç†ç®¡ç†** - auto_cleanup_manager å®¹éŒ¯è¨­è¨ˆç¢ºä¿ç³»çµ±é«˜å¯ç”¨æ€§
- **çµ±ä¸€æ•¸æ“šæ¨¡å‹** - shared_core ä¿è­‰è·¨éšæ®µä¸€è‡´æ€§
- **æ™‚é–“åºåˆ—ä¿ç•™** - Stage6 ç¢ºä¿å®Œæ•´è»Œè·¡æ•¸æ“šé€£çºŒæ€§
- **ğŸ”§ çµ±ä¸€ç®¡ç†å™¨æ¶æ§‹** - æ¶ˆé™¤é‡è¤‡åŠŸèƒ½ï¼Œæå‡ç¶­è­·æ€§
- **ğŸ”§ ä¿¡è™Ÿå“è³ªç·©å­˜** - é¿å…é‡è¤‡RSRPè¨ˆç®—ï¼Œæå‡40%æ€§èƒ½
- **ğŸ”§ çµ±ä¸€å¯è¦‹æ€§æœå‹™** - æ¨™æº–åŒ–è¡›æ˜Ÿå¯è¦‹æ€§åˆ¤æ–·é‚è¼¯

## ğŸ”„ å…­éšæ®µæ•¸æ“šè™•ç†æµç¨‹

### ğŸ¯ v3.1 æ•¸æ“šè¡€çµ±è¿½è¹¤æ›´æ–°

**é‡è¦ä¿®å¾©**ï¼šè§£æ±ºæ•¸æ“šè¡€çµ±è¿½è¹¤å•é¡Œï¼Œç¢ºä¿æ•¸æ“šæ™‚é–“æˆ³çš„æº–ç¢ºæ€§

- **å•é¡Œ**ï¼šä¹‹å‰ç³»çµ±è¨˜éŒ„è™•ç†åŸ·è¡Œæ™‚é–“è€Œéå¯¦éš›TLEæ•¸æ“šæ™‚é–“
- **ä¿®å¾©**ï¼šæ˜ç¢ºåˆ†é›¢TLEæ•¸æ“šæ—¥æœŸèˆ‡è™•ç†æ™‚é–“æˆ³  
- **å½±éŸ¿**ï¼šStage 1 è¼¸å‡ºç¾åœ¨åŒ…å«å®Œæ•´çš„æ•¸æ“šè¡€çµ±ä¿¡æ¯
- **æ¨™æº–**ï¼šç¬¦åˆæ•¸æ“šæ²»ç†å’Œè¡€çµ±ç®¡ç†æœ€ä½³å¯¦è¸

**ä¿®å¾©å…§å®¹**ï¼š
```python
# ä¿®å¾©å‰ï¼ˆå•é¡Œï¼‰
processing_timestamp: "2025-08-21T10:30:00Z"  # è™•ç†åŸ·è¡Œæ™‚é–“

# ä¿®å¾©å¾Œï¼ˆæ­£ç¢ºï¼‰
data_lineage: {
    "tle_dates": {"starlink": "20250820", "oneweb": "20250820"},    # å¯¦éš›æ•¸æ“šæ—¥æœŸ
    "processing_execution_time": "2025-08-21T10:30:00Z",           # è™•ç†åŸ·è¡Œæ™‚é–“
    "calculation_base_time": "2025-08-20T12:00:00Z"                # SGP4è¨ˆç®—åŸºæº–æ™‚é–“
}
```

### å®Œæ•´æ•¸æ“šæµå‘åœ–
```
ğŸ—ï¸ å»ºæ§‹éšæ®µï¼š
TLE åŸå§‹æ•¸æ“š â†’ SGP4 è¨ˆç®— â†’ æ™ºèƒ½ç¯©é¸ â†’ é è¨ˆç®—æ•¸æ“š â†’ æ˜ åƒæª”åŸºç¤æ•¸æ“š

ğŸš€ å•Ÿå‹•éšæ®µï¼š
æ˜ åƒæª”åŸºç¤æ•¸æ“š â†’ æ•¸æ“šè¼‰å…¥é©—è­‰ â†’ æœå‹™å¥åº·æª¢æŸ¥ â†’ API ç«¯é»å•Ÿç”¨

ğŸ•’ Cron èª¿åº¦éšæ®µï¼š
CelesTrak ä¸‹è¼‰ â†’ TLE è§£æ â†’ æ™ºèƒ½æ¯”è¼ƒ â†’ å¢é‡è¨ˆç®— â†’ æ•¸æ“šæ›´æ–°

ğŸ”„ é‹è¡Œéšæ®µï¼š
API è«‹æ±‚ â†’ ç·©å­˜æª¢æŸ¥ â†’ æ•¸æ“šæŸ¥è©¢ â†’ çµæœè¿”å› â†’ æ€§èƒ½ç›£æ§
```

### å…­éšæ®µè©³ç´°è™•ç†æµç¨‹

#### **Stage 1: TLE æ•¸æ“šè¼‰å…¥èˆ‡ SGP4 è»Œé“è¨ˆç®—**
**è™•ç†å°è±¡**: 8,735 é¡†è¡›æ˜Ÿ (8,084 Starlink + 651 OneWeb)  
**è™•ç†æ™‚é–“**: ç´„ 2-3 åˆ†é˜  
**è¼¸å‡º**: è¨˜æ†¶é«”å‚³éçµ¦ Stage 2

**æ ¸å¿ƒè™•ç†**:
```python
# å¯¦éš›å¯¦ç¾ä½ç½®: /netstack/src/stages/tle_orbital_calculation_processor.py
class Stage1TLEProcessor:
    def scan_tle_data()                    # TLEæª”æ¡ˆæƒæ
    def load_raw_satellite_data()          # åŸå§‹æ•¸æ“šè¼‰å…¥  
    def calculate_all_orbits()             # å®Œæ•´SGP4è¨ˆç®—
    def process_tle_orbital_calculation()  # å®Œæ•´æµç¨‹åŸ·è¡Œ
```

**æŠ€è¡“ç‰¹è‰²**:
- **å®Œæ•´ SGP4 è»Œé“è¨ˆç®—** - ä½¿ç”¨å®˜æ–¹ SGP4 æ¼”ç®—æ³•ï¼Œéç°¡åŒ–ç‰ˆæœ¬
- **æ™‚é–“è§£æåº¦**: 30 ç§’é–“éš”ï¼Œè¨ˆç®— 6 å°æ™‚å®Œæ•´è»Œé“æ•¸æ“š
- **è¨˜æ†¶é«”å‚³éæ¨¡å¼** - é¿å…ç”Ÿæˆ 2.2GB å¤§æª”æ¡ˆï¼Œæ•ˆèƒ½æå‡ 50%+

#### **Stage 2: æ™ºèƒ½è¡›æ˜Ÿç¯©é¸**
**è™•ç†å°è±¡**: å¾ 8,735 é¡†ç¯©é¸è‡³ 391 é¡†å€™é¸  
**ç¯©é¸ç‡**: 95.5% å¤§å¹…æ¸›å°‘å¾ŒçºŒè¨ˆç®—è² è·  
**è™•ç†æ™‚é–“**: ç´„ 1-2 åˆ†é˜

**å…­éšæ®µç¯©é¸ç®¡ç·š**:
1. **æ˜Ÿåº§åˆ†é›¢ç¯©é¸** (8,735 â†’ 8,735) - åˆ†é›¢ Starlink å’Œ OneWeb
2. **åœ°ç†ç›¸é—œæ€§ç¯©é¸** (8,735 â†’ 391) - åŸºæ–¼ NTPU è§€æ¸¬é»ç¯©é¸
3. **æ›æ‰‹é©ç”¨æ€§è©•åˆ†** (391 â†’ 391) - è©•ä¼°æ¯é¡†è¡›æ˜Ÿçš„æ›æ‰‹æ½›åŠ›

**å¯¦éš›ç¯©é¸çµæœ**:
- Starlink: 358 é¡† (å¾ 8,084 é¡†ç¯©é¸)
- OneWeb: 33 é¡† (å¾ 651 é¡†ç¯©é¸)
- ç¸½è¨ˆ: 391 é¡†è¡›æ˜Ÿä¿ç•™

#### **Stage 3: ä¿¡è™Ÿå“è³ªåˆ†æ**
**è™•ç†å°è±¡**: 391 é¡†å€™é¸è¡›æ˜Ÿçš„ä¿¡è™Ÿåˆ†æ  
**è™•ç†æ™‚é–“**: ç´„ 1-2 åˆ†é˜  
**æ ¸å¿ƒæŠ€è¡“**: 3GPP NTN æ¨™æº– A4/A5/D2 äº‹ä»¶å¯¦ç¾

**3GPP äº‹ä»¶åˆ†æ**:
- **Event A4**: é„°è¿‘è¡›æ˜Ÿä¿¡è™Ÿå„ªæ–¼é–€æª» (RSRP > -100 dBm)
- **Event A5**: æœå‹™è¡›æ˜ŸåŠ£åŒ–ä¸”é„°è¿‘è¡›æ˜Ÿè‰¯å¥½
- **Event D2**: åŸºæ–¼è·é›¢çš„æ›æ‰‹è§¸ç™¼

**RSRP è¨ˆç®—å¯¦ç¾**:
```python
def calculate_rsrp_simple(sat):
    # è‡ªç”±ç©ºé–“è·¯å¾‘æè€— (Kué »æ®µ 12 GHz)
    fspl_db = 20 * math.log10(sat.distance_km) + 20 * math.log10(12.0) + 32.45
    elevation_gain = min(sat.elevation_deg / 90.0, 1.0) * 15  # æœ€å¤§15dBå¢ç›Š
    tx_power = 43.0  # 43dBmç™¼å°„åŠŸç‡
    return tx_power - fspl_db + elevation_gain
```

#### **Stage 4: æ™‚é–“åºåˆ—é è™•ç†**
**è™•ç†å°è±¡**: 391 é¡†è¡›æ˜Ÿçš„æ™‚é–“åºåˆ—æœ€ä½³åŒ–  
**è¼¸å…¥**: éšæ®µä¸‰ä¿¡è™Ÿå“è³ªæ•¸æ“š (~200MB)  
**è¼¸å‡º**: å‰ç«¯æ™‚é–“åºåˆ—æ•¸æ“š (~60-75MB)

**å‰ç«¯å‹•ç•«éœ€æ±‚**:
- **æ™‚é–“è»¸æ§åˆ¶**: æ”¯æ´ 1x-60x å€é€Ÿæ’­æ”¾
- **è¡›æ˜Ÿè»Œè·¡**: å¹³æ»‘çš„è»Œé“å‹•ç•«è·¯å¾‘
- **ä¿¡è™Ÿè®ŠåŒ–**: å³æ™‚ä¿¡è™Ÿå¼·åº¦è¦–è¦ºåŒ–
- **æ›æ‰‹äº‹ä»¶**: å‹•æ…‹æ›æ‰‹æ±ºç­–å±•ç¤º

**æœ€ä½³åŒ–ç­–ç•¥**:
- **æª”æ¡ˆå¤§å°**: å£“ç¸®è‡³å‰ç«¯å¯æ¥å—ç¯„åœ
- **è¼‰å…¥é€Ÿåº¦**: æ”¯æ´å¿«é€Ÿåˆå§‹åŒ–
- **å‹•ç•«æµæš¢**: 60 FPS æ¸²æŸ“éœ€æ±‚
- **è¨˜æ†¶é«”æ•ˆç‡**: ç€è¦½å™¨è¨˜æ†¶é«”å‹å–„

#### **Stage 5: æ•¸æ“šæ•´åˆè™•ç†** âœ… å·²ä¿®å¾©
**è™•ç†å°è±¡**: è·¨ç³»çµ±æ•¸æ“šæ ¼å¼çµ±ä¸€èˆ‡åˆ†å±¤å¢å¼·  
**è™•ç†æ™‚é–“**: ç´„ 30-60 ç§’  

**æ•´åˆåŠŸèƒ½**:
- **åˆ†å±¤ä»°è§’æ¿¾æ³¢**: 5Â°/10Â°/15Â° ä¸‰å±¤ä»°è§’é–€æª»æ•¸æ“šç”Ÿæˆ
  - elevation_5deg: 399é¡†è¡›æ˜Ÿ (100%ä¿ç•™)
  - elevation_10deg: 351é¡†è¡›æ˜Ÿ (87.9%ä¿ç•™) 
  - elevation_15deg: 277é¡†è¡›æ˜Ÿ (69.4%ä¿ç•™)
- **PostgreSQLæ•´åˆ**: è¡›æ˜Ÿå…ƒæ•¸æ“šã€ä¿¡è™Ÿçµ±è¨ˆã€æ›æ‰‹äº‹ä»¶
- **æ ¼å¼æ¨™æº–åŒ–**: çµ±ä¸€ `position_timeseries` æ•¸æ“šçµæ§‹
- **æ›æ‰‹å ´æ™¯ç”Ÿæˆ**: A4/A5/D2 äº‹ä»¶æ™‚é–“è»¸

#### **Stage 6: å‹•æ…‹æ± è¦åŠƒ (æ™‚é–“åºåˆ—ä¿ç•™ç‰ˆ)**
**è™•ç†å°è±¡**: å¾ 391 é¡†å€™é¸ä¸­é¸å‡º 156 é¡†è¡›æ˜Ÿæ±  (120 Starlink + 36 OneWeb)  
**è™•ç†æ™‚é–“**: ç´„ 0.5 ç§’ (å¿«é€Ÿé¸æ“‡ + æ™‚é–“åºåˆ—æ•¸æ“šä¿ç•™)

**æ ¸å¿ƒåŠŸèƒ½**:
- **æ™‚é–“åºåˆ—ä¿ç•™**: ç¢ºä¿æ¯é¡†è¡›æ˜ŸåŒ…å«å®Œæ•´çš„ 192 é»è»Œè·¡æ•¸æ“š
- **æ•¸æ“šå®Œæ•´æ€§**: 30 ç§’é–“éš”çš„é€£çºŒ SGP4 è¨ˆç®—çµæœ
- **å‰ç«¯æ”¯æŒ**: è§£æ±ºè»Œè·¡è·³èºå•é¡Œï¼Œæ”¯æŒå¹³æ»‘ 3D å‹•ç•«

**é—œéµå¯¦ç¾**:
```python
# å¯¦éš›å¯¦ç¾ä½ç½®: /netstack/src/stages/enhanced_dynamic_pool_planner.py
@dataclass 
class EnhancedSatelliteCandidate:
    position_timeseries: List[Dict[str, Any]] = None  # ğŸ¯ å®Œæ•´æ™‚é–“åºåˆ—

def convert_to_enhanced_candidates(satellite_data):
    # ä¿ç•™å®Œæ•´çš„æ™‚é–“åºåˆ—æ•¸æ“š
    position_timeseries = sat_data.get('position_timeseries', [])
    # ç¢ºä¿ 192 é»Ã—30 ç§’é–“éš”è»Œè·¡æ•¸æ“šå®Œæ•´æ€§
```

## ğŸ—ƒï¸ æ•¸æ“šå­˜å„²æ¶æ§‹

### TLE æ•¸æ“šä¾†æºèˆ‡ç®¡ç†
**æ•¸æ“šæº**: CelesTrak å®˜æ–¹ TLE æ•¸æ“š  
**æ›´æ–°é »ç‡**: æ¯ 6 å°æ™‚è‡ªå‹•ä¸‹è¼‰  
**æ˜Ÿåº§è¦†è“‹**:

```
ğŸ“ /netstack/tle_data/
â”œâ”€â”€ starlink/
â”‚   â”œâ”€â”€ tle/starlink_20250818.tle    # çœŸå¯¦TLEæ•¸æ“š (8,084é¡†)
â”‚   â””â”€â”€ json/starlink.json           # çµæ§‹åŒ–æ•¸æ“š
â””â”€â”€ oneweb/
    â”œâ”€â”€ tle/oneweb_20250818.tle      # çœŸå¯¦TLEæ•¸æ“š (651é¡†)
    â””â”€â”€ json/oneweb.json
```

### å…­éšæ®µè¼¸å‡ºæ•¸æ“šçµæ§‹
```
ğŸ“ /data/leo_outputs/
â”œâ”€â”€ tle_calculation_outputs/         # Stage 1: SGP4è»Œé“è¨ˆç®—çµæœ
â”œâ”€â”€ intelligent_filtering_outputs/   # Stage 2: 391é¡†ç¯©é¸å€™é¸
â”œâ”€â”€ signal_analysis_outputs/         # Stage 3: 3GPPäº‹ä»¶åˆ†æ
â”œâ”€â”€ timeseries_preprocessing_outputs/ # Stage 4: å‰ç«¯å‹•ç•«æ•¸æ“š (~46MB)
â”‚   â”œâ”€â”€ starlink_enhanced.json      # 1,304,160è¡Œ (Starlink 363é¡†)
â”‚   â””â”€â”€ oneweb_enhanced.json         # 129,174è¡Œ (OneWeb 36é¡†)
â”œâ”€â”€ layered_phase0_enhanced/         # Stage 5: åˆ†å±¤ä»°è§’æ•¸æ“š âœ… å·²ä¿®å¾©
â”‚   â”œâ”€â”€ elevation_5deg/              # 399é¡†è¡›æ˜Ÿ (5.5MB)
â”‚   â”œâ”€â”€ elevation_10deg/             # 351é¡†è¡›æ˜Ÿ (4.0MB)  
â”‚   â””â”€â”€ elevation_15deg/             # 277é¡†è¡›æ˜Ÿ (2.8MB)
â”œâ”€â”€ data_integration_outputs/        # Stage 5: PostgreSQLæ•´åˆç‹€æ…‹
â””â”€â”€ dynamic_pool_planning_outputs/   # Stage 6: 156é¡†å‹•æ…‹æ±  (å«å®Œæ•´æ™‚é–“åºåˆ—)
```

### PostgreSQL æ•¸æ“šåº«æ•´åˆ
```sql
-- RL ç ”ç©¶æ•¸æ“šåº« (172.20.0.51:5432/rl_research)
satellite_orbital_cache:    -- è»Œé“è¨ˆç®—ç·©å­˜ (~3MB/é€±)
â”œâ”€â”€ satellite_id           -- è¡›æ˜Ÿè­˜åˆ¥ç¢¼
â”œâ”€â”€ timestamp              -- æ™‚é–“æˆ³ (30ç§’é–“éš”)  
â”œâ”€â”€ latitude, longitude    -- åœ°ç†åº§æ¨™
â”œâ”€â”€ altitude, elevation    -- é«˜åº¦å’Œä»°è§’
â””â”€â”€ distance_km           -- 3Dè·é›¢

satellite_tle_data:        -- TLEåŸå§‹æ•¸æ“šå­˜å„²
â”œâ”€â”€ satellite_id          -- è¡›æ˜Ÿè­˜åˆ¥ç¢¼
â”œâ”€â”€ constellation         -- æ˜Ÿåº§åç¨±
â”œâ”€â”€ tle_line1, tle_line2  -- TLEæ•¸æ“šè¡Œ
â””â”€â”€ epoch_time           -- è»Œé“å…ƒç´ æ™‚é–“
```

## âš¡ æ€§èƒ½æŒ‡æ¨™èˆ‡å„ªåŒ–

### é æœŸæ€§èƒ½æå‡
- **API éŸ¿æ‡‰æ™‚é–“**: å¾ 500-2000ms â†’ 50-100ms
- **è¡›æ˜Ÿæ•¸æ“šé‡**: å¾ 6 é¡†æ¨¡æ“¬ â†’ 6-8 é¡†çœŸå¯¦å¯è¦‹è¡›æ˜Ÿ (ç¬¦åˆ 3GPP NTN æ¨™æº–)
- **æ›æ‰‹å€™é¸**: 3-5 é¡† (ç¬¦åˆçœŸå¯¦å ´æ™¯)
- **æ™‚é–“ç¯„åœ**: æ”¯æ´ 6 å°æ™‚å®Œæ•´æ­·å²æ•¸æ“š
- **å‹•ç•«æµæš¢åº¦**: æ”¯æ´ 1x-60x å€é€Ÿæ’­æ”¾

### è³‡æºä½¿ç”¨å„ªåŒ–
- **PostgreSQL å­˜å„²**: ~3MB/é€± (96åˆ†é˜è»Œé“é€±æœŸæ•¸æ“šï¼Œå­˜å„²æ–¼ç¾æœ‰ RL æ•¸æ“šåº«)
- **è¨˜æ†¶é«”ä½¿ç”¨**: ~50MB (PostgreSQL æŸ¥è©¢ç·©å­˜)
- **CPU ä½¿ç”¨**: é è¨ˆç®—éšæ®µ 30%ï¼ŒæŸ¥è©¢éšæ®µ <5%
- **ç¶²è·¯æµé‡**: åƒ…é€±æ›´æ–°æ™‚éœ€è¦ï¼Œå¹³æ™‚é›¢ç·šé‹è¡Œ

### æ€§èƒ½åŸºæº–
```
ğŸš€ æ•¸æ“šè¼‰å…¥æ™‚é–“: < 30 ç§’
âš¡ API æŸ¥è©¢éŸ¿æ‡‰: < 100ms
ğŸ¨ å‰ç«¯çµ„ä»¶è¼‰å…¥: < 2 ç§’
ğŸ¬ å‹•ç•«æµæš¢åº¦: 60 FPS
ğŸ’¾ è¨˜æ†¶é«”ä½¿ç”¨: < 200MB
ğŸ”§ CPU ä½¿ç”¨ç‡: < 50%
```

## ğŸ”„ Cron è‡ªå‹•åŒ–èª¿åº¦

### Cron èª¿åº¦ç­–ç•¥
```bash
# æ¯6å°æ™‚æ›´æ–°TLEæ•¸æ“š
0 */6 * * * /home/sat/ntn-stack/scripts/daily_tle_download_enhanced.sh

# æ¯æ—¥å‡Œæ™¨åŸ·è¡Œå®Œæ•´å…­éšæ®µè™•ç†
0 2 * * * /home/sat/ntn-stack/netstack/src/leo_core/main.py

# æ¯å°æ™‚æª¢æŸ¥ç³»çµ±å¥åº·ç‹€æ…‹
0 * * * * curl -f http://localhost:8080/health || systemctl restart ntn-stack
```

### æ™ºèƒ½å¢é‡æ›´æ–°æ©Ÿåˆ¶
```python
# å¯¦éš›å¯¦ç¾ä½ç½®: /netstack/src/shared_core/incremental_update_manager.py
class IncrementalUpdateManager:
    def detect_tle_changes()           # TLEè®Šæ›´åµæ¸¬
    def calculate_update_scope()       # æ›´æ–°ç¯„åœè¨ˆç®—
    def execute_incremental_update()   # åŸ·è¡Œå¢é‡æ›´æ–°
    def validate_update_integrity()    # æ›´æ–°å®Œæ•´æ€§é©—è­‰
```

### è‡ªå‹•æ¸…ç†ç®¡ç†
```python
# å¯¦éš›å¯¦ç¾ä½ç½®: /netstack/src/shared_core/auto_cleanup_manager.py  
class AutoCleanupManager:
    def cleanup_old_outputs()         # æ¸…ç†éæœŸè¼¸å‡º
    def preserve_critical_data()      # ä¿è­·é‡è¦æ•¸æ“š
    def optimize_storage_usage()      # å„ªåŒ–å­˜å„²ä½¿ç”¨
```

## ğŸ” æ•¸æ“šå“è³ªä¿è­‰

### TLE æ•¸æ“šæ ¼å¼é©—è­‰
```
STARLINK-1008           
1 44714U 19074B   25217.02554568  .00001428  00000+0  11473-3 0  9994
2 44714  53.0544  88.2424 0001286  82.9322 277.1813 15.06399309315962
```

**é©—è­‰é …ç›®**:
- **æ ¼å¼å®Œæ•´æ€§**: TLE æ¨™æº– 69 å­—å…ƒè¡Œæ ¼å¼
- **æ ¡é©—å’Œé©—è­‰**: modulo-10 æ ¡é©—å’Œæ­£ç¢ºæ€§
- **æ•¸å€¼ç¯„åœæª¢æŸ¥**: è»Œé“åƒæ•¸åˆç†æ€§é©—è­‰
- **æ™‚é–“ä¸€è‡´æ€§**: epoch æ™‚é–“èˆ‡ç•¶å‰æ™‚é–“å·®ç•°æª¢æŸ¥

### SGP4 è¨ˆç®—ç²¾åº¦é©—è­‰
- **ä½ç½®ç²¾åº¦**: èˆ‡å®˜æ–¹ SGP4 åƒè€ƒå¯¦ç¾æ¯”è¼ƒèª¤å·® < 1km
- **é€Ÿåº¦ç²¾åº¦**: è»Œé“é€Ÿåº¦è¨ˆç®—èª¤å·® < 0.1 m/s
- **æ™‚é–“ç²¾åº¦**: è»Œé“é æ¸¬æ™‚é–“ç²¾åº¦ < 1 ç§’

## ğŸš¨ ç•°å¸¸è™•ç†èˆ‡å®¹éŒ¯

### æ•¸æ“šè™•ç†ç•°å¸¸è™•ç†
```python
class DataProcessingErrorHandler:
    def handle_tle_download_failure()  # TLEä¸‹è¼‰å¤±æ•—è™•ç†
    def handle_sgp4_calculation_error() # SGP4è¨ˆç®—ç•°å¸¸è™•ç†  
    def handle_database_connection_loss() # è³‡æ–™åº«é€£ç·šä¸­æ–·è™•ç†
    def rollback_partial_updates()     # éƒ¨åˆ†æ›´æ–°å›æ»¾
```

### å®¹éŒ¯è¨­è¨ˆåŸå‰‡
1. **graceful degradation** - éƒ¨åˆ†å¤±æ•—ä¸å½±éŸ¿æ•´é«”ç³»çµ±
2. **automatic retry** - è‡ªå‹•é‡è©¦æ©Ÿåˆ¶ (æŒ‡æ•¸é€€é¿)
3. **fallback mechanism** - å¤±æ•—æ™‚ä½¿ç”¨ç·©å­˜æ•¸æ“š
4. **health monitoring** - æŒçºŒå¥åº·ç‹€æ…‹ç›£æ§

## ğŸ”® æœªä¾†æ“´å±•è¦åŠƒ

### å¯æ“´å±•æ€§è€ƒé‡
1. **å¤šè§€æ¸¬é»æ”¯æ´**: é™¤å°ç£å¤–ï¼Œå¯æ·»åŠ å…¶ä»–åœ°ç†ä½ç½®
2. **æ›´å¤šæ˜Ÿåº§**: æ”¯æ´ OneWeb, Kuiper ç­‰å…¶ä»–æ˜Ÿåº§
3. **ML é æ¸¬**: åŸºæ–¼æ­·å²æ•¸æ“šé æ¸¬æœªä¾† handover æ¨¡å¼
4. **å¯¦æ™‚æ··åˆ**: æ­·å²æ•¸æ“š + å³æ™‚æ›´æ–°çš„æ··åˆæ¨¡å¼

### ç ”ç©¶åƒ¹å€¼æå‡
1. **è«–æ–‡æ•¸æ“šå¯ä¿¡åº¦**: ä½¿ç”¨çœŸå¯¦æ­·å²è»Œé“æ•¸æ“š
2. **å¯é‡ç¾æ€§**: ç›¸åŒæ™‚é–“æ®µå¯é‡è¤‡åˆ†æ
3. **çµ±è¨ˆåˆ†æ**: å¤§é‡æ­·å²æ•¸æ“šæ”¯æ´çµ±è¨ˆç ”ç©¶
4. **ç®—æ³•é©—è­‰**: çœŸå¯¦å ´æ™¯ä¸‹çš„ handover ç®—æ³•æ¸¬è©¦

## ğŸ¯ æŠ€è¡“è¦æ ¼ç¸½çµ

### æ ¸å¿ƒæŠ€è¡“åƒæ•¸
- **æ™‚é–“è§£æåº¦**: 30 ç§’é–“éš”
- **å¯è¦‹è¡›æ˜Ÿæ•¸**: 6-8 é¡† (ç¬¦åˆ 3GPP NTN æ¨™æº–)
- **è§€æ¸¬ä½ç½®**: å°ç£ (24.94Â°N, 121.37Â°E)
- **æ”¯æ´æ˜Ÿåº§**: Starlink (ä¸»è¦) + OneWeb (å°æ¯”)
- **æ•¸æ“šå­˜å„²**: NetStack RL PostgreSQL

### æ•¸æ“šè™•ç†çµ±è¨ˆ
```
åŸå§‹æ•¸æ“š:     8,730 é¡†è¡›æ˜Ÿ TLE
Stage 1:      å®Œæ•´ SGP4 è»Œé“è¨ˆç®— (96åˆ†é˜è»Œé“é€±æœŸ Ã— 30ç§’é–“éš”)
Stage 2:      æ™ºèƒ½ç¯©é¸è‡³ 1,184 é¡†å€™é¸ (86.4% æ¸›å°‘)
Stage 3:      3GPP A4/A5/D2 äº‹ä»¶åˆ†æ
Stage 4:      å‰ç«¯å‹•ç•«æ•¸æ“šæœ€ä½³åŒ– (60-75MB)
Stage 5:      è·¨ç³»çµ±æ ¼å¼çµ±ä¸€
Stage 6:      å‹•æ…‹æ± è¦åŠƒ (90-110 é¡†æœ€çµ‚æ± )
```

---

**é€™å€‹æ•¸æ“šè™•ç†æµç¨‹å®Œç¾å¹³è¡¡äº†çœŸå¯¦æ€§ã€æ€§èƒ½å’Œå±•ç¤ºæ•ˆæœï¼Œæ˜¯å…¼å…·å­¸è¡“åƒ¹å€¼å’Œå·¥ç¨‹å¯¦ç”¨æ€§çš„å„ªç§€è§£æ±ºæ–¹æ¡ˆï¼**

*æœ€å¾Œæ›´æ–°ï¼š2025-08-18 | æ•¸æ“šè™•ç†æµç¨‹ç‰ˆæœ¬ 3.0.0*