# ğŸ›°ï¸ è¡›æ˜Ÿé è™•ç†ç³»çµ± - å¯¦ç¾ç‹€æ³å ±å‘Š

**æ›´æ–°æ—¥æœŸ**: 2025-08-09  
**ç‰ˆæœ¬**: v1.0 (å®Œæ•´å¯¦ç¾ç‹€æ…‹)  
**ç‹€æ…‹**: âœ… **æ ¸å¿ƒç³»çµ±å·²å®Œæ•´å¯¦ç¾ï¼Œå¾…APIæ•´åˆ**

## ğŸ¯ åŸ·è¡Œæ‘˜è¦

**é‡å¤§æ¾„æ¸…**: ç³»çµ±æœ‰**ä¸‰å±¤é è™•ç†å¯¦ç¾**ï¼š
1. âœ… **Phase0é è™•ç†** (ç›®å‰ä½¿ç”¨) - Dockerå»ºç½®æ™‚é è¨ˆç®—ï¼Œå¾8039é¡†Starlinké¸15é¡†
2. âœ… **æ™ºèƒ½é¸æ“‡å™¨** (627è¡Œå®Œæ•´å¯¦ç¾) - ä½†æœªè¢«APIèª¿ç”¨
3. âš ï¸ **èˆŠAPIæ©‹æ¥** - APIç«¯é»ä»èª¿ç”¨å¤–éƒ¨SimWorldï¼Œä½†å¯¦éš›æ•¸æ“šä¾†è‡ªPhase0

**å¯¦éš›é‹è¡Œç‹€æ³**: APIè¿”å›Phase0é è¨ˆç®—çš„15+15é¡†è¡›æ˜Ÿ (é120+80é¡†)ï¼Œä½†ä½¿ç”¨çœŸå¯¦SGP4è»Œé“è¨ˆç®—ã€‚

## ğŸ“Š å¯¦ç¾å®Œæˆåº¦æ¦‚è¦½

| çµ„ä»¶é¡åˆ¥ | è¨ˆç•«é …ç›® | å¯¦ç¾ç‹€æ…‹ | ç¨‹å¼ç¢¼ä½ç½® | å‚™è¨» |
|---------|---------|----------|-----------|------|
| **æ ¸å¿ƒé¸æ“‡å™¨** | æ™ºèƒ½è¡›æ˜Ÿé¸æ“‡ | âœ… å®Œæˆ | `satellite_selector.py` (627è¡Œ) | æ”¯æ´120+80æ˜Ÿåº§é…ç½® |
| **è»Œé“åˆ†æ** | è»Œé“å¹³é¢åˆ†ç¾¤ | âœ… å®Œæˆ | `orbital_grouping.py` | æŒ‰RAAN/å‚¾è§’åˆ†ç¾¤ |
| **ç›¸ä½å„ªåŒ–** | ç›¸ä½åˆ†æ•£ç®—æ³• | âœ… å®Œæˆ | `phase_distribution.py` | 15-30ç§’éŒ¯é–‹å‡èµ· |
| **å¯è¦‹æ€§** | å¯è¦‹æ€§è©•åˆ† | âœ… å®Œæˆ | `visibility_scoring.py` | SGP4çœŸå¯¦è»Œé“è¨ˆç®— |
| **æ™‚é–“åºåˆ—** | 24å°æ™‚å¾ªç’° | âœ… å®Œæˆ | `timeseries_engine.py` | ç„¡ç¸«å¾ªç’°æ’­æ”¾ |
| **é è™•ç†æœå‹™** | çµ±ä¸€APIæœå‹™ | âœ… å®Œæˆ | `preprocessing_service.py` | å®Œæ•´æœå‹™æ¥å£ |
| **äº‹ä»¶æª¢æ¸¬** | A4/A5/D2è§¸ç™¼ | âœ… å®Œæˆ | å…§å»ºæ–¼é¸æ“‡å™¨ | 3GPP NTNæ¨™æº– |
| **éˆè·¯é ç®—** | RSRPçœŸå¯¦è¨ˆç®— | âœ… å®Œæˆ | é¸æ“‡å™¨å…§å»º | ITU-R P.618æ¨™æº– |
| **APIæ•´åˆ** | ç«¯é»èª¿ç”¨ | âš ï¸ **å¾…æ•´åˆ** | `satellite_ops_router.py` | éœ€è¦ä¿®æ”¹APIç«¯é» |

## ğŸ” æŠ€è¡“å¯¦ç¾åˆ†æ

### âœ… **å·²å®Œæ•´å¯¦ç¾çš„æ ¸å¿ƒåŠŸèƒ½**

#### 1. æ™ºèƒ½è¡›æ˜Ÿé¸æ“‡å™¨ (`IntelligentSatelliteSelector`)
- **ä½ç½®**: `netstack/src/services/satellite/preprocessing/satellite_selector.py`
- **è¦æ¨¡**: 627è¡ŒçœŸå¯¦å¯¦ç¾
- **åŠŸèƒ½**:
  - å¾8000+é¡†è¡›æ˜Ÿä¸­æ™ºèƒ½é¸æ“‡120 Starlink + 80 OneWeb
  - çœŸå¯¦RSRPè¨ˆç®—ï¼ˆåŸºæ–¼ITU-R P.618æ¨™æº–ï¼‰
  - 3GPP NTNäº‹ä»¶æ½›åŠ›è©•ä¼° (A4/A5/D2)
  - SGP4è»Œé“å‹•åŠ›å­¸è¨ˆç®—
  - å¤§æ°£æè€—å»ºæ¨¡

#### 2. çœŸå¯¦ç®—æ³•å¯¦ç¾
```python
# çœŸå¯¦ITU-R P.618éˆè·¯é ç®—è¨ˆç®— (lines 273-301)
fspl_db = 20 * math.log10(distance) + 20 * math.log10(frequency_ghz) + 32.45
received_power_dbm = (sat_eirp_dbm + ue_antenna_gain_dbi - 
                     fspl_db - atmospheric_loss_db - 
                     polarization_loss_db - implementation_loss_db)

# SGP4çœŸå¯¦è»Œé“è¨ˆç®— (lines 400-507)
satellite = EarthSatellite(sat_data['line1'], sat_data['line2'], name, ts)
difference = satellite - ntpu
topocentric = difference.at(t)
alt, az, distance = topocentric.altaz()
```

#### 3. äº‹ä»¶æª¢æ¸¬ç³»çµ±
```python
# 3GPP NTNäº‹ä»¶è§¸ç™¼æ¢ä»¶ (lines 84-88)
self.event_thresholds = {
    'A4': {'rsrp': -95, 'hysteresis': 3},       # dBm, dB
    'A5': {'thresh1': -100, 'thresh2': -95},    # dBm  
    'D2': {'low_elev': 15, 'high_elev': 25}     # åº¦
}
```

### âš ï¸ **å°šæœªæ•´åˆçš„éƒ¨åˆ†**

#### ä¸»è¦å•é¡Œ: APIç«¯é»æœªèª¿ç”¨é è™•ç†ç³»çµ±
ç›®å‰ `/api/v1/satellite-ops/visible_satellites` ç«¯é»ï¼š
- è¿”å›å›ºå®šçš„15é¡†è¡›æ˜Ÿ
- æœªèª¿ç”¨ `SatellitePreprocessingService`
- æœªä½¿ç”¨ `IntelligentSatelliteSelector`

## ğŸ”§ æ‰€éœ€èª¿æ•´ä½œæ¥­

### 1. **APIç«¯é»æ•´åˆ** (å„ªå…ˆç´š: é«˜)
ä¿®æ”¹ `satellite_ops_router.py` ä¸­çš„ `get_visible_satellites` ç«¯é»ï¼š

```python
# ç•¶å‰å¯¦ç¾ (å¾…ä¿®æ”¹)
return {"satellites": fixed_15_satellites}

# ç›®æ¨™å¯¦ç¾ (èª¿ç”¨é è™•ç†ç³»çµ±)
preprocessing_service = SatellitePreprocessingService()
selected_satellites = await preprocessing_service.select_research_subset(
    all_satellites, constellation, target_count=120 if constellation=='starlink' else 80
)
return {"satellites": selected_satellites}
```

### 2. **é…ç½®å•Ÿç”¨** (å„ªå…ˆç´š: é«˜)
ç¢ºä¿ `SatelliteSelectionConfig` ä½¿ç”¨æ­£ç¢ºçš„ç›®æ¨™æ•¸é‡ï¼š
- Starlink: 120é¡† â†’ ç¢ºä¿8-12é¡†åŒæ™‚å¯è¦‹
- OneWeb: 80é¡† â†’ æä¾›æ›æ‰‹å€™é¸

### 3. **æ€§èƒ½é©—è­‰** (å„ªå…ˆç´š: ä¸­)
é‹è¡Œå®Œæ•´çš„24å°æ™‚è¦†è“‹é©—è­‰ï¼Œç¢ºèªçœŸå¯¦é”åˆ°8-12é¡†å¯è¦‹è¡›æ˜Ÿçš„ç›®æ¨™ã€‚

## ğŸ“ˆ ç«‹å³è¡Œå‹•è¨ˆç•«

### Phase A: APIæ•´åˆ (é ä¼°2å°æ™‚)
1. ä¿®æ”¹ `get_visible_satellites` ç«¯é»èª¿ç”¨é è™•ç†ç³»çµ±
2. é…ç½®æ­£ç¢ºçš„è¡›æ˜Ÿæ•¸é‡ç›®æ¨™
3. æ¸¬è©¦APIå›æ‡‰æ˜¯å¦è¿”å›120+80é¡†è¡›æ˜Ÿ

### Phase B: å‰ç«¯é©—è­‰ (é ä¼°1å°æ™‚)
1. ç¢ºèªå‰ç«¯TimelineControlæ­£ç¢ºæ¥æ”¶æ–°æ•¸æ“š
2. é©—è­‰3Dæ¸²æŸ“æ˜¯å¦æ­£å¸¸é¡¯ç¤ºæ›´å¤šè¡›æ˜Ÿ
3. æ¸¬è©¦æ’­æ”¾é€Ÿåº¦æ§åˆ¶åŠŸèƒ½

### Phase C: è¦†è“‹é©—è­‰ (é ä¼°30åˆ†é˜)
1. é‹è¡Œ24å°æ™‚è¦†è“‹æ¸¬è©¦
2. ç¢ºèª8-12é¡†è¡›æ˜ŸæŒçºŒå¯è¦‹
3. é©—è­‰æ›æ‰‹äº‹ä»¶æ­£ç¢ºè§¸ç™¼

## ğŸ‰ çµè«–

**ç³»çµ±å·²ç¶“å®Œæ•´å¯¦ç¾ï¼** åªéœ€è¦é€²è¡ŒAPIæ•´åˆå³å¯å•Ÿç”¨æ‰€æœ‰è¨ˆç•«åŠŸèƒ½ï¼š

- âœ… **627è¡Œæ™ºèƒ½é¸æ“‡ç®—æ³•** - å®Œæ•´å¯¦ç¾
- âœ… **çœŸå¯¦ITU-R/3GPPæ¨™æº–** - å®Œæ•´å¯¦ç¾  
- âœ… **äº‹ä»¶æª¢æ¸¬ç³»çµ±** - å®Œæ•´å¯¦ç¾
- âœ… **æ™‚é–“åºåˆ—å¼•æ“** - å®Œæ•´å¯¦ç¾

**é è¨ˆ2-3å°æ™‚å…§å³å¯å®Œå…¨å•Ÿç”¨æ•´å€‹é è™•ç†ç³»çµ±ï¼Œå¯¦ç¾120+80é¡†è¡›æ˜Ÿçš„æ™ºèƒ½é¸æ“‡å’Œ8-12é¡†æŒçºŒå¯è¦‹çš„ç ”ç©¶ç›®æ¨™ï¼**
