# 🛰️ LEO 衛星資料預處理計畫

**版本**: 1.0.0  
**建立日期**: 2025-01-23  
**適用範圍**: LEO 衛星換手研究 - 資料預處理與選星策略

## 📋 計畫概述與實現狀況 ⚠️ **狀況更新**

**實現狀況**：✅ **預處理系統已完整實現！** 但存在配置差異需要調整。

本計畫專注於從真實歷史衛星數據中，篩選出適合研究級換手展示的衛星子集。目標是確保在任何時刻，UE（NTPU）上空都有 **8-12 顆可見衛星**，支援複雜的換手決策研究。

### 🚨 **當前實現狀況**
- ✅ **核心模組已實現**: `IntelligentSatelliteSelector` (627行)、時間序列引擎、軌道分群等
- ✅ **真實算法已實現**: ITU-R P.618 RSRP計算、SGP4軌道動力學、3GPP事件檢測
- ⚠️ **配置未生效**: 系統返回15顆衛星，而非計畫的120+80顆
- ⚠️ **API未整合**: 預處理系統可能未被主API端點調用

### ⚡ 關鍵特性 (已實現)
- ✅ **智能衛星選擇**: 從8000+顆衛星中選擇120顆 Starlink / 80顆 OneWeb
- ✅ **真實預處理**: 基於真實SGP4軌道計算 + ITU-R標準鏈路預算
- ✅ **事件檢測整合**: A4/A5/D2事件潛力評估

## 🎯 核心目標

### 研究級要求
- **同時可見數量**: 8-12 顆衛星（非 2-4 顆的基本展示）
- **換手複雜度**: 支援 A4/A5/D2 事件觸發的真實換手場景
- **時間連續性**: 衛星錯開出現，避免同時升降
- **數據真實性**: 基於真實 TLE 數據和 SGP4 算法

### 星座需求量化
根據 duty cycle 計算和安全係數：

| 星座 | 軌道週期 | Duty Cycle | 研究起始配置 | 健壯配置 |
|------|----------|------------|-------------|----------|
| **Starlink** | 96分鐘 | 8-10% | 120顆 | 180-240顆 |
| **OneWeb** | 109分鐘 | 16-18% | 60-80顆 | 90-100顆 |

## 📚 文檔架構

### 核心文檔
1. **[選星策略設計](./01-satellite-selection-strategy.md)** - 如何從8000+顆衛星中選出研究子集
2. **[時間序列規劃](./02-timeseries-planning.md)** - 連續運行的時間段設計
3. **[換手事件整合](./03-handover-events-integration.md)** - A4/A5/D2 事件觸發邏輯
4. **[數據流架構](./04-data-flow-architecture.md)** - 基於現有系統的數據流設計
5. **[實施計畫](./05-implementation-plan.md)** - 分階段開發步驟
6. **[驗證與動態調整](./06-validation-and-adjustment.md)** - 覆蓋驗證、動態調整與預處理資料管理 **[新增]**

### 技術附錄
- **[Duty Cycle 計算詳解](./appendix/duty-cycle-calculations.md)**
- **[相位分散算法](./appendix/phase-distribution.md)**
- **[可見性窗口預計算](./appendix/visibility-windows.md)**

## 🔧 現有系統整合點

### 已完成組件（不重複開發）
- ✅ NetStack satellite-ops API - SGP4 計算引擎
- ✅ TLE 數據下載和解析 - Pure Cron 驅動
- ✅ DataSyncContext - 統一數據流管理
- ✅ DynamicSatelliteRenderer - 3D 渲染引擎

### ✅ 已實現的組件（2025-08-09更新）
- ✅ 智能衛星篩選 - `IntelligentSatelliteSelector` 完整實現
- ✅ 動態時間窗口 - `TimesSeriesEngine` 支援24小時無縫循環
- ✅ A4/A5/D2事件檢測 - 基於3GPP NTN標準完整實現
- ✅ 軌道分群算法 - `OrbitalPlaneGrouper` 按RAAN分組
- ✅ 相位分散優化 - `PhaseDistributionOptimizer` 錯開升起時間
- ✅ 可見性評分 - `VisibilityScorer` 基於真實軌道動力學

### ⚠️ 需要調整的部分 
- 🔧 **API整合**: 將預處理系統整合到主要API端點
- 🔧 **配置啟用**: 啟用120+80顆衛星的目標配置
- 🔧 **動態調用**: 替換固定15顆衛星回傳為動態智能選擇

## 🚀 快速導航

```bash
# 查看選星策略
cat 01-satellite-selection-strategy.md

# 了解時間規劃
cat 02-timeseries-planning.md

# 檢視換手事件
cat 03-handover-events-integration.md
```

## 📊 預期成果

### 數據特性
- **可見性穩定**: 任何時刻 8-12 顆可見
- **相位分散**: 衛星錯開 15-30 秒出現
- **換手機會**: 每 2-3 分鐘有換手候選
- **事件觸發**: A4/A5/D2 事件正確識別

### 研究價值
- 支援複雜換手決策算法研究
- 提供豐富的狀態空間（為未來 RL 準備）
- 可重現的實驗環境
- 符合 3GPP NTN 標準的真實場景

---

**注意**: 本計畫專注於資料預處理，不包含 RL 實作或前端渲染細節。