1. **階段一：基礎環境整合 (Phase 1: Initial Environment Integration)**

    - **功能與目標 (Function & Goals):** 建立 NTN 模擬的基本環境，確保 Open5GS 核心網與 UERANSIM 模擬的 5G RAN 正常連接。驗證 UE 可以透過「衛星節點」成功附著並建立 PDU 會話，為後續換手機制的開發打下基礎。
    - **後端需要完成的任務 (Back-end Tasks):**

        - 部署並配置 Open5GS 5G 核心網元（AMF, SMF, UPF 等）以及 UERANSIM 的 5G gNB 和 UE 模擬器，使其在本地網路環境下協同運作。確保基本 5G 訊號流程（RRC 連接建立、NAS 附著、PDU Session 建立等）能夠完成。
        - 將 UERANSIM 的 gNB 視為一顆靜止的「衛星基站」，設定其對應的 PLMN 和核心網參數，使 UE 能透過該 gNB 註冊到 Open5GS。配置基本的 FastAPI 服務端，以 Python 撰寫簡易後端，可在日後提供軌道預測與控制介面。
        - 測試核心網與 RAN 的連接（如透過 Wireshark 或 Open5GS 日誌觀察 NGAP 訊息），確認 UPF 已建立 GTP-U 通道，可傳送用戶平面資料。進行 UE 向核心網發送 ping 封包的測試，記錄延遲以作為基準。

    - **前端需要完成的任務 (Front-end Tasks):**

        - 初始化 React 專案並整合 Three.js，搭建基本頁面框架。使用 Blender 匯出的地球模型（glb 格式）作為場景背景，確認 Three.js 場景渲染正常。
        - 添加一個簡單的衛星模型（或使用圖標表示）和一個 UE 位置標記於 Three.js 場景中。暫時將衛星位置固定在地球上空某處，UE 標記在地表對應位置，以對映後端模擬環境中的 gNB 與 UE 位置。
        - 建立前後端通信機制（例如通過 WebSocket 或定期輪詢後端 API），即時獲取 UE 連線狀態。將 UE 是否連上網路、IP 配置等基本資訊在前端顯示，作為連線成功的視覺指示。

    - **成果驗證 (Verification):**

        - 啟動整套系統後，觀察 UE 是否能成功註冊附著至 5G 核心網元（確認 Open5GS 日誌出現 Registration Accept、PDU Session Establishment 完成等訊息）。
        - 在 UE 端執行`ping`測試（例如對核心網或互聯網目標 IP），確認能收到回應並統計平均延遲。此延遲將作為日後比較換手優化效果的基準數據。
        - 前端畫面應顯示 UE 已連線的狀態，例如以綠色連線線條將 UE 標記和衛星模型相連，表示數據通路暢通。確保前端所示狀態與後端真實流程一致，如 UE 斷開時前端連線指示變為中斷。

2. **階段二：衛星軌道模擬與標準換手 (Phase 2: Satellite Orbit Simulation & Standard Handover)**

    - **功能與目標 (Function & Goals):** 引入衛星運行的模擬，讓「衛星基站」隨時間移動以覆蓋/脫離 UE 所在位置，觸發標準的 5G 換手流程。觀察並量化傳統換手在 LEO 衛星環境中的延遲和服務中斷時間，為後續優化提供對照。
    - **後端需要完成的任務 (Back-end Tasks):**

        - 使用 Skyfield 或類似的天體軌道庫，載入真實 LEO 衛星（如 Starlink）軌道參數或自行設計兩顆模擬衛星軌道。實現衛星隨時間的軌跡更新函數：例如每秒計算衛星的經緯度和高度，判斷 UE 與當前衛星的相對位置和仰角。
        - 設定兩顆衛星 gNB 實例（如 UERANSIM 啟動兩個基站服務），初始時 UE 連接第一顆衛星 gNB。隨著時間推進，當第一顆衛星離開 UE 覆蓋範圍（如仰角低於門檻）時，觸發 UE 換手至第二顆衛星。實作標準的 Xn 或 N2 換手流程：如在源 S-gNB 偵測到需要換手時，透過 AMF 觸發 PathSwitch 或直接由源 gNB 通知目標 gNB 進行準備。需要可能修改 UERANSIM 或撰寫腳本使其支援換手訊號（UERANSIM 預設未完整實作換手，可利用 GitHub 社群實現的 Xn 換手補丁）。
        - 核心網 Open5GS 維持默認行為：當目標 gNB 接管 UE 後，由目標 gNB 或 AMF 發送 Path Switch Request 給核心網，SMF/UPF 更新 UE 的 GTP 隧道終點至新的衛星 gNB。確保 Open5GS 的 AMF/SMF 能夠處理這一換手過程（必要時調整其配置，如允許多個 gNB 註冊同一 PLMN）。

    - **前端需要完成的任務 (Front-end Tasks):**

        - 在 Three.js 場景中實現衛星運行的動畫。根據後端 Skyfield 計算的衛星即時位置，用`three.js`更新兩顆衛星模型在地球周圍的軌跡位置，使其繞地球移動。衛星模型應附帶可視化其覆蓋範圍（例如以半透明圓錐或光束表示該衛星的信號覆蓋區域）。
        - 增強前端 UE 表示方式，顯示 UE 當前連接的是哪顆衛星。可以透過不同顏色的連線或在 UE 標記旁標註當前服務衛星的名稱/編號實現。當換手發生時，應即時更新此連線指示，例如切換連線線條連接 UE 與新的衛星，同時高亮顯示換手事件。
        - 新增事件日誌模組：在前端介面上實時顯示關鍵事件（例如「時間 T: 衛星 A->衛星 B 換手開始」「時間 T+Δ: 換手完成」等），這些事件可由後端透過 WebSocket 推送或前端定時檢查後端狀態得到。方便開發者直觀了解換手時序。

    - **成果驗證 (Verification):**

        - 通過觀察 Open5GS 和 UERANSIM 日誌，確認發生了標準換手流程。例如 AMF 日誌出現 Path Switch 請求、UE RRC 層收到 RRC Reconfiguration（HO command）等。在 UERANSIM UE 端日誌中應看到換手相關的 RRC/NAS 消息序列，證明換手成功執行。
        - 衡量換手延遲和封包丟失：在 UE 連續執行`ping`的同時觸發換手，紀錄在切換過程中 ping 是否出現高延遲或中斷。量化從源 gNB 釋放 UE 到目標 gNB 恢復數據傳輸的時間間隔，作為標準換手延遲基線。
        - 前端可視化應該清晰展現換手過程：當第一顆衛星遠離時，UE 的連線線條轉為斷開或顯示警示，隨後在目標衛星處重新建立。事件日誌中應有條目對應換手開始和結束時間。若一切正常，換手後 UE 應繼續成功 ping 通，前端指示連線恢復正常。

3. **階段三：衛星軌跡預測模組 (Phase 3: Satellite Trajectory Prediction Module)**

    - **功能與目標 (Function & Goals):** 開發衛星軌道預測功能，為後續提前選擇目標衛星提供依據。透過預測未來時刻 UE 的可見衛星清單，建立“衛星接入計畫”，使核心網能預先知道 UE 下一顆將連接的衛星。這實現了利用 LEO 衛星可預測軌跡特性的關鍵步驟。
    - **後端需要完成的任務 (Back-end Tasks):**

        - 利用 Skyfield 讀取衛星星歷數據（TLE），實現給定時間輸出衛星位置的函式。針對模擬環境中的每顆衛星，定義它們的軌道參數（若使用真實 Starlink 星歷，需選取適當的 TLE 集合）。編寫預測演算法：輸入地面 UE 位置與時間，輸出該時間可服務該 UE 的最佳衛星。標準可採用最高仰角或最近距離作為“最佳”衛星的判據。
        - 將上述預測功能封裝為服務介面，例如透過 FastAPI 提供`/predict_next_satellite?ue_id=X&time=T`的 API，返回預測未來某時間點 UE 將連接的衛星 ID。也可提供批量預測，例如預測從現在起每 Δt 間隔的接入衛星變化。
        - 確保預測考慮了動態條件：例如如果需要可以引入簡單的大氣延遲或天氣因子（可從氣象 API 獲取假數據）來模擬軌跡預測誤差。核心網將來可根據需要頻繁調用此模組來更新預測結果。

    - **前端需要完成的任務 (Front-end Tasks):**

        - 在 3D 地球上繪製衛星軌道路徑：根據後端提供的軌道數據，在 Three.js 中為每顆衛星繪製軌跡（例如一條環繞地球的曲線）。讓開發者能直觀看到衛星未來的運行路線，以及某衛星何時會抵達指定位置上空。
        - 加入預測結果的可視化：當前端請求預測某 UE 在未來 t 秒後將連接的衛星時，將該衛星模型高亮顯示，並在 UE 與該衛星間繪制虛線，表示預計的連線切換路徑。亦可在介面上方顯示文字如「預計 X 秒後：UE 將由衛星 A 換至衛星 B」。
        - 建立使用者介面元素允許測試預測功能，例如時間軸滑桿或按鈕：「預測 5 秒後狀態」、「預測下次換手時間」。操作時，前端調用後端預測 API 並將結果反映在 3D 場景和日誌區，確保預測資訊易於理解。

    - **成果驗證 (Verification):**

        - 對比預測結果與實際情況：選取未來某一時刻 T，由後端計算 UE 在 T 時刻的應接入衛星，並等待模擬運行至 T 時刻觀察 UE 實際連接的衛星。若預測與實際不一致，記錄差異原因（如預測誤差或未考慮 UE 移動），調整演算法。
        - 驗證預測延遲與性能：模擬多個 UE 的情況，批量請求未來一系列時刻的接入衛星預測，確保演算法在合理時間內完成計算，不會對核心網造成阻塞。此處可記錄 CPU 耗時，確認隨 UE 數量線性伸縮。
        - 在前端觀察：當預測下一次換手衛星後，讓模擬繼續運行直到換手實現。確認前端虛線切換連線在換手發生時變為實線，且所示換手時間與實際換手事件非常接近。事件日誌應提前顯示「預計換手：衛星 A -> 衛星 B 於 T 時刻」，並在 T 時刻註記「實際換手執行」，兩者時間相差在可接受範圍內（例如與 RAN 換手流程所需時間量級相當）。

4. **階段四：精細同步演算法實作 (Phase 4: Fine-Grained Synchronization Algorithm)**

    - **功能與目標 (Function & Goals):** 實現論文提出的 RAN 與核心網（UPF）去中心化同步機制。透過定期預測與比較未來兩個時刻的衛星連接情況，精確計算換手觸發時間，讓核心網預先與 RAN 達成“時間同步”：即使在無傳統控制訊號交換下，核心網也能得知換手將於何時發生。此階段目標是在後端邏輯上重現同步演算法，尚未修改資料轉發流程。
    - **後端需要完成的任務 (Back-end Tasks):**

        - 定義同步演算法的周期 Δt，例如 Δt 可根據衛星移動速度和換手開銷選定（如 5 秒或 30 秒）。每隔 Δt 執行以下步驟： (1) 計算未來 T+Δt 時刻每個 UE 各自的預期服務衛星 AT+Δt（利用階段三的軌跡預測模組)。(2) 再預測更遠一點未來 T+2Δt 時刻的服務衛星 AT+2Δt。 (3) 將兩次預測結果進行對比，找出對於哪些 UE，AT+Δt 與 AT+2Δt 不同，表示在區間(T+Δt, T+2Δt)內必定發生換手。
        - 對於需要換手的 UE，使用二分搜尋法在(T+Δt, T+2Δt)時間區間內尋找精確的換手觸發時刻 Tp。具體作法：計算 T+1.5Δt 時刻 UE 的接入衛星，與 AT+Δt 進行比較以縮小換手發生時間範圍，如此反覆迭代，直到時間誤差小於 RAN 完成一次換手流程所需的時間（數百毫秒級別）。將得到的精確換手時間 Tp 存入記錄。
        - 實作上述演算法邏輯，維護一張臨時的預測結果表 R，用於存放每個 UE 當前的接入衛星 AT、下個周期的接入衛星 AT+Δt、以及預測的換手觸發時間 Tp 集合。注意在時間推進至 T+Δt 時才更新整張表 R，以確保 RAN 與核心對“目前時刻的下個衛星”觀點一致（避免過早更新導致的不同步）。
        - 增強對 UE 移動的即時響應：除了週期性更新，當接收到特定 UE 位置發生改變的事件（例如 UE 重新註冊或移動超過一定距離）時，即刻針對該 UE 執行一次同步演算法更新。這需要從 RAN 接收 UE 位置變化通知，在本階段可先模擬此機制，如 UE 每移動一定距離時呼叫後端 API 通知。

    - **前端需要完成的任務 (Front-end Tasks):**

        - 顯示同步演算法計算結果：在前端為每個 UE 新增狀態面板，展示該 UE 的**當前衛星**、**下一周期衛星**以及**預測的換手時間 Tp**。例如：「UE1 - Current: 衛星 A；Next: 衛星 B；Predicted HO at: 12:30:15.5」。這可透過調用後端 API 獲取表 R 內容實現。
        - 在 3D 視圖上強調即將發生換手的 UE 和衛星：例如當 Tp 接近（如距現在< Δt）時，將 UE 標記與目標衛星高亮，或閃爍連線提醒開發者即將換手。也可在地球上用一個倒計時計時器懸浮標示「距離 UE1 換手還有 X 秒」。
        - 將同步演算法相關事件納入日誌：例如「時間 T0：週期更新完成，X 個 UE 預測將在未來換手」「時間 T1：UE1 預計換手觸發，計算 Tp=...」。這些資訊有助於前端人員了解演算法運行是否如預期。

    - **成果驗證 (Verification):**

        - 檢查表 R 內容的正確性：手動選取某一 UE，在接近 Tp 時觀察實際換手是否發生，且發生時刻與表 R 的 Tp 記錄相符。如果某 UE 表 R 標示未來 5 秒內將換手，則確認模擬中該 UE 確實在約 5 秒後換手至預期的新衛星。多次測試不同情況下 Tp 計算精度，確保預測誤差控制在換手流程可接受範圍內（例如 Tp 誤差小於 100ms）。
        - 確認同步演算法沒有明顯漏判或誤報：若表 R 指示某 UE 在當前周期不需換手（AT+Δt 與 AT+2Δt 相同），觀察整個 2Δt 期間 UE 果真未發生換手。反之，若實際出現未預期的換手，需分析原因（例如 UE 移動導致預測失準）並完善算法。
        - 觀察系統資源消耗：在有多 UE 情境下監控後端演算法運算時間和 CPU 佔用，確定即使 UE 數量增加，同步演算法週期執行也不會造成系統過載。可逐漸增加模擬 UE 數目（如 10、50、100）觀察計算開銷成線性或亞線性增長，符合論文所述透過特性減輕計算壓力的目標。

5. **階段五：UPF 表格維護與資料路徑調整 (Phase 5: UPF Table Maintenance & Data Path Adaptation)**

    - **功能與目標 (Function & Goals):** 在核心網的 UPF 中實作表 R，並將其與實際資料轉發路徑相結合，實現“不經控制訊號的快速換手”。UPF 將提前維護當前及下一接入衛星的 GTP 隧道資訊，於換手發生時自動切換資料轉送路徑。此階段目標是改造 UPF/SMF，使下行資料包不需等待傳統的 Path Switch 控制消息即可快速轉往新路徑。
    - **後端需要完成的任務 (Back-end Tasks):**

        - 修改 Open5GS 的 UPF 元件，將階段四維護的表 R 正式整合進 UPF 流程。為每個 UE 在 UPF 中新增一筆記錄，包括：UE 識別資訊（如 GTP TEID、UE IP、PDU 會話 ID 等）、目前服務衛星的 GTP-U 端點（TEID_sat、IP_sat）、下一預備衛星的 GTP-U 端點（TEID\_{p-sat}、IP\_{p-sat}），以及預測的換手時間 tp。確保 UPF 能通過 SMF/AMF 取得目標衛星 gNB 的 IP 和 TEID（可以在換手前通過 Xn Step 1/2 交換或 SMF 預先建立第二條隧道）。
        - 實作 UPF 的資料轉發邏輯更新：當 UPF 收到下行資料包時，查詢表 R 獲取對應 UE 當前應使用的隧道端點資訊。如果當前時間尚未達到 tp，則使用當前衛星的 TEID_sat 和 IP_sat 封裝 GTP-U 頭並將封包送往源 S-gNB；若當前時間已超過預測的 tp（或檢測到 UE 已完成換手），則切換為使用下一衛星的 TEID\_{p-sat}和 IP\_{p-sat}封裝並發送。如此實現核心網無須等待控制面命令，即可基於時間自動完成資料路由切換。
        - 配合 SMF 的調整：在換手發生之前，由 SMF 提前為 UE 建立在目標衛星 gNB 的 PDUSession 承載（如分配好新的 GTP TEID），並更新表 R 中的下一衛星端點資訊。這可能需要修改 Open5GS SMF 的 Nsmf_PDUSession 流程，使其在檢知到 UPF 表 R 中某 UE 即將換手時，提前發送建立新隧道的 PFCP 訊息給 UPF。SMF 也應忽略傳統 Path Switch 過程中的重覆隧道建立，避免影響已預先建立的通道。
        - 修改 UERANSIM 的 S-gNB 行為：為了讓 UPF 準確掌握 UE 位置變化，需在 UERANSIM 的 gNB 端實作將 UE 位置信息寫入 GTP-U 擴展頭。當 UE 在覆蓋區內移動或換手完成時，源或目標 S-gNB 在上行數據的 GTP-U 封包中附帶 UE 的新位置座標。UPF 解析該擴展頭，如發現 UE 位置信息有改變，立即調用同步演算法更新該 UE 的表 R 記錄，以保持路由決策的準確性。

    - **前端需要完成的任務 (Front-end Tasks):**

        - 擴展網路狀態視覺化：在前端展示每個 UE 的當前隧道資訊。例如：「UE1: 現網隧道-> 衛星 A (TEID=X)、預備隧道-> 衛星 B (TEID=Y)、預計換手\:t=Tp」。當 Tp 逼近或已過時，動態更新此資訊，讓開發者了解 UPF 內部狀態變化。
        - 動態封包路由演示：模擬下行數據流，在前端用動畫表示資料封包如何從 UPF 送達 UE。例如，可以在 Three.js 場景中以小球或光點沿線條移動代表封包流動。正常狀態下小球從 UPF 經衛星 A 到 UE；在換手瞬間，前端應顯示小球改走經衛星 B 的路徑。此可根據後端提供的事件（如「切換下行路由至衛星 B」）來驅動動畫轉換。
        - 錯誤情境提示：在前端介面上增加當換手異常時的提示。如若 UPF 偵測到下行封包傳送失敗（可能由於預測時間誤差導致封包送錯衛星)，前端應高亮顯示對應 UE 的警告，提示可能的“異常換手”。這需要後端監控封包投遞情況，透過事件回報機制通知前端。

    - **成果驗證 (Verification):**

        - **換手時延測試：** 重複階段二的 ping 測試，在實施同步演算法+UPF 自動切換後測量換手期間的中斷時間是否明顯縮短。理想情況下，因為跳過了控制面交互，換手中斷應接近 UE 無線側重新接入的時間（毫秒級）。統計多次換手的 ping 延遲，與未優化前相比應有顯著降低。若論文結果約為 10 倍差異，可驗證本實作是否達到類似量級的改善。
        - **資料連續性：** 在換手瞬間觀察下行資料流：例如在換手發生前後持續發送數據（使用 iperf 模擬連續下行流量），確認 UPF 自動將封包導向新路徑且 UE 無需重新初始化 PDU 會話即可繼續收包。抓取 UPF 端封包，檢查換手前後 GTP-U 目的 IP/TEID 是否按照表 R 設定的時間切換。理想結果是 UE 僅在 RRC 切換階段有極短暫的停頓，隨後流量無縫恢復。
        - **同步一致性：** 核對 UPF 表 R 的更新與 RAN 行為：例如表 R 中某 UE 的 next-access 衛星為 B 且 tp=T，則在 T 時刻應看到 UERANSIM 日誌裡該 UE 完成向衛星 B 的切換。同時 Open5GS 日誌中不應出現傳統的 N2 換手嚴格時序消息（Step 4-9 被跳過），僅可能在事後有資源釋放消息，表示控制面交互已降至最低。

6. **階段六：換手計算負荷優化 (Phase 6: Handover Computation Load Optimization)**

    - **功能與目標 (Function & Goals):** 優化同步演算法的計算，利用 LEO 星座的空間分佈特性和 UE 接入策略減少不必要的預測計算。透過限制需重點關注的 UE 和衛星集合，使核心網預測更高效。例如，只對即將進入邊界區域的 UE 計算精細換手時間，或使用分散式計算將預測任務部分下放。確保系統在大量 UE 規模下依然能及時計算換手計畫，不會因計算量激增而延誤同步。
    - **後端需要完成的任務 (Back-end Tasks):**

        - 實作 UE 分組和區域過濾：根據衛星覆蓋的獨特空間分佈，將 UE 按地理區域或所屬衛星劃分群組。假設同一衛星覆蓋下的 UE 將有相似的換手時間，則演算法可以選擇一組代表性 UE 進行詳細預測，其他 UE 共享結果，以降低計算次數。
        - 改善衛星選擇的算法：在計算 UE 的下一接入衛星時，引入簡化步驟，避免對整個星座遍歷搜索。例如，利用接入策略（如“永遠連接仰角最高的衛星”）縮小候選衛星範圍，只計算鄰近於 UE 當前衛星軌道的幾顆衛星。也可以預先建立鄰接衛星對照表，對於每顆衛星列出接替它覆蓋同一區域的可能目標，查表即可得 UE 下一可能連接的衛星集合。
        - 如果有多台伺服器或多個核心網元，考慮將預測計算去中心化：例如由各個 S-gNB 或區域邊緣節點分擔部分 UE 的軌跡計算，僅將結果上報 UPF 彙總。實現在模擬中可通過多執行緒或異步任務，按衛星或區域劃分計算任務並行處理，衡量效率提升。
        - 增加計算性能監控：在後端為預測模組添加統計，例如每次同步演算法運行耗時、預測計算次數等，將這些數據記錄並暴露給前端，以便直觀了解優化效果。

    - **前端需要完成的任務 (Front-end Tasks):**

        - 在前端儀表板上展示計算負荷相關指標，如「每周期預測計算 X 次、平均耗時 Y ms、正在重點跟踪 Z 個 UE」。透過對比優化前後的數值變化，顯示演算法優化的成效（例如計算次數降低了多少）。
        - 以圖表方式呈現 UE 數量與計算時間的關係：例如增加 UE 模擬數時，前端曲線圖實時更新每周期演算法耗時。預期優化後曲線斜率減緩，證明核心演算法擴展性提升。
        - 在 3D 場景中，可視化地標示出目前屬於“重點預測”的 UE 或區域。例如以不同顏色或圖標表示正在進行精細換手時間計算的 UE，讓開發者瞭解優化策略如何挑選對象。當某區域 UE 眾多時，也許只高亮部分代表 UE 表示群組計算。

    - **成果驗證 (Verification):**

        - 於不同 UE 規模下（例如 10、100、500 個 UE）運行系統，比較啟用優化前後，每周期同步演算法的總計算時間和 CPU 使用率。預期經由空間分佈過濾和候選縮減後，計算負荷明顯下降，例如 100UE 情境下計算耗時由優化前的 X 毫秒降為 Y 毫秒。此結果對應論文中降低核心計算壓力的貢獻。
        - 驗證優化對準確性的影響：確認經優化後的預測算法仍能準確預測換手時間和目標衛星。關注有無因為略過某些 UE 或候選衛星而漏掉換手情境的情況。如發現某 UE 實際發生換手但因優化策略未提前計算，則調整策略（例如縮小 UE 分組或增加候選）。確保優化在降低計算的同時不犧牲太多精度。
        - 模擬長時間運行（例如模擬幾小時的衛星運行）：觀察系統是否能持續穩定地按計畫更新，而不會因 UE 數量或計算積累導致延遲堆積。若長時間運行中同步時序依然緊跟實際時間（沒有明顯滯後），表示優化成功。

7. **階段七：衛星選擇方案優化 (Phase 7: Optimized Satellite Selection Scheme)**

    - **功能與目標 (Function & Goals):** 改進 UE 選擇目標衛星的策略，實現論文提出的“快速衛星選擇”機制。透過在換手決策中加入衛星運行方向等約束，使 UE 盡可能切換到軌道運行方向相近的衛星，以延長下一連線的維持時間、減少頻繁換手。同時驗證此策略對換手時延的影響，使換手流程更高效。
    - **後端需要完成的任務 (Back-end Tasks):**

        - 實現“相似航跡優先”算法：在同步演算法選定 UE 下一接入衛星時，除了考慮可用性和訊號強度，增加一項條件——優先選擇與當前衛星運行方向相同或相近的候選。例如若當前衛星沿軌道由西向東移動，則盡量選擇下一顆同樣由西向東運行且即將覆蓋 UE 的衛星，而非選擇來自反方向軌道的衛星。這可透過比較候選衛星的軌道傾角和運行方向實現。
        - 更新接入策略：修改階段三的軌跡預測模組或同步演算法，使其在計算 AT+Δt 和 AT+2Δt 時採用上述優化策略。必要時引入一個簡單約束：若預測的下一衛星與當前衛星軌道方向差異過大，則嘗試選擇次優候選（方向相近者）作為新的 AT+Δt，除非次優者訊號明顯不足。
        - 在 SMF/AMF 的換手決策中也體現該策略：即在源 S-gNB 選擇目標 S-gNB 時（Xn 換手第 1 步），參考核心網提供的建議清單，偏好選取運行方向匹配的衛星 gNB 作為目標。如有多個鄰近衛星可選，則排序時把軌道方向相同者列前。確保這一策略兼容 3GPP 標準邏輯（可將其作為一種擴展的測量/選網準則）。
        - 模擬更多衛星節點場景：為測試此策略優勢，擴大衛星數量至例如 4 顆，使 UE 在不同策略下可能有不同的目標選擇。記錄傳統策略（僅基於訊號強度）與優化策略下，UE 在一段時間內經歷的換手次數和每次連線維持時間，以便比較。

    - **前端需要完成的任務 (Front-end Tasks):**

        - 在 3D 視圖中展示衛星軌道方向：例如給每顆衛星模型添加箭頭標記其運行方向，或使用不同顏色區分東行與西行軌道。讓開發者清晰辨識哪些衛星屬於相似方向。
        - 在 UE 狀態面板新增「策略選擇結果」欄位：例如顯示「下一衛星：B（同向優選）」或「下一衛星：C（反向）」，提示所選目標是否符合優化策略。如果 UE 並未選擇同向衛星，也可以標示原因（如無同向衛星覆蓋）。
        - 增加圖表對比模式：前端提供一個切換，讓使用者選擇啟用或停用“相似方向優先”策略，並即時看到對換手狀況的影響。例如在介面上以統計圖形式顯示最近 N 分鐘內系統總換手次數或平均每 UE 換手延遲。使用者切換策略後，這些數據曲線應產生變化。

    - **成果驗證 (Verification):**

        - **換手頻次對比：** 比較 UE 在未使用優化策略與使用策略時的換手頻率。預期應觀察到使用同向優先策略後，每個 UE 的換手次數減少、平均連線持續時間變長，因為 UE 不會切換到“逆向而行”很快遠離的衛星。統計多個 UE 的平均值，確認此趨勢明顯。
        - **時延改善：** 測量換手過程的總時延是否因為策略優化有所降低。雖然同向策略主要影響換手頻率，但也可能透過減少極端情況提升換手穩定性。驗證方法可以觀察換手過程中 RRC 信令和資料中斷時間，有無由於更從容的切換而縮短。若論文聲稱此策略可降低換手時延，可對比應驗其結果。
        - **策略適配性：** 測試各種情境下策略的有效性，例如 UE 高速移動或不同緯度位置。確認在這些情況下，同向優先策略不會出現反效果（比如錯過最佳衛星）。如果發現例外情況，記錄並調整約束條件（例如只有在多候選都可覆蓋時才應用方向優先）。透過這些測試確保策略在各種場景下穩健。

8. **階段八：完整系統整合與效能測試 (Phase 8: Full Integration & Performance Testing)**

    - **功能與目標 (Function & Goals):** 將上述所有模組整合成完整的 NTN 換手加速系統，進行端到端測試與效能評估。包含視覺化展示與數據驗證兩部分：一方面透過前端 3D 互動介面展示系統工作流程，另一方面收集關鍵 KPI（換手時延、丟包率、吞吐量等）驗證論文提出方法的效能提升。最終產出可供開發者和研究者參考的復現報告與演示。
    - **後端需要完成的任務 (Back-end Tasks):**

        - 整體穩定性測試：長時間運行整個系統（例如模擬幾十次換手循環），觀察日誌及指標是否顯示正常。特別關注同步演算法是否一直準確、UPF 表 R 是否及時更新以及無資源泄漏。若發現如預測時間誤差累積、個別換手未按計畫執行等問題，調整相應模組參數（如 Δt 大小、預測頻率）並反覆測試直到穩定。
        - 數據蒐集與分析：在後端實現日誌和統計數據匯總，例如每次換手耗時、換手前後 ping 延遲最大值、丟包數量、以及系統平均 CPU 負載等。這些數據可寫入文件或通過 API 提供給前端。對比標準換手（階段二）與本方案的結果，整理出具體的性能提升倍數或百分比。
        - 特殊情境測試：模擬使用者移動或非理想情況下的行為，以測試系統健壯性。例如令 UE 在換手預計時間點突然移動位置，導致原先預測的目標衛星不再最佳，觀察系統是否能透過 UERANSIM 上報的位置變化及時修正（即出現論文所述的“非預期換手”，系統應能自行偵測並快速恢復）。另可模擬衛星軌道預報誤差（如在 Skyfield 計算結果上添加微小偏差），驗證 UPF 是否能處理由此產生的罕見預測失誤情境（例如發生 Tp 預測錯誤導致的短暫中斷）。

    - **前端需要完成的任務 (Front-end Tasks):**

        - 完善 3D 互動展示：實裝攝影機控制、UI 按鈕等，讓使用者可自由旋轉/縮放地球觀看衛星運行，並可點擊選擇特定 UE 或衛星以查看詳細資訊（例如彈出該對象的狀態面板）。確保整體視覺效果美觀且能清楚傳達系統行為，作為演示用途。
        - 報告與數據視覺化：在前端顯示後端匯總的性能數據，例如折線圖對比優化前後的平均換手時延、柱狀圖顯示每種策略下丟包率等。包括顯示「標準方案 vs 本方案」的指標比較，以及論文中的基準對照（如與 3GPP NTN 標準換手等策略比較的結果）。
        - 多語系與協作支持：由於是協作開發計畫，前端可集成說明面板，以中英文說明各階段功能與目前系統狀態，方便團隊成員溝通。同時提供日誌下載或截圖功能，便於研究人員保存結果。

    - **成果驗證 (Verification):**

        - **效能指標驗證：** 最終對照論文結果驗證本系統達成的指標。例如，統計若干次換手的平均時延，相較未優化方案降低的幅度是否接近論文所述 10 倍。比對 TCP 吞吐量或其他 user-level 性能，如果可能的話進行例如 FTP 下載測試，觀察在長時間頻繁換手下有無明顯改善。
        - **完整流程演示：** 從 UE 初始接入->多次衛星換手->最終穩定連線的整個流程在前端演示應流暢且符合預期。請團隊成員依照計畫書逐步操作，檢查每階段預期功能是否都正常運作。如果某一步出現問題，回溯檢查相應階段的實作，確保最終系統各部分協調工作。
        - **文檔與成果交付：** 整理每個階段的配置、代碼修改和使用說明，編寫最終報告（即可基於本計畫書增補測試數據與截圖）。確定他人按照此文檔能夠重現系統。前後端代碼註解完善，提交至版本控制平臺供協作開發。通過這些驗收，確保該階段性實作計畫全面完成，成功復現論文提出的衛星網路加速換手機制。
