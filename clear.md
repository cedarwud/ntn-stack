# NTN Stack 專案全面清理計劃

## 🔍 專案架構分析結果

根據徹底分析，NTN Stack 是一個 **3 層架構** 的複雜微服務系統：

```
NTN Stack (根目錄統一管理)
├── 1. NetStack (5G 核心網層)    - 15+ 容器，完整的 5G NTN 協議棧
├── 2. SimWorld Backend (仿真引擎層) - 物理層仿真、AI 決策、衛星軌道計算
└── 3. SimWorld Frontend (可視化層) - React 3D 可視化、用戶交互介面
```

### 開發階段現狀
- **總計 8 個開發階段**
- **實際完成**: 5 個階段 (62.5%)
- **實現領先文件**: Stage 4-6 已完成但文件標示為"待實現"
- **累積技術債務**: 大量假資料、重複代碼、過時測試

## 🗂️ 根目錄資料夾用途分析

### 📁 `/deployment/` - 生產部署系統
**用途**: Phase 3 Stage 7 生產環境部署自動化
**內容**:
- `blue_green_deployment.py` - 藍綠部署策略 (560+ 行)
- `canary_deployment.py` - 金絲雀部署 (400+ 行)
- `production_monitoring.py` - 生產監控系統
- `deploy_production.py` - 完整部署流程

**評估**: ❌ **完全刪除**
- **原因**: 當前 Docker 環境就是開發+生產環境
- **現況**: 不會部署到其他環境，完全沒有使用價值
- **行動**: 整個資料夾刪除，節省維護成本

### 📁 `/monitoring/` - 可觀測性系統  
**用途**: 統一監控指標規範和 Prometheus 配置
**內容**:
- Prometheus 指標規範和配置
- 監控工具 (metrics_simulator.py, metrics_validator.py)
- Grafana 儀表板模板

**評估**: ✅ **保留但重新組織位置**
- **實際狀況**: Prometheus 正在運行，有豐富的 5G 監控數據
- **問題**: 放在根目錄位置不當
- **行動**: 移動到 `netstack/monitoring/` (因為主要監控 NetStack)

### 📁 `/scripts/` - 專案管理腳本
**用途**: 測試和專案維護工具
**內容**:
- `validate_all_stages.py` - 階段驗證測試工具
- `reorganize_tests.py` - 測試重組工具  
- `cleanup_project.sh` - 專案清理工具
- 其他建置和檢查腳本

**評估**: 🔄 **移至測試目錄**
- **性質**: 主要是測試和開發工具
- **建議位置**: `tests/tools/` 
- **行動**: 整個資料夾移動到測試系統中

## 🎯 全面清理計劃 (5 階段)

### 階段 1: 根目錄清理 🧹 ✅ **已完成**
- [x] **刪除** `/deployment/` 完整目錄 (無使用價值)
- [x] **重新組織** `/monitoring/` → `netstack/monitoring/` (監控功能保留)  
- [x] **移動** `/scripts/` → `tests/tools/` (測試工具正確歸位)
- [x] **清理** 根目錄結構，使其更清晰

**清理結果**:
- 刪除了約 1.5MB 的無用部署代碼
- 監控系統移到正確位置 (`netstack/monitoring/`)
- 開發工具集中在測試目錄 (`tests/tools/`)

### 階段 2: NetStack 清理 🌐
- [ ] **檢查** 重複的 API 端點
- [ ] **清理** 無用的服務和適配器
- [ ] **優化** Docker compose 配置
- [ ] **移除** 過時的測試腳本

### 階段 3: SimWorld Backend 清理 ⚙️  
- [ ] **刪除** 假資料生成邏輯
- [ ] **移除** 無用的 API 端點
- [ ] **清理** 重複的服務類
- [ ] **優化** 資料庫模型
- [ ] **整合** 相似功能的服務

### 階段 4: SimWorld Frontend 清理 🎨
- [ ] **移除** 假資料組件 (已部分完成)
- [ ] **刪除** 無用的狀態管理
- [ ] **清理** 過時的 UI 組件  
- [ ] **優化** 組件結構
- [ ] **移除** 無用的 CSS 和資源

### 階段 5: 測試系統整理 🧪
- [ ] **統一** 測試框架和結構
- [ ] **移除** 重複和過時的測試
- [ ] **優化** CI/CD 測試流程
- [ ] **修正** 測試覆蓋率問題

## 🚨 清理優先級

### ✅ **已完成** 
1. **根目錄清理**: deployment/ 刪除，monitoring/ 重新組織，scripts/ 移至 tests/

### 🔴 **高優先級** (接下來處理)
1. **SimWorld Frontend** 假資料組件和狀態 (已部分完成)
2. **重複的測試文件** 和過時測試邏輯
3. **無用的 API 端點** 和服務
4. **過時的文件** 和配置

### 🟡 **中優先級** (近期處理)  
1. **代碼重構** 和優化
2. **資料庫清理** 和優化
3. **文件更新** 和同步

### 🟢 **低優先級** (後續處理)
1. **性能優化** 和調校
2. **新功能整合**
3. **進階測試** 覆蓋
4. **文件補完**

## 📋 建議的清理順序

```bash
# 1. 開始清理
git checkout -b cleanup/comprehensive-refactor

# 2. 根目錄清理
make clean-project  # 使用現有清理腳本

# 3. 階段性清理
# Phase 1: 根目錄分析和清理
# Phase 2: Frontend 假資料清理  
# Phase 3: Backend API 清理
# Phase 4: NetStack 優化
# Phase 5: 測試系統整合

# 4. 驗證清理結果
make test
make status
```

## ⚠️ 清理前置作業

1. **完整備份** 當前專案狀態
2. **文件化** 每個刪除決定的原因
3. **測試驗證** 每個階段清理後的功能完整性
4. **團隊確認** 重要組件的保留或刪除決定

---

**預估清理效果**:
- 代碼量減少: ~30-40%
- 維護複雜度降低: ~50%  
- 測試執行時間減少: ~40%
- 新開發者上手時間減少: ~60%