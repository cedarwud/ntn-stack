# NTN Stack - 非地面網路智能仿真與監控系統

## 專案概述

NTN Stack 是一個基於現代微服務架構的非地面網路 (Non-Terrestrial Network) 智能仿真與監控系統。該系統整合了 5G 核心網路、無線環境模擬、AI 決策引擎和實時監控等核心功能，提供完整的網路規劃、優化和故障處理解決方案。

## 系統架構

### 核心服務模組

系統由兩個主要服務模組組成：

**NetStack - 5G 核心網路管理服務**
- 基於 Open5GS 和 UERANSIM 的 5G 核心網路模擬
- 事件驅動架構，支援毫秒級響應
- AI 決策引擎整合，提供智能網路優化
- 支援 UAV、衛星和 Mesh 網路管理

**SimWorld - 無線環境模擬服務**
- 基於 Sionna 的 3D 無線環境模擬
- 支援複雜地形場景 (Lotus、NTPU、NYCU、Nanliao)
- 領域驅動設計架構，CQRS 模式實現
- 即時信號分析和干擾可視化

### 部署架構

採用 Docker 容器化微服務部署，支援多環境配置：
- **Development**: 開發環境 (1 CPU, 1G 記憶體)
- **Laboratory**: 實驗室環境 (2 CPU, 2G 記憶體)
- **Production**: 生產環境 (4 CPU, 4G 記憶體, GPU 支援)

## 前端功能模組

### 場景管理
- **多場景支援**: Lotus 荷花池、NTPU 台北大學、NYCU 陽明交通大學、Nanliao 南寮場景
- **視圖模式**: 2D 平面圖模式、3D 立體圖模式
- **場景切換**: 即時場景載入和渲染

### 信號分析工具
- **SINR MAP**: 信號干擾噪聲比地圖可視化
- **Constellation & CFR**: 星座圖與通道頻率響應分析
- **Delay-Doppler**: 延遲-多普勒特性分析
- **Time-Frequency**: 時間-頻率域分析
- **頻譜分析**: 頻譜使用狀況和抗干擾效果評估

### 智能控制與分析
- **AI-RAN 決策系統**: AI-RAN 抗干擾決策過程可視化
- **干擾分析引擎**: 智能干擾模式分析與預測
- **ML 模型監控**: 機器學習模型訓練、評估和性能監控
- **自適應學習系統**: 機器學習模型的自適應學習和持續優化
- **智能推薦系統**: 智能化的最佳化建議和決策支援
- **預測性維護**: 設備故障預測、維護排程和系統健康度監控

### 網路管理
- **網狀網路拓撲**: 動態網狀網路拓撲結構可視化
- **衛星-UAV 連接**: 衛星與 UAV 連接狀態實時監控
- **故障轉移機制**: 智能網路故障轉移機制
- **即時性能指標**: 即時網路性能指標監控
- **端到端性能監控**: 完整的端到端系統性能監控儀表板
- **性能趨勢分析**: 長期性能趨勢分析與預測

### UAV 與衛星協調
- **UAV 群集協調**: 多 UAV 編隊飛行與群集協調
- **換手預測分析**: 智能衛星換手預測與時間軸分析
- **換手決策可視化**: 衛星換手決策過程 3D 可視化
- **換手性能監控**: 換手性能統計與分析儀表板
- **衛星數量控制**: 可設置顯示的衛星數量 (1-100)
- **最低仰角過濾**: 可設置最低仰角 (0-90 度)

### 可視化與監控
- **干擾源可視化**: 3D 干擾源範圍和影響可視化
- **SINR 熱力圖**: 地面 SINR 信號強度熱力圖
- **Sionna 3D 模擬**: Sionna 3D 無線環境模擬與可視化
- **測試結果可視化**: 測試套件狀態與結果的 3D 可視化
- **自動化報告生成**: 自動化系統報告生成與管理

### 設備管理
- **設備操作**: 新增 UAV、發射器、干擾源等設備
- **設備配置**: 位置、方向、功率等參數設置
- **設備選擇**: 多 UAV 接收器選擇與管理
- **設備分類**: 接收器、發射器、干擾源分類管理

## 後端服務架構

### NetStack 服務層

**AI 決策與優化服務**
- **AI 決策引擎**: 基於深度強化學習的智慧決策系統
- **AI-RAN 抗干擾服務**: 實時干擾檢測與智能避讓
- **自動化優化服務**: 網路性能自動優化
- **性能優化器**: 多維度性能指標優化

**網路管理服務**
- **UE 用戶設備管理**: 用戶設備註冊、認證和管理
- **網路切片管理**: 動態網路切片配置和管理
- **UERANSIM 配置服務**: RAN 模擬器配置管理
- **健康檢查服務**: 系統組件健康狀態監控

**衛星與 UAV 服務**
- **衛星基站映射**: OneWeb 衛星與地面基站動態映射
- **衛星切換服務**: 智能衛星切換預測與執行
- **UAV-UE 通信服務**: UAV 與用戶設備通信管理
- **UAV 編隊管理**: 多 UAV 編隊飛行協調
- **UAV 群體協調**: 大規模 UAV 群體智能協調
- **UAV Mesh 故障轉移**: UAV Mesh 網路故障轉移機制

**Mesh 網路服務**
- **Mesh 網路橋接**: Mesh 網路與 5G 核心網橋接
- **Mesh 網路優化**: 動態路由優化和 QoS 管理

**干擾控制服務**
- **干擾控制**: 干擾源檢測和控制
- **閉環干擾控制**: 自動化閉環干擾控制系統

**Sionna 整合服務**
- **Sionna 整合**: 無線通道模擬整合
- **Sionna 干擾整合**: 干擾場景模擬整合
- **Sionna-UERANSIM 整合**: 模擬器間數據交換

### SimWorld 服務層

**設備領域**
- 設備模型管理和生命週期控制
- 設備位置和參數動態配置
- 設備狀態監控和異常處理

**衛星領域**
- CQRS 架構實現的衛星服務
- 軌道計算和預測服務
- TLE 數據處理和更新

**坐標領域**
- 地理坐標系統管理
- 坐標轉換和計算服務

**模擬領域**
- Sionna 無線環境模擬
- 場景渲染和計算管理

**無線領域**
- 無線通道模型管理
- 通道參數轉換服務
- Sionna 通道服務整合

**干擾領域**
- AI-RAN 干擾控制服務
- 干擾場景模擬服務

## 監控和可觀測性

### 統一監控架構

**Prometheus 監控系統**
- 多層級指標抓取 (1s-60s 間隔)
- 統一指標命名空間規範
- 智能告警規則管理

**Grafana 視覺化**
- 系統總覽儀表板
- 實時性能監控儀表板
- AI 決策過程可視化儀表板

**指標標準化**
- 統一命名規範: `{domain}_{subsystem}_{metric_name}_{unit}`
- 標準標籤體系: 環境、節點、服務、版本等
- 多維度數據分析

### 核心監控指標

**連接指標**
- 連接狀態、註冊時間
- 連接成功率、失敗率

**性能指標**
- 往返時延 (RTT)、輸送量、封包遺失率
- API 響應時間、服務可用性

**無線指標**
- SINR、RSRP、通道品質指數
- 頻率使用率、調變效率

**資源指標**
- CPU 使用率、記憶體使用量
- 儲存空間、網路頻寬

## 部署與自動化

### 自動化部署系統

**配置管理**
- 多環境分層配置 (開發/測試/實驗室/生產)
- 模板化配置生成 (Jinja2)
- 動態資源限制調整

**部署自動化**
- 一鍵部署腳本
- 自動相依性檢查
- 健康檢查機制
- 失敗自動回滾

**備份與災難恢復**
- 完整備份、增量備份、差異備份
- 自動備份排程和清理
- 數據完整性校驗
- 快速災難恢復

### 建構與運行

**統一 Makefile 管理**
- 服務生命週期管理 (啟動/停止/重啟)
- 建構管理 (有/無快取建構)
- 清理管理 (資源/映像檔清理)
- 狀態檢查和網路驗證

**網路架構**
- NetStack 網路 (172.20.0.0/16)
- SimWorld 網路動態橋接
- 跨服務通信驗證
- 自動網路修復機制

## 測試框架

### 測試架構

**E2E 整合測試**
- 基本功能驗證測試
- 干擾避讓測試
- 衛星 Mesh 故障轉移測試
- UAV 衛星連接測試
- 實驗室測試套件
- 生產就緒測試

**整合測試**
- API 整合測試
- 服務間連接測試
- 故障轉移測試
- Sionna 整合測試
- 階段驗證測試

**性能測試**
- 負載測試
- 壓力測試
- 回歸測試
- 基準測試

**單元測試**
- 部署功能測試
- API 健康檢查測試
- 場景功能測試

### 測試工具

**測試自動化**
- 統一測試執行器
- 優先級測試配置
- 性能回歸測試器
- 測試環境自動化設置

**視覺化與報告**
- 測試結果視覺化引擎
- 進階報告生成器
- 覆蓋率分析器
- 測試儀表板服務器

## 技術特色

### 先進架構模式
- **事件驅動架構**: 低延遲事件處理 (<100ms)
- **CQRS 模式**: 讀寫分離優化
- **領域驅動設計**: 清晰的業務邏輯封裝
- **微服務架構**: 高可用性和擴展性

### AI 智能決策
- **深度強化學習**: DQN/DDPG 決策算法
- **實時干擾避讓**: 毫秒級響應能力
- **自適應優化**: 動態網路參數調整
- **預測性分析**: 故障預測和維護建議

### 無線技術整合
- **Sionna 3D 模擬**: 高精度無線環境建模
- **多場景支援**: 真實地形場景模擬
- **即時信號分析**: CFR、SINR、頻譜分析
- **干擾可視化**: 3D 干擾源影響範圍展示

### 高可用性設計
- **容錯機制**: 自動故障檢測和恢復
- **負載均衡**: 智能流量分配
- **備份策略**: 多層級備份保護
- **監控告警**: 實時系統健康監控

## 專案現況評估

### 已完成核心功能

**前端系統**: 完整的 Web 界面，包含場景管理、信號分析、AI 決策可視化、網路監控等 50+ 功能模組

**後端架構**: 28 個核心服務模組，涵蓋 AI 決策、網路管理、衛星通信、Mesh 網路、干擾控制等

**部署系統**: 完整的自動化部署、監控、備份和災難恢復機制

**測試框架**: 多層級測試體系，包含 E2E、整合、性能和單元測試

### 技術成熟度
- **架構設計**: 採用現代微服務最佳實踐
- **技術棧**: 成熟的開源技術整合
- **可擴展性**: 支援從開發到生產的完整部署
- **監控體系**: 企業級監控和可觀測性支援

### 系統完整性
- **功能覆蓋**: 完整的 NTN 網路生命週期管理
- **技術整合**: 5G、AI、無線模擬、衛星通信的深度整合
- **運維支援**: 完整的 DevOps 工具鏈
- **文檔體系**: 詳細的技術文檔和操作指南

這個 NTN Stack 系統展現了在非地面網路領域的技術深度和系統完整性，為後續的功能擴展和技術演進提供了堅實的基礎架構。