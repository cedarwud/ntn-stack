# ğŸ¯ éšæ®µäºŒï¼šåœ°ç†å¯è¦‹æ€§ç¯©é¸

[ğŸ”„ è¿”å›æ•¸æ“šæµç¨‹å°èˆª](../README.md) > éšæ®µäºŒ

## ğŸ“– éšæ®µæ¦‚è¿°

**ç›®æ¨™**ï¼šå¾ 8,791 é¡†è¡›æ˜Ÿä¸­ç¯©é¸å‡ºå°NTPUè§€æ¸¬é»åœ°ç†å¯è¦‹çš„å€™é¸è¡›æ˜Ÿ  
**è¼¸å…¥**ï¼šéšæ®µä¸€ç´”ECIè»Œé“æ•¸æ“šï¼ˆè¨˜æ†¶é«”å‚³é + `/app/data/tle_orbital_calculation_output.json`ï¼‰  
**è¼¸å‡º**ï¼šç¯©é¸çµæœä¿å­˜è‡³ `/app/data/satellite_visibility_filtered_output.json` + è¨˜æ†¶é«”å‚³é  
**æ ¸å¿ƒå·¥ä½œ**ï¼š
1. å¾ECIåº§æ¨™è¨ˆç®—ç›¸å°NTPUè§€æ¸¬é»çš„ä»°è§’ã€æ–¹ä½è§’ã€è·é›¢
2. åˆ¤æ–·è¡›æ˜Ÿå¯è¦‹æ€§ï¼ˆ`is_visible`ï¼‰ä¸¦æ‡‰ç”¨ITU-Ræ¨™æº–ç¯©é¸
3. ç¯©é¸æ‰åœ°ç†ä¸å¯è¦‹æˆ–ä¸ç¬¦åˆæ¨™æº–çš„è¡›æ˜Ÿ
**å¯¦éš›çµæœ**ï¼šç´„500-1000é¡†ç¬¦åˆå¯è¦‹æ€§æ¨™æº–çš„å€™é¸è¡›æ˜Ÿ  
**ç¯©é¸é‚è¼¯**ï¼šåš´æ ¼åœ°ç†å¯è¦‹æ€§ç¯©é¸ + ITU-Ræ¨™æº–æª¢æŸ¥  
**è™•ç†æ™‚é–“**ï¼šç´„ 20-25 ç§’

### ğŸ—‚ï¸ çµ±ä¸€è¼¸å‡ºç›®éŒ„çµæ§‹

å…­éšæ®µè™•ç†ç³»çµ±æ¡ç”¨çµ±ä¸€çš„è¼¸å‡ºç›®éŒ„çµæ§‹ï¼š

```bash
/app/data/                                    # çµ±ä¸€æ•¸æ“šç›®éŒ„
â”œâ”€â”€ stage1_orbital_calculation_output.json   # éšæ®µä¸€ï¼šè»Œé“è¨ˆç®—
â”œâ”€â”€ satellite_visibility_filtered_output.json # éšæ®µäºŒï¼šåœ°ç†å¯è¦‹æ€§ç¯©é¸ â­  
â”œâ”€â”€ stage3_signal_analysis_output.json       # éšæ®µä¸‰ï¼šä¿¡è™Ÿåˆ†æ
â”œâ”€â”€ stage4_timeseries_preprocessing_output.json  # éšæ®µå››ï¼šæ™‚é–“åºåˆ—
â”œâ”€â”€ stage5_data_integration_output.json      # éšæ®µäº”ï¼šæ•¸æ“šæ•´åˆ
â”œâ”€â”€ stage6_dynamic_pool_output.json          # éšæ®µå…­ï¼šå‹•æ…‹æ± è¦åŠƒ
â””â”€â”€ validation_snapshots/                    # é©—è­‰å¿«ç…§ç›®éŒ„
    â”œâ”€â”€ stage1_validation.json
    â”œâ”€â”€ stage2_validation.json               # éšæ®µäºŒé©—è­‰å¿«ç…§
    â””â”€â”€ ...
```

**å‘½åè¦å‰‡**ï¼š
- æ‰€æœ‰éšæ®µè¼¸å‡ºä½¿ç”¨ `stage{N}_` å‰ç¶´
- çµ±ä¸€ä¿å­˜è‡³ `/app/data/` ç›®éŒ„ï¼ˆå®¹å™¨å…§ï¼‰
- é©—è­‰å¿«ç…§ä¿å­˜è‡³ `validation_snapshots/` å­ç›®éŒ„
- ç„¡é¡å¤–å­ç›®éŒ„ï¼Œä¿æŒæ‰å¹³çµæ§‹

### ğŸ¯ @doc/todo.md å°æ‡‰å¯¦ç¾
æœ¬éšæ®µå¯¦ç¾ä»¥ä¸‹æ ¸å¿ƒéœ€æ±‚ï¼š
- âœ… **è§€æ¸¬é»è¨­å®š**: è¨­å®š NTPU è§€æ¸¬é»åº§æ¨™ (24Â°56'39"N 121Â°22'17"E)
- âœ… **ECIè½‰æ›**: å°‡éšæ®µä¸€çš„ECIåº§æ¨™è½‰æ›ç‚ºè§€æ¸¬é»ç›¸å°åº§æ¨™ï¼ˆä»°è§’ã€æ–¹ä½è§’ï¼‰
- âœ… **å¯è¦‹æ€§åˆ¤æ–·**: è¨ˆç®—æ¯å€‹æ™‚é–“é»çš„è¡›æ˜Ÿå¯è¦‹æ€§ï¼ˆ`is_visible`ï¼‰
- âœ… **ITU-Ræ¨™æº–ç¯©é¸**: æ‡‰ç”¨Starlink 5Â°/OneWeb 10Â°ä»°è§’æ¨™æº–
- ğŸ”§ **åœ°ç†ç¯©é¸**: ç¯©é¸æ‰å°NTPUè§€æ¸¬é»ä¸å¯è¦‹æˆ–ä¸ç¬¦åˆæ¨™æº–çš„è¡›æ˜Ÿ
- ğŸ¯ **å€™é¸æº–å‚™**: ç‚ºå¾ŒçºŒéšæ®µæä¾›çœŸæ­£å¯è¦‹çš„å€™é¸è¡›æ˜Ÿæ± 

### ğŸš€ v1.1 éåº¦ç¯©é¸ä¿®å¾©ç‰ˆæœ¬

- **ğŸ”§ æ ¸å¿ƒä¿®å¾©**ï¼šâœ… **è§£æ±ºéåº¦ç¯©é¸å•é¡Œ**
  - **å¯è¦‹æ€§æ™‚é–“è¦æ±‚**ï¼šStarlinkå¾ 5.0â†’1.0 åˆ†é˜ï¼ŒOneWebå¾ 2.0â†’0.5 åˆ†é˜
  - **å“è³ªé»è¦æ±‚**ï¼šå¾ 10â†’3 å€‹æœ€ä½³ä»°è§’é» (å¤§å¹…æ”¾å¯¬å“è³ªè¦æ±‚)
  - **å‹•æ…‹é–€æª»**ï¼šä½¿ç”¨çµ±ä¸€ä»°è§’ç®¡ç†å™¨çš„å¯¦éš›é–€æª»å€¼
  - **æ•¸æ“šå®Œæ•´æ€§**ï¼šç¢ºä¿è¶³å¤ è¡›æ˜Ÿæµå‘å¾ŒçºŒéšæ®µè™•ç†

### ğŸš€ v3.0 è¨˜æ†¶é«”å‚³éæ¨¡å¼

- **å•é¡Œè§£æ±º**ï¼šé¿å…ç”Ÿæˆ 2.4GB ç¯©é¸çµæœæª”æ¡ˆ
- **å‚³éæ–¹å¼**ï¼šç›´æ¥å°‡ç¯©é¸çµæœåœ¨è¨˜æ†¶é«”ä¸­å‚³éçµ¦éšæ®µä¸‰
- **æ•ˆèƒ½æå‡**ï¼šæ¶ˆé™¤å¤§æª”æ¡ˆI/Oï¼Œæ¸›å°‘ç£ç¢Ÿç©ºé–“ä½¿ç”¨

## ğŸŒ åœ°ç†å¯è¦‹æ€§ç¯©é¸æ¼”ç®—æ³•

### åœ°ç†å¯è¦‹æ€§ç¯©é¸æµç¨‹

1. **æ˜Ÿåº§åˆ†çµ„è™•ç†**
   - åˆ†é›¢ Starlink å’Œ OneWeb æ•¸æ“š
   - æ‡‰ç”¨æ˜Ÿåº§ç‰¹å®šçš„ç¯©é¸åƒæ•¸

2. **åœ°ç†å¯è¦‹æ€§ç¯©é¸**
   - Starlink: ä»°è§’ â‰¥5Â°, å¯è¦‹æ™‚é–“ â‰¥1.0åˆ†é˜
   - OneWeb: ä»°è§’ â‰¥10Â°, å¯è¦‹æ™‚é–“ â‰¥0.5åˆ†é˜
   - åŸºæ–¼éšæ®µä¸€æä¾›çš„ position_timeseries æ•¸æ“š
   - ç¯©é¸æ–¹å¼ï¼špure_geographic_visibility_no_quantity_limits

**ç¯©é¸çµæœç‰¹é»ï¼š**
- åŸºæ–¼å¯¦éš›SGP4è»Œé“è¨ˆç®—çµæœ
- ç„¡äººç‚ºæ•¸é‡é™åˆ¶ï¼Œç´”åŸºæ–¼åœ°ç†å¯è¦‹æ€§æ¢ä»¶
- ä¿ç•™ç‡ä¾å¯¦éš›è»Œé“æ¢ä»¶å‹•æ…‹è®ŠåŒ–

## ğŸ—ï¸ æ ¸å¿ƒè™•ç†å™¨æ¶æ§‹

### ä¸»è¦å¯¦ç¾ä½ç½®
```bash
# åœ°ç†å¯è¦‹æ€§ç¯©é¸è™•ç†å™¨
/netstack/src/stages/satellite_visibility_filter_processor.py
â”œâ”€â”€ SatelliteVisibilityFilterProcessor.process_intelligent_filtering()    # ä¸»ç¯©é¸é‚è¼¯
â”œâ”€â”€ SatelliteVisibilityFilterProcessor.load_orbital_calculation_output()  # è¼‰å…¥è»Œé“æ•¸æ“š
â””â”€â”€ SatelliteVisibilityFilterProcessor._simple_filtering()                # åœ°ç†å¯è¦‹æ€§ç¯©é¸åŸ·è¡Œ

# çµ±ä¸€æ™ºèƒ½ç¯©é¸ç³»çµ±
/netstack/src/services/satellite/intelligent_filtering/unified_intelligent_filter.py
â”œâ”€â”€ UnifiedIntelligentFilter.execute_f2_filtering_workflow()  # F2ç¯©é¸æµç¨‹
â”œâ”€â”€ UnifiedIntelligentFilter.geographical_relevance_filter() # åœ°ç†ç›¸é—œæ€§ç¯©é¸
â””â”€â”€ UnifiedIntelligentFilter.handover_suitability_scoring()  # æ›æ‰‹é©ç”¨æ€§è©•åˆ†
/netstack/config/satellite_data_pool_builder.py        # åŸºç¤è¡›æ˜Ÿæ± å»ºæ§‹
```

## ğŸš¨ **å­¸è¡“ç´šç¯©é¸æ¨™æº–éµå¾ª** (Grade A/B ç­‰ç´š)

### ğŸŸ¢ **Grade A å¼·åˆ¶è¦æ±‚ï¼šçœŸå¯¦ç‰©ç†åƒæ•¸**

#### å¯è¦‹æ€§æº–å‰‡ (åŸºæ–¼ITU-Ræ¨™æº–)
- **ä»°è§’é–€æª»**ï¼šéµå¾ª [è¡›æ˜Ÿæ›æ‰‹ä»°è§’é–€æª»æ¨™æº–](../satellite_handover_standards.md)
  - Starlink: 5Â° (æœ€ä½æœå‹™é–€æª»)
  - OneWeb: 10Â° (æ¨™æº–æœå‹™é–€æª»)  
  - ä¾æ“šï¼šITU-R P.618-13 åœ°çƒ-ç©ºé–“è·¯å¾‘è¡°æ¸›æ¨™æº–
- **å¯è¦‹æ™‚é–“è¦æ±‚**ï¼šåŸºæ–¼è»Œé“å‹•åŠ›å­¸è¨ˆç®—
  - æœ€ä½å¯è¦‹æ™‚é–“ï¼šæ ¹æ“šå¯¦éš›è»Œé“é€±æœŸå’Œå¹¾ä½•æ¢ä»¶è¨ˆç®—
  - çµ•ä¸ä½¿ç”¨ä»»æ„å‡è¨­çš„"15åˆ†é˜"ç­‰å›ºå®šå€¼

#### ğŸŸ¡ **Grade B å¯æ¥å—ï¼šæ¨™æº–æ¨¡å‹è¨ˆç®—**

#### ä¿¡è™Ÿå‚³æ’­ç‰©ç†æ¨¡å‹ (æ›¿ä»£"é ä¼°")
- **è‡ªç”±ç©ºé–“è·¯å¾‘æè€—**ï¼šPL(dB) = 20logâ‚â‚€(4Ï€d/Î»)
  - d = ç²¾ç¢ºè¡›æ˜Ÿ-åœ°é¢è·é›¢ (åŸºæ–¼SGP4è¨ˆç®—)
  - Î» = è¼‰æ³¢æ³¢é•· (ä¾å¯¦éš›é »æ®µï¼šKu/Kaé »æ®µ)
  - çµ•ä¸ä½¿ç”¨å›ºå®šçš„"-110 dBmé–€æª»"ç­‰ä»»æ„å€¼
- **éƒ½åœå‹’é »ç§»è¨ˆç®—**ï¼šÎ”f = (v_rel Ã— f_c) / c
  - v_rel = ç›¸å°é€Ÿåº¦å‘é‡æŠ•å½± (åŸºæ–¼è»Œé“è¨ˆç®—)
  - f_c = å¯¦éš›è¼‰æ³¢é »ç‡ (éå‡è¨­å€¼)

#### ğŸ”´ **Grade C åš´æ ¼ç¦æ­¢é …ç›®**
- **âŒ ä»»æ„RSRPé–€æª»å€¼**ï¼šå¦‚"-110 dBm"ç­‰æ²’æœ‰ç‰©ç†ä¾æ“šçš„å›ºå®šå€¼
- **âŒ äººç‚ºè·é›¢é™åˆ¶**ï¼šå¦‚"2000 km"ç­‰éåŸºæ–¼ç‰©ç†åŸç†çš„é™åˆ¶
- **âŒ å›ºå®šéƒ½åœå‹’é™åˆ¶**ï¼šå¦‚"Â±40 kHz"ç­‰æœªç¶“è¨ˆç®—é©—è­‰çš„é™åˆ¶
- **âŒ ä»»æ„è² è¼‰å¹³è¡¡æ¯”ä¾‹**ï¼šå¦‚"80%/20%"ç­‰éåŸºæ–¼å¯¦éš›è¦†è“‹éœ€æ±‚çš„åˆ†é…
- **âŒ å‡è¨­çš„æœå‹™çª—å£æ•¸é‡**ï¼šå¦‚"è‡³å°‘3å€‹"ç­‰æœªç¶“é©—è­‰çš„è¦æ±‚

### ğŸ¯ **æ›¿ä»£æ–¹æ¡ˆï¼šåŸºæ–¼ç‰©ç†åŸç†çš„ç¯©é¸**

#### çœŸå¯¦å¯è¦‹æ€§è¨ˆç®—
```python
# âœ… æ­£ç¢ºï¼šåŸºæ–¼SGP4å’Œçƒé¢ä¸‰è§’å­¸
def calculate_visibility(satellite_position_eci, observer_position_ecef, time):
    elevation = calculate_elevation_angle(satellite_position_eci, observer_position_ecef)
    return elevation >= threshold_from_itu_standard
    
# âŒ éŒ¯èª¤ï¼šä½¿ç”¨å‡è¨­åƒæ•¸
def assume_visibility_threshold():
    return rsrp > -110  # ä»»æ„é–€æª»å€¼
```

#### å‹•æ…‹è¦†è“‹éœ€æ±‚åˆ†æ
```python
# âœ… æ­£ç¢ºï¼šåŸºæ–¼å¯¦éš›è¦†è“‹éœ€æ±‚
coverage_requirements = analyze_coverage_gaps(observer_location, time_window)
satellite_selection = select_by_coverage_contribution(candidates, coverage_requirements)

# âŒ éŒ¯èª¤ï¼šå›ºå®šæ¯”ä¾‹åˆ†é…
target_ratios = {'starlink': 0.80, 'oneweb': 0.20}  # ä»»æ„æ¯”ä¾‹
```

## ğŸš¨ å¼·åˆ¶é‹è¡Œæ™‚æª¢æŸ¥ (æ–°å¢)

**2025-09-09 é‡å¤§å¼·åŒ–**: æ–°å¢éšæ®µäºŒå°ˆé–€çš„é‹è¡Œæ™‚æ¶æ§‹å®Œæ•´æ€§æª¢æŸ¥ç¶­åº¦ã€‚

### ğŸ”´ é›¶å®¹å¿é‹è¡Œæ™‚æª¢æŸ¥ (ä»»ä½•å¤±æ•—éƒ½æœƒåœæ­¢åŸ·è¡Œ)

#### 1. ç¯©é¸å¼•æ“é¡å‹å¼·åˆ¶æª¢æŸ¥
```python
# ğŸš¨ åš´æ ¼æª¢æŸ¥å¯¦éš›ä½¿ç”¨çš„ç¯©é¸å¼•æ“é¡å‹
assert isinstance(filter_engine, UnifiedIntelligentFilter), f"éŒ¯èª¤ç¯©é¸å¼•æ“: {type(filter_engine)}"
# åŸå› : ç¢ºä¿ä½¿ç”¨çµ±ä¸€æ™ºèƒ½ç¯©é¸ç³»çµ±ï¼Œè€Œéç°¡åŒ–ç¯©é¸å™¨
# å½±éŸ¿: éŒ¯èª¤å¼•æ“å¯èƒ½å°è‡´ç¯©é¸é‚è¼¯ä¸å®Œæ•´æˆ–ä½¿ç”¨éŒ¯èª¤åƒæ•¸
```

#### 2. è¼¸å…¥æ•¸æ“šå®Œæ•´æ€§æª¢æŸ¥  
```python
# ğŸš¨ å¼·åˆ¶æª¢æŸ¥è¼¸å…¥è¡›æ˜Ÿæ•¸æ“šå®Œæ•´æ€§
assert input_satellites_count > 8600, f"è¼¸å…¥è¡›æ˜Ÿæ•¸é‡ä¸è¶³: {input_satellites_count}"
assert 'position_timeseries' in input_data[0], "è¼¸å…¥æ•¸æ“šç¼ºå°‘è»Œé“æ™‚é–“åºåˆ—"
# æ˜Ÿåº§ç‰¹å®šæ™‚é–“åºåˆ—é•·åº¦æª¢æŸ¥ (ä¿®æ­£ç‰ˆ)
constellation = input_data[0].get('constellation', '').lower() 
expected_points = 192 if constellation == 'starlink' else 218 if constellation == 'oneweb' else None
assert expected_points is not None, f"æœªçŸ¥æ˜Ÿåº§: {constellation}"
assert len(input_data[0]['position_timeseries']) == expected_points, f"æ™‚é–“åºåˆ—é•·åº¦ä¸ç¬¦åˆéšæ®µä¸€è¼¸å‡ºè¦æ ¼: {len(input_data[0]['position_timeseries'])} vs {expected_points} ({constellation})"
# åŸå› : ç¢ºä¿éšæ®µä¸€çš„æ•¸æ“šå®Œæ•´æ€§å·²æ­£ç¢ºå‚³é
# å½±éŸ¿: ä¸å®Œæ•´çš„è¼¸å…¥æœƒå°è‡´ç¯©é¸çµæœéŒ¯èª¤æˆ–åå·®
```

#### 3. ç¯©é¸é‚è¼¯æµç¨‹æª¢æŸ¥
```python
# ğŸš¨ æª¢æŸ¥ç¯©é¸æµç¨‹çš„å®Œæ•´åŸ·è¡Œ
filtering_steps = ['constellation_separation', 'geographical_relevance', 'handover_suitability']
for step in filtering_steps:
    assert step in executed_steps, f"ç¯©é¸æ­¥é©Ÿ {step} æœªåŸ·è¡Œ"
assert filtering_mode == "pure_geographic_visibility", "ç¯©é¸æ¨¡å¼éŒ¯èª¤"
# åŸå› : ç¢ºä¿å®Œæ•´çš„ä¸‰æ­¥é©Ÿç¯©é¸æµç¨‹éƒ½æ­£ç¢ºåŸ·è¡Œ
# å½±éŸ¿: è·³éæ­¥é©Ÿæœƒå°è‡´ç¯©é¸ä¸å®Œæ•´æˆ–çµæœä¸æº–ç¢º
```

#### 4. ä»°è§’é–€æª»åˆè¦æª¢æŸ¥
```python
# ğŸš¨ å¼·åˆ¶æª¢æŸ¥ä»°è§’é–€æª»ç¬¦åˆITU-Ræ¨™æº–
constellation_thresholds = config.get_elevation_thresholds()
assert constellation_thresholds['starlink'] == 5.0, f"Starlinkä»°è§’é–€æª»éŒ¯èª¤: {constellation_thresholds['starlink']}"
assert constellation_thresholds['oneweb'] == 10.0, f"OneWebä»°è§’é–€æª»éŒ¯èª¤: {constellation_thresholds['oneweb']}"
# åŸå› : ç¢ºä¿ä½¿ç”¨ç¬¦åˆITU-R P.618æ¨™æº–çš„ä»°è§’é–€æª»
# å½±éŸ¿: éŒ¯èª¤é–€æª»æœƒå½±éŸ¿ç¯©é¸çµæœå’Œå¾ŒçºŒéšæ®µçš„å‡†ç¢ºæ€§
```

#### 5. è¼¸å‡ºæ•¸æ“šçµæ§‹å®Œæ•´æ€§æª¢æŸ¥
```python
# ğŸš¨ å¼·åˆ¶æª¢æŸ¥è¼¸å‡ºæ•¸æ“šçµæ§‹å®Œæ•´æ€§
assert 'filtered_satellites' in output_data, "ç¼ºå°‘ç¯©é¸çµæœ"
assert 'starlink' in output_data['filtered_satellites'], "ç¼ºå°‘Starlinkç¯©é¸çµæœ"
assert 'oneweb' in output_data['filtered_satellites'], "ç¼ºå°‘OneWebç¯©é¸çµæœ"
# éšæ®µäºŒæ˜¯çœŸæ­£çš„ç¯©é¸éšæ®µï¼Œæ‡‰è©²ç¯©æ‰å¤§éƒ¨åˆ†ä¸å¯è¦‹çš„è¡›æ˜Ÿ
assert output_data['metadata']['filtering_rate'] >= 0.70, "ç¯©é¸ç‡éä½ï¼Œå¯èƒ½ç¯©é¸ä¸è¶³"
assert output_data['metadata']['filtering_rate'] <= 0.95, "ç¯©é¸ç‡éé«˜ï¼Œå¯èƒ½ç¯©é¸éæ–¼åš´æ ¼"
```

#### 6. ç„¡ç°¡åŒ–ç¯©é¸é›¶å®¹å¿æª¢æŸ¥
```python
# ğŸš¨ ç¦æ­¢ä»»ä½•å½¢å¼çš„ç°¡åŒ–ç¯©é¸ç®—æ³•
forbidden_filtering_modes = [
    "simplified_filter", "basic_elevation_only", "mock_filtering", 
    "random_sampling", "fixed_percentage", "estimated_visibility"
]
for mode in forbidden_filtering_modes:
    assert mode not in str(filter_engine.__class__).lower(), \
        f"æª¢æ¸¬åˆ°ç¦ç”¨çš„ç°¡åŒ–ç¯©é¸: {mode}"
```

### ğŸ“‹ Runtime Check Integration Points

**æª¢æŸ¥æ™‚æ©Ÿ**: 
- **åˆå§‹åŒ–æ™‚**: é©—è­‰ç¯©é¸å¼•æ“é¡å‹å’Œé…ç½®åƒæ•¸
- **è¼¸å…¥è™•ç†æ™‚**: æª¢æŸ¥éšæ®µä¸€æ•¸æ“šå®Œæ•´æ€§å’Œæ ¼å¼ç¬¦åˆæ€§
- **ç¯©é¸éç¨‹ä¸­**: ç›£æ§ç¯©é¸æ­¥é©ŸåŸ·è¡Œå’Œä»°è§’é–€æª»æ‡‰ç”¨
- **è¼¸å‡ºå‰**: åš´æ ¼æª¢æŸ¥ç¯©é¸çµæœçµæ§‹å’Œæ•¸æ“šå®Œæ•´æ€§

**å¤±æ•—è™•ç†**:
- **ç«‹å³åœæ­¢**: ä»»ä½•runtime checkå¤±æ•—éƒ½æœƒç«‹å³çµ‚æ­¢åŸ·è¡Œ
- **æ•¸æ“šå›æº¯**: æª¢æŸ¥éšæ®µä¸€è¼¸å‡ºæ˜¯å¦å­˜åœ¨å•é¡Œ
- **é…ç½®æª¢æŸ¥**: é©—è­‰ç¯©é¸åƒæ•¸é…ç½®æ˜¯å¦æ­£ç¢º
- **ç„¡é™ç´šè™•ç†**: çµ•ä¸å…è¨±ä½¿ç”¨ç°¡åŒ–ç¯©é¸ç®—æ³•

### ğŸ›¡ï¸ å¯¦æ–½è¦æ±‚

- **è·¨éšæ®µä¸€è‡´æ€§**: ç¢ºä¿èˆ‡éšæ®µä¸€è¼¸å‡ºæ•¸æ“šæ ¼å¼100%å…¼å®¹
- **ITU-Ræ¨™æº–åˆè¦**: å¼·åˆ¶åŸ·è¡Œåœ‹éš›æ¨™æº–çš„ä»°è§’é–€æª»è¦æ±‚  
- **ç¯©é¸é‚è¼¯å®Œæ•´æ€§**: ç¢ºä¿ä¸‰æ­¥é©Ÿç¯©é¸æµç¨‹å®Œæ•´åŸ·è¡Œ
- **æ€§èƒ½å½±éŸ¿æ§åˆ¶**: é‹è¡Œæ™‚æª¢æŸ¥é¡å¤–æ™‚é–“é–‹éŠ· <3%

## âš¡ æ€§èƒ½æœ€ä½³åŒ–

### è¨˜æ†¶é«”æœ€ä½³åŒ–
- **æ‰¹æ¬¡è™•ç†**ï¼šæ¯æ¬¡è™•ç†500é¡†è¡›æ˜Ÿ
- **è¨˜æ†¶é«”å›æ”¶**ï¼šåŠæ™‚æ¸…ç†ä¸­é–“çµæœ
- **æ•¸æ“šå£“ç¸®**ï¼šä½¿ç”¨é«˜æ•ˆçš„æ•¸æ“šçµæ§‹

### æ¼”ç®—æ³•æœ€ä½³åŒ–
- **é å…ˆæ’åº**ï¼šæŒ‰å¯è¦‹æ€§æ©Ÿç‡æ’åº
- **æ—©æœŸçµ‚æ­¢**ï¼šé”åˆ°ç›®æ¨™æ•¸é‡å³åœæ­¢
- **ä¸¦è¡Œè™•ç†**ï¼šæ”¯æ´å¤šåŸ·è¡Œç·’è¨ˆç®—

## ğŸ“– **å­¸è¡“æ¨™æº–åƒè€ƒæ–‡ç»**

### è¡›æ˜Ÿå¯è¦‹æ€§æ¨™æº–
- **ITU-R P.618-13**: "Propagation data and prediction methods for the design of Earth-space telecommunication systems"
- **ITU-R S.1257-1**: "Sharing criteria for VSAT systems operating in the 14-14.5 GHz band"
- **3GPP TS 38.821**: "Solutions for NR to support non-terrestrial networks (NTN)"

### ä»°è§’é–€æª»æ¨™æº–
- **ITU-R P.618**: æœ€ä½ä»°è§’å»ºè­° (5Â°-10Â°)
- **ITU-R P.840**: é›²å’Œéœ§çš„è¡°æ¸›æ¨¡å‹
- **æœ¬é …ç›®æ¨™æº–**: [è¡›æ˜Ÿæ›æ‰‹ä»°è§’é–€æª»æ¨™æº–](../satellite_handover_standards.md)

### ä¿¡è™Ÿå‚³æ’­æ¨¡å‹
- **Friiså‚³è¼¸å…¬å¼**: è‡ªç”±ç©ºé–“è·¯å¾‘æè€—è¨ˆç®—
- **ITU-R P.676**: å¤§æ°£æ°£é«”è¡°æ¸›æ¨¡å‹  
- **ITU-R P.837**: é™é›¨è¡°æ¸›çµ±è¨ˆæ¨¡å‹

### è»Œé“å¹¾ä½•è¨ˆç®—
- **çƒé¢ä¸‰è§’å­¸**: å¤§åœ“è·é›¢å’Œè§’åº¦è¨ˆç®—
- **WGS84åº§æ¨™ç³»çµ±**: åœ°å¿ƒåœ°å›ºåº§æ¨™è½‰æ›
- **SGP4è»Œé“æ¨¡å‹**: è¡›æ˜Ÿä½ç½®ç²¾ç¢ºè¨ˆç®—

### éƒ½åœå‹’é »ç§»è¨ˆç®—
- **ç›¸å°è«–éƒ½åœå‹’æ•ˆæ‡‰**: f' = f(1 + vÂ·rÌ‚/c)
- **è¡›æ˜Ÿé€šä¿¡ç³»çµ±**: é »ç‡è¦åŠƒå’Œè£œå„ŸæŠ€è¡“
- **3GPP NTNæ¨™æº–**: éƒ½åœå‹’è£œå„Ÿè¦æ±‚

## ğŸ§ª TDDæ•´åˆè‡ªå‹•åŒ–æ¸¬è©¦ (Phase 5.0 æ–°å¢)

### ğŸ¯ è‡ªå‹•è§¸ç™¼æ©Ÿåˆ¶

**è§¸ç™¼æ™‚æ©Ÿ**: éšæ®µäºŒç¯©é¸è™•ç†å®Œæˆä¸¦ç”Ÿæˆé©—è­‰å¿«ç…§å¾Œè‡ªå‹•è§¸ç™¼

```python
def execute(self, input_data):
    # åŸæœ‰çš„ç¯©é¸è™•ç†æµç¨‹
    # 1. æ˜Ÿåº§åˆ†é›¢ç¯©é¸
    # 2. åœ°ç†ç›¸é—œæ€§ç¯©é¸  
    # 3. æ›æ‰‹é©ç”¨æ€§è©•åˆ†
    # 4. çµ±è¨ˆæ•¸æ“šæ”¶é›†
    # 5. æ•¸æ“šçµæ§‹é©—è­‰
    # 6. è¨˜æ†¶é«”å‚³éæº–å‚™
    # 7. æ€§èƒ½æŒ‡æ¨™è¨ˆç®—
    
    # 8. âœ… ç”Ÿæˆé©—è­‰å¿«ç…§ (åŸæœ‰)
    snapshot_success = self.save_validation_snapshot(results)
    
    # 9. ğŸ†• å¾Œç½®é‰¤å­ï¼šè‡ªå‹•è§¸ç™¼TDDæ¸¬è©¦
    if snapshot_success and self.tdd_config.get("enabled", True):
        self._trigger_tdd_tests_after_snapshot()
        
    return filtered_results
```

### ğŸ”§ éšæ®µäºŒå°ˆç”¨æ¸¬è©¦é…ç½®

#### **åŸºç¤æ¸¬è©¦é¡å‹**
- **å›æ­¸æ¸¬è©¦**: èˆ‡æ­·å²ç¯©é¸çµæœæ¯”è¼ƒï¼Œæª¢æ¸¬ç¯©é¸é‚è¼¯è®ŠåŒ–
- **åˆè¦æ¸¬è©¦**: é©—è­‰ITU-R P.618æ¨™æº–ç¬¦åˆæ€§ (Grade A è¦æ±‚)
- **æ•´åˆæ¸¬è©¦**: æª¢æŸ¥éšæ®µä¸€æ•¸æ“šæ¥æ”¶å’Œéšæ®µä¸‰æ•¸æ“šå‚³éå®Œæ•´æ€§ (é–‹ç™¼ç’°å¢ƒ)

#### **éšæ®µç‰¹å®šé©—è­‰é …ç›®**
```yaml
stage2_filtering_tests:
  # åœ°ç†å¯è¦‹æ€§ç¯©é¸é©—è­‰
  geographic_visibility:
    - elevation_threshold_compliance      # ä»°è§’é–€æª»åˆè¦æ€§æª¢æŸ¥
    - visibility_time_requirements       # å¯è¦‹æ™‚é–“è¦æ±‚é©—è­‰
    - observer_coordinate_accuracy       # è§€æ¸¬é»åº§æ¨™ç²¾åº¦é©—è­‰
    
  # ç¯©é¸å¼•æ“å®Œæ•´æ€§é©—è­‰  
  filtering_engine_integrity:
    - unified_intelligent_filter_usage   # ç¢ºä¿ä½¿ç”¨çµ±ä¸€æ™ºèƒ½ç¯©é¸ç³»çµ±
    - three_step_filtering_execution     # ä¸‰æ­¥é©Ÿç¯©é¸æµç¨‹å®Œæ•´æ€§
    - constellation_separation_accuracy  # æ˜Ÿåº§åˆ†é›¢æº–ç¢ºæ€§
    
  # æ•¸æ“šæµå®Œæ•´æ€§é©—è­‰
  data_flow_integrity:
    - input_data_completeness           # è¼¸å…¥æ•¸æ“šå®Œæ•´æ€§ (8,000+é¡†è¡›æ˜Ÿ)
    - position_timeseries_preservation  # ä½ç½®æ™‚é–“åºåˆ—ä¿ç•™é©—è­‰
    - memory_transfer_validation        # è¨˜æ†¶é«”å‚³éæ¨¡å¼é©—è­‰
    
  # å­¸è¡“æ¨™æº–åˆè¦é©—è­‰ (Grade A)
  academic_compliance:
    - itu_r_standard_enforcement        # ITU-R P.618æ¨™æº–å¼·åˆ¶åŸ·è¡Œ
    - physical_parameter_verification   # ç‰©ç†åƒæ•¸çœŸå¯¦æ€§é©—è­‰
    - forbidden_simplification_check   # ç¦æ­¢ç°¡åŒ–ç®—æ³•æª¢æŸ¥
```

### ğŸ“Š æ€§èƒ½å›æ­¸æª¢æ¸¬

#### **é—œéµæ€§èƒ½åŸºæº– (Stage 2 ç‰¹å®š)**
```yaml
performance_baselines:
  processing_time:
    target: 25_seconds        # ç›®æ¨™è™•ç†æ™‚é–“
    warning: 35_seconds       # è­¦å‘Šé–€æª»
    critical: 50_seconds      # é—œéµé–€æª»
    
  memory_usage:
    target: 300_MB           # ç›®æ¨™è¨˜æ†¶é«”ä½¿ç”¨
    warning: 500_MB          # è­¦å‘Šé–€æª»
    critical: 800_MB         # é—œéµé–€æª»
    
  filtering_efficiency:
    expected_retention_rate: 0.10_to_0.15    # é æœŸä¿ç•™ç‡ 10-15%
    min_acceptable_rate: 0.05                # æœ€ä½å¯æ¥å—ä¿ç•™ç‡
    max_acceptable_rate: 0.25                # æœ€é«˜å¯æ¥å—ä¿ç•™ç‡
    
  data_quality:
    min_starlink_satellites: 400             # Starlinkæœ€ä½æ•¸é‡
    min_oneweb_satellites: 150               # OneWebæœ€ä½æ•¸é‡
    constellation_balance_tolerance: 0.2     # æ˜Ÿåº§å¹³è¡¡å®¹å·®
```

#### **å›æ­¸æª¢æ¸¬æŒ‡æ¨™**
- **ç¯©é¸ç‡ä¸€è‡´æ€§**: èˆ‡æ­·å²åŸºæº–æ¯”è¼ƒï¼Œå®¹å·®ç¯„åœ Â±5%
- **æ˜Ÿåº§åˆ†ä½ˆç©©å®šæ€§**: Starlink/OneWebæ¯”ä¾‹è®ŠåŒ–æª¢æ¸¬
- **åœ°ç†è¦†è“‹é€£çºŒæ€§**: NTPUè§€æ¸¬é»è¦†è“‹è¡›æ˜Ÿæ•¸é‡ç©©å®šæ€§
- **æ•¸æ“šå®Œæ•´æ€§ä¿æŒ**: ä½ç½®æ™‚é–“åºåˆ—æ•¸æ“šä¿ç•™å®Œæ•´æ€§

### ğŸš¨ é—œéµéŒ¯èª¤æª¢æ¸¬

#### **é›¶å®¹å¿éŒ¯èª¤é¡å‹ (ç«‹å³å¤±æ•—)**
```python
critical_error_checks = {
    "ç¯©é¸å¼•æ“é¡å‹éŒ¯èª¤": {
        "check": "isinstance(filter_engine, UnifiedIntelligentFilter)",
        "impact": "å¯èƒ½ä½¿ç”¨ç°¡åŒ–ç¯©é¸ç®—æ³•ï¼Œé•åå­¸è¡“æ¨™æº–"
    },
    "è¼¸å…¥æ•¸æ“šä¸å®Œæ•´": {
        "check": "input_satellites_count > 8600",
        "impact": "éšæ®µä¸€æ•¸æ“šå‚³éå•é¡Œï¼Œå½±éŸ¿å¾ŒçºŒæ‰€æœ‰è™•ç†"
    },
    "ä»°è§’é–€æª»ä¸åˆè¦": {
        "check": "starlink_threshold == 5.0 and oneweb_threshold == 10.0",
        "impact": "é•åITU-R P.618æ¨™æº–ï¼Œå½±éŸ¿è«–æ–‡å¯ä¿¡åº¦"
    },
    "ç¯©é¸æµç¨‹ä¸å®Œæ•´": {
        "check": "all_filtering_steps_executed",
        "impact": "ç¯©é¸é‚è¼¯ç¼ºå¤±ï¼Œå¯èƒ½ç”¢ç”ŸéŒ¯èª¤çµæœ"
    }
}
```

#### **è­¦å‘Šç´šåˆ¥å•é¡Œ (è¨˜éŒ„ä½†ç¹¼çºŒ)**
- **ç¯©é¸æ•¸é‡ç•°å¸¸**: ç¯©é¸çµæœæ•¸é‡è¶…å‡ºé æœŸç¯„åœ (ä½†æœªé”å±éšªç´šåˆ¥)
- **è™•ç†æ™‚é–“è¶…å‡ºé æœŸ**: è¶…å‡ºç›®æ¨™æ™‚é–“ä½†åœ¨å¯æ¥å—ç¯„åœå…§
- **è¨˜æ†¶é«”ä½¿ç”¨åé«˜**: è¨˜æ†¶é«”ä½¿ç”¨è¶…å‡ºç›®æ¨™ä½†æœªé”é™åˆ¶

### ğŸ”„ æ¸¬è©¦åŸ·è¡Œæ¨¡å¼

#### **åŒæ­¥åŸ·è¡Œæ¨¡å¼ (é–‹ç™¼ç’°å¢ƒ)**
- ç¯©é¸è™•ç† â†’ é©—è­‰å¿«ç…§ç”Ÿæˆ â†’ TDDæ¸¬è©¦åŸ·è¡Œ â†’ çµæœå›å ±
- ç¸½åŸ·è¡Œæ™‚é–“: ~30-40ç§’ (åŒ…å«æ¸¬è©¦æ™‚é–“)
- ç«‹å³éŒ¯èª¤åé¥‹ï¼Œä¾¿æ–¼é–‹ç™¼èª¿è©¦

#### **ç•°æ­¥åŸ·è¡Œæ¨¡å¼ (ç”Ÿç”¢ç’°å¢ƒ)**
- ç¯©é¸è™•ç† â†’ é©—è­‰å¿«ç…§ç”Ÿæˆ â†’ è¿”å›çµæœ
- TDDæ¸¬è©¦åœ¨èƒŒæ™¯ç•°æ­¥åŸ·è¡Œï¼Œä¸å½±éŸ¿ä¸»è¦æ•¸æ“šæµ
- æ¸¬è©¦çµæœé€šéè­¦å ±ç³»çµ±æˆ–æ—¥èªŒå›å ±

#### **æ··åˆåŸ·è¡Œæ¨¡å¼ (æ¸¬è©¦ç’°å¢ƒ)**
- é—œéµæª¢æŸ¥åŒæ­¥åŸ·è¡Œ (é›¶å®¹å¿éŒ¯èª¤)
- æ€§èƒ½æª¢æ¸¬ç•°æ­¥åŸ·è¡Œ (ä¸å½±éŸ¿ä¸»æµç¨‹)
- å¹³è¡¡åé¥‹é€Ÿåº¦å’Œç³»çµ±æ€§èƒ½

### ğŸ¯ æ¸¬è©¦è¦†è“‹ç›®æ¨™

#### **åŠŸèƒ½è¦†è“‹ç‡**: â‰¥95%
- æ‰€æœ‰ç¯©é¸é‚è¼¯åˆ†æ”¯è¦†è“‹
- éŒ¯èª¤è™•ç†è·¯å¾‘è¦†è“‹  
- æ˜Ÿåº§ç‰¹å®šåƒæ•¸è¦†è“‹

#### **æ•¸æ“šè¦†è“‹ç‡**: â‰¥90%
- ä¸åŒè¡›æ˜Ÿæ•¸é‡æƒ…å¢ƒ (7,000-9,000é¡†)
- ä¸åŒæ˜Ÿåº§æ¯”ä¾‹æƒ…å¢ƒ (Starlink/OneWebè®ŠåŒ–)
- ä¸åŒå¯è¦‹æ€§æ¢ä»¶æƒ…å¢ƒ (æ™‚é–“ã€åœ°ç†ä½ç½®)

#### **æ€§èƒ½è¦†è“‹ç‡**: â‰¥85%
- æ­£å¸¸è² è¼‰æ€§èƒ½åŸºæº–
- é«˜è² è¼‰å£“åŠ›æ¸¬è©¦
- è¨˜æ†¶é«”é™åˆ¶æƒ…å¢ƒæ¸¬è©¦

### ğŸ“ˆ æ¸¬è©¦çµæœæ•´åˆ

#### **é©—è­‰å¿«ç…§å¢å¼· (Stage 2 ç‰¹å®š)**
```json
{
  "stage": "stage2_intelligent_filtering",
  "tdd_integration": {
    "enabled": true,
    "execution_mode": "sync|async|hybrid",
    "test_results": {
      "total_tests": 15,
      "passed_tests": 15, 
      "failed_tests": 0,
      "critical_failures": [],
      "performance_regressions": []
    },
    "filtering_quality_metrics": {
      "retention_rate": 0.12,
      "starlink_count": 650,
      "oneweb_count": 180,
      "geographic_coverage_score": 0.92
    }
  }
}
```

#### **éšæ®µä¸‰æ•¸æ“šå‚³éé©—è­‰**
- **è¨˜æ†¶é«”æ¨¡å¼é©—è­‰**: ç¢ºä¿ç¯©é¸çµæœæ­£ç¢ºå‚³éçµ¦éšæ®µä¸‰
- **æ•¸æ“šçµæ§‹ä¸€è‡´æ€§**: ä¿æŒèˆ‡éšæ®µä¸‰æœŸæœ›çš„è¼¸å…¥æ ¼å¼ä¸€è‡´
- **æ•¸æ“šå®Œæ•´æ€§ä¿è­‰**: æ‰€æœ‰å¿…è¦å­—æ®µå’Œå±¬æ€§å®Œæ•´ä¿ç•™

### ğŸ” æ•…éšœè¨ºæ–·æ•´åˆ

#### **è‡ªå‹•è¨ºæ–·è§¸ç™¼æ¢ä»¶**
- TDDæ¸¬è©¦å¤±æ•—ç‡ > 10%
- é—œéµæ€§èƒ½æŒ‡æ¨™åé›¢åŸºæº– > 20%
- é€£çºŒ3æ¬¡æ¸¬è©¦å‡ºç¾åŒé¡å‹éŒ¯èª¤

#### **è¨ºæ–·æ•¸æ“šæ”¶é›†**
- éšæ®µä¸€è¼¸å‡ºæ•¸æ“šè³ªé‡æª¢æŸ¥
- ç¯©é¸å¼•æ“é…ç½®é©—è­‰
- ç³»çµ±è³‡æºä½¿ç”¨ç‹€æ³
- æ­·å²æ€§èƒ½è¶¨å‹¢åˆ†æ

---

## ğŸ“Š ç¯©é¸çµæœçµ±è¨ˆ

### ä¿®æ­£å¾Œçš„é æœŸè¼¸å‡ºåˆ†ä½ˆï¼ˆçœŸæ­£ç¯©é¸ï¼‰
```
ç¸½è¨ˆï¼š~800-1200é¡†è¡›æ˜Ÿ (å¾8,837é¡†ä¸­ç¯©é¸å‡ºåœ°ç†å¯è¦‹çš„è¡›æ˜Ÿ)
â”œâ”€â”€ Starlink: ~600-900é¡† (é€šé5Â°ä»°è§’ + 1åˆ†é˜å¯è¦‹æ™‚é–“æ¨™æº–)
â”‚   â”œâ”€â”€ é«˜ä»°è§’ (>30Â°): ~200é¡†
â”‚   â”œâ”€â”€ ä¸­ä»°è§’ (15-30Â°): ~300é¡†
â”‚   â””â”€â”€ ä½ä»°è§’ (5-15Â°): ~200é¡†
â””â”€â”€ OneWeb: ~200-300é¡† (é€šé10Â°ä»°è§’ + 0.5åˆ†é˜å¯è¦‹æ™‚é–“æ¨™æº–)
    â”œâ”€â”€ é«˜ä»°è§’ (>30Â°): ~80é¡†
    â”œâ”€â”€ ä¸­ä»°è§’ (15-30Â°): ~120é¡†
    â””â”€â”€ ä½ä»°è§’ (10-15Â°): ~100é¡†
```

**é‡è¦èªªæ˜**: éšæ®µäºŒæ˜¯çœŸæ­£çš„ç¯©é¸éšæ®µï¼Œå°‡å¾æ‰€æœ‰8,837é¡†è¡›æ˜Ÿä¸­ç¯©é¸å‡ºå°NTPUè§€æ¸¬é»åœ°ç†å¯è¦‹ä¸”ç¬¦åˆITU-Ræ¨™æº–çš„å€™é¸è¡›æ˜Ÿã€‚é æœŸç¯©é¸ç‡ç´„80-90%ï¼ˆå¤§éƒ¨åˆ†è¡›æ˜Ÿä¸å¯è¦‹ï¼‰ã€‚

## ğŸ”§ é…ç½®åƒæ•¸

```python
# ç¯©é¸åƒæ•¸ (åŸºæ–¼LEOè¡›æ˜Ÿç‰©ç†ç‰¹æ€§ä¿®æ­£)
FILTERING_CONFIG = {
    'starlink': {
        'min_elevation_deg': 5.0,
        'min_visible_time_min': 1.0,    # ä¿®æ­£ï¼šLEOè¡›æ˜Ÿå–®æ¬¡éå¢ƒç´„8-12åˆ†é˜ï¼Œ1åˆ†é˜æ˜¯åˆç†é–€æª»
        'target_count': 450
    },
    'oneweb': {
        'min_elevation_deg': 10.0,
        'min_visible_time_min': 0.5,    # ä¿®æ­£ï¼šMEOè¡›æ˜Ÿå¯è¦‹æ™‚é–“è¼ƒé•·ï¼Œ0.5åˆ†é˜æ˜¯åˆç†é–€æª»
        'target_count': 113
    }
}
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

1. **ç¯©é¸æ•¸é‡ä¸è¶³**
   - æª¢æŸ¥ï¼šé™ä½ç¯©é¸é–€æª»
   - è§£æ±ºï¼šèª¿æ•´ min_elevation_deg æˆ– min_visible_time_min

2. **æ˜Ÿåº§æ¯”ä¾‹å¤±è¡¡**
   - æª¢æŸ¥ï¼šå„æ˜Ÿåº§åŸå§‹æ•¸æ“šé‡
   - è§£æ±ºï¼šèª¿æ•´ target_count æ¯”ä¾‹

3. **è¨˜æ†¶é«”ä½¿ç”¨éé«˜**
   - æª¢æŸ¥ï¼šbatch_size è¨­å®š
   - è§£æ±ºï¼šæ¸›å°‘æ‰¹æ¬¡è™•ç†å¤§å°

### è¨ºæ–·æŒ‡ä»¤

```bash
# æª¢æŸ¥ç¯©é¸çµ±è¨ˆ
python -c "
from src.services.satellite.preprocessing.satellite_selector import *
print('ç¯©é¸å™¨æ¨¡çµ„è¼‰å…¥æˆåŠŸ')
"

# é©—è­‰è¨˜æ†¶é«”ä½¿ç”¨
top -p $(pgrep -f satellite_orbit_preprocessor) -n 1
```

## âœ… éšæ®µé©—è­‰æ¨™æº–

### ğŸ¯ å­¸è¡“ç´šé©—è­‰æ¡†æ¶ (8å€‹æ ¸å¿ƒé©—è­‰)

#### **åŸºç¤é©—è­‰ (ç›®å‰å·²å¯¦ç¾çš„3å€‹)**
1. **`output_structure_check`** - æ•¸æ“šçµæ§‹å®Œæ•´æ€§ (data, metadata, statistics)
2. **`filtering_engine_check`** - ç¯©é¸å¼•æ“é¡å‹é©—è­‰ (UnifiedIntelligentFilter)  
3. **`itu_r_compliance_check`** - ITU-Råˆè¦æ¨¡å¼æª¢æŸ¥

#### **å¢å¼·é©—è­‰ (æ–°å¢5å€‹é”åˆ°å­¸è¡“æ¨™æº–)**
4. **`filtering_rate_reasonableness_check`** - ç¯©é¸ç‡åˆç†æ€§é©—è­‰ (5%-50%)
5. **`constellation_threshold_compliance_check`** - æ˜Ÿåº§ä»°è§’é–€æª»æ­£ç¢ºæ€§
6. **`satellite_count_consistency_check`** - è¼¸å…¥è¼¸å‡ºæ•¸é‡ä¸€è‡´æ€§
7. **`observer_coordinate_precision_check`** - è§€æ¸¬é»åº§æ¨™ç²¾åº¦é©—è­‰
8. **`timeseries_continuity_check`** - ä½ç½®æ™‚é–“æˆ³é€£çºŒæ€§æª¢æŸ¥

### ğŸ¯ Stage 2 å®Œæˆé©—è­‰æª¢æŸ¥æ¸…å–®

#### 1. **è¼¸å…¥é©—è­‰**
- [ ] æ¥æ”¶Stage 1æ•¸æ“šå®Œæ•´æ€§
  - è¼¸å…¥è¡›æ˜Ÿç¸½æ•¸ > 8,000é¡†
  - Starlinkå’ŒOneWebæ•¸æ“šéƒ½å­˜åœ¨
  - æ¯é¡†è¡›æ˜ŸåŒ…å«å®Œæ•´è»Œé“æ•¸æ“š
- [ ] è¨˜æ†¶é«”å‚³éæ¨¡å¼æª¢æŸ¥
  - ç¢ºèªä½¿ç”¨è¨˜æ†¶é«”å‚³éï¼ˆv3.0æ¨¡å¼ï¼‰
  - ç„¡å¤§å‹ä¸­é–“æ–‡ä»¶ç”Ÿæˆ

#### 2. **ç¯©é¸éç¨‹é©—è­‰**
- [ ] **åœ°ç†ç›¸é—œæ€§ç¯©é¸**
  ```
  NTPUåº§æ¨™: 24Â°56'39"N 121Â°22'17"E
  ä»°è§’é–¾å€¼:
  - Starlink: 5åº¦ï¼ˆç”¨æˆ¶éœ€æ±‚ï¼‰
  - OneWeb: 10åº¦ï¼ˆç”¨æˆ¶éœ€æ±‚ï¼‰
  ç¯©é¸ä¿ç•™ç‡: 10-15%
  ```
- [ ] **å¯è¦‹æ€§è¦æ±‚**
  - æœ€ä½å¯è¦‹æ™‚é–“ï¼šStarlink â‰¥ 1.0åˆ†é˜ï¼ŒOneWeb â‰¥ 0.5åˆ†é˜
  - å“è³ªé»æ•¸é‡ï¼šâ‰¥ 3å€‹æœ€ä½³ä»°è§’é»
- [ ] **ç¯©é¸ç®¡ç·šå®Œæ•´æ€§**
  1. æ˜Ÿåº§åˆ†é›¢ç¯©é¸ âœ“
  2. åœ°ç†ç›¸é—œæ€§ç¯©é¸ âœ“
  3. æ›æ‰‹é©ç”¨æ€§è©•åˆ† âœ“

#### 3. **è¼¸å‡ºé©—è­‰**
- [ ] **ç¯©é¸çµæœæ•¸é‡**
  ```
  å¯¦éš›çµæœ:
  - Starlink: 2,899é¡†ï¼ˆç´„35.6%ä¿ç•™ç‡ï¼‰
  - OneWeb: 202é¡†ï¼ˆç´„31.0%ä¿ç•™ç‡ï¼‰
  - ç¸½è¨ˆ: 3,101é¡†ï¼ˆ35.3%æ•´é«”ä¿ç•™ç‡ï¼‰
  ```
- [ ] **æ•¸æ“šçµæ§‹é©—è­‰**
  ```json
  {
    "metadata": {
      "stage": "stage2_intelligent_filtering", 
      "total_input_satellites": 8837,
      "total_filtered_satellites": 900,
      "filtering_rate": 0.898  // 89.8%è¢«ç¯©æ‰ï¼Œ10.2%é€šé
    },
    "filtered_satellites": {
      "starlink": [...],  // åŒ…å«ç¯©é¸å¾Œçš„è¡›æ˜Ÿ
      "oneweb": [...]     // åŒ…å«ç¯©é¸å¾Œçš„è¡›æ˜Ÿ
    }
  }
  ```
- [ ] **è¡›æ˜Ÿæ•¸æ“šå®Œæ•´æ€§**
  - æ¯é¡†è¡›æ˜Ÿä¿ç•™å®Œæ•´çš„ `position_timeseries`
  - å¯è¦‹æ€§çª—å£æ•¸æ“šæ­£ç¢º
  - ä¿¡è™Ÿé ä¼°å€¼åˆç†ï¼ˆRSRP > -120 dBmï¼‰

#### 4. **æ€§èƒ½æŒ‡æ¨™**
- [ ] è™•ç†æ™‚é–“ < 2åˆ†é˜
- [ ] è¨˜æ†¶é«”ä½¿ç”¨ < 500MB
- [ ] ç¯©é¸ç‡åœ¨åˆç†ç¯„åœï¼ˆ70-95%ï¼Œå¤§éƒ¨åˆ†è¡›æ˜Ÿä¸å¯è¦‹è¢«ç¯©æ‰ï¼‰

#### 5. **å­¸è¡“ç´šé©—è­‰å¿«ç…§æ¨™æº–**

**é©—è­‰å¿«ç…§å¿…é ˆåŒ…å«8å€‹æ ¸å¿ƒæª¢æŸ¥**:
```json
{
  "validation": {
    "passed": true,
    "total_checks": 8,
    "passed_checks": 8,
    "failed_checks": 0,
    "critical_checks": [],
    "all_checks": {
      "output_structure_check": true,
      "filtering_engine_check": true, 
      "itu_r_compliance_check": true,
      "filtering_rate_reasonableness_check": true,
      "constellation_threshold_compliance_check": true,
      "satellite_count_consistency_check": true,
      "observer_coordinate_precision_check": true,
      "timeseries_continuity_check": true
    }
  }
}
```

#### 6. **è‡ªå‹•é©—è­‰è…³æœ¬**
```python
# åŸ·è¡Œéšæ®µé©—è­‰
python -c "
import json
import sys

# è¼‰å…¥é©—è­‰å¿«ç…§
try:
    with open('/app/data/validation_snapshots/stage2_validation.json', 'r') as f:
        validation_data = json.load(f)
except:
    print('âŒ ç„¡æ³•è¼‰å…¥é©—è­‰å¿«ç…§')
    sys.exit(1)

validation = validation_data.get('validation', {})

# æª¢æŸ¥æ˜¯å¦æœ‰8å€‹é©—è­‰
required_checks = {
    'output_structure_check': 'æ•¸æ“šçµæ§‹å®Œæ•´æ€§',
    'filtering_engine_check': 'ç¯©é¸å¼•æ“é¡å‹é©—è­‰',
    'itu_r_compliance_check': 'ITU-Råˆè¦æ¨¡å¼æª¢æŸ¥',
    'filtering_rate_reasonableness_check': 'ç¯©é¸ç‡åˆç†æ€§é©—è­‰',
    'constellation_threshold_compliance_check': 'æ˜Ÿåº§ä»°è§’é–€æª»æ­£ç¢ºæ€§',
    'satellite_count_consistency_check': 'è¼¸å…¥è¼¸å‡ºæ•¸é‡ä¸€è‡´æ€§',
    'observer_coordinate_precision_check': 'è§€æ¸¬é»åº§æ¨™ç²¾åº¦é©—è­‰',
    'timeseries_continuity_check': 'ä½ç½®æ™‚é–“æˆ³é€£çºŒæ€§æª¢æŸ¥'
}

all_checks = validation.get('all_checks', {})
total_checks = validation.get('total_checks', 0)
passed_checks = validation.get('passed_checks', 0)

print('ğŸ“Š Stage 2 å­¸è¡“ç´šé©—è­‰çµæœ:')
print(f'  é©—è­‰ç¸½æ•¸: {total_checks}/8 (å­¸è¡“æ¨™æº–è¦æ±‚8å€‹)')
print(f'  é€šéé©—è­‰: {passed_checks}/{total_checks}')
print('\\nå„é …é©—è­‰çµæœ:')

missing_checks = []
for check_name, description in required_checks.items():
    if check_name in all_checks:
        status = 'âœ…' if all_checks[check_name] else 'âŒ'
        print(f'  {status} {description}')
    else:
        missing_checks.append(f'{check_name} ({description})')
        print(f'  âš ï¸ ç¼ºå¤±: {description}')

if missing_checks:
    print(f'\\nâŒ ç¼ºå°‘ {len(missing_checks)} å€‹å¿…è¦é©—è­‰:')
    for missing in missing_checks:
        print(f'  - {missing}')
    print('\\nç³»çµ±éœ€è¦å‡ç´šé©—è­‰æ¡†æ¶ä»¥ç¬¦åˆå­¸è¡“æ¨™æº–')
    sys.exit(1)

if total_checks == 8 and passed_checks == 8:
    print('\\nâœ… Stage 2 å­¸è¡“ç´šé©—è­‰é€šéï¼ç¬¦åˆè«–æ–‡ç™¼è¡¨æ¨™æº–')
else:
    print(f'\\nâŒ é©—è­‰ä¸å®Œæ•´æˆ–æœ‰å¤±æ•—é …ç›® ({passed_checks}/{total_checks})')
    sys.exit(1)
"
```

### ğŸš¨ é©—è­‰å¤±æ•—è™•ç†
1. **ç¯©é¸æ•¸é‡éå°‘**
   - é™ä½ä»°è§’é–¾å€¼è¦æ±‚
   - æ¸›å°‘æœ€ä½å¯è¦‹æ™‚é–“è¦æ±‚
   - æª¢æŸ¥åœ°ç†ä½ç½®è¨­å®šæ˜¯å¦æ­£ç¢º
2. **ç¯©é¸æ•¸é‡éå¤š**
   - æé«˜ç¯©é¸æ¨™æº–
   - å¢åŠ å“è³ªè¦æ±‚
3. **æ™‚é–“åºåˆ—ç¼ºå¤±**
   - ç¢ºèªStage 1è¼¸å‡ºåŒ…å«å®Œæ•´æ•¸æ“š
   - æª¢æŸ¥è¨˜æ†¶é«”å‚³éæ˜¯å¦æ­£å¸¸
4. **æ˜Ÿåº§æ¯”ä¾‹å¤±è¡¡**
   - èª¿æ•´å„æ˜Ÿåº§çš„ç¯©é¸åƒæ•¸
   - æª¢æŸ¥åŸå§‹æ•¸æ“šåˆ†ä½ˆ

### ğŸ“Š é—œéµæŒ‡æ¨™
- **ç¯©é¸æ•ˆç‡**: ä¿ç•™10-15%çš„é«˜å“è³ªå€™é¸è¡›æ˜Ÿ
- **åœ°ç†è¦†è“‹**: ç¢ºä¿NTPUä¸Šç©ºæœ‰è¶³å¤ å¯è¦‹è¡›æ˜Ÿ
- **æ•¸æ“šå®Œæ•´**: ä¿ç•™å®Œæ•´è»Œé“æ•¸æ“šä¾›å¾ŒçºŒè™•ç†

---
**ä¸Šä¸€éšæ®µ**: [éšæ®µä¸€ï¼šTLEè¼‰å…¥](./stage1-tle-loading.md)  
**ä¸‹ä¸€éšæ®µ**: [éšæ®µä¸‰ï¼šä¿¡è™Ÿåˆ†æ](./stage3-signal.md)  
**ç›¸é—œæ–‡æª”**: [æ™ºèƒ½ç¯©é¸æ¼”ç®—æ³•è©³è§£](../algorithms_implementation.md#æ™ºèƒ½ç¯©é¸)
