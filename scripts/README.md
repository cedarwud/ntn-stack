# ğŸš€ TLE æ•¸æ“šè‡ªå‹•ä¸‹è¼‰å·¥å…·

## ğŸ“ åŠŸèƒ½æè¿°

è‡ªå‹•ä¸‹è¼‰ Starlink å’Œ OneWeb çš„ TLE å’Œ JSON æ•¸æ“šï¼Œæ”¯æ´ï¼š
- è‡ªå‹•æ—¥æœŸå‘½åï¼ˆYYYYMMDD æ ¼å¼ï¼‰
- æ•¸æ“šå®Œæ•´æ€§é©—è­‰
- é‡è¤‡ä¸‹è¼‰æª¢æŸ¥
- è©³ç´°åŸ·è¡Œå ±å‘Š
- éŒ¯èª¤è™•ç†å’Œé‡è©¦

## ğŸ•°ï¸ å»ºè­°åŸ·è¡Œæ™‚é–“

**UTC 08:00 (å°ç£æ™‚é–“ 16:00)**

åŸå› ï¼š
- CelesTrak åœ¨ UTC 00:00-06:00 æ›´æ–°æ•¸æ“š
- UTC 08:00 å¾Œç¢ºä¿ç²å¾—æœ€æ–°æ•¸æ“š
- é¿é–‹ç¶²è·¯é«˜å³°æœŸ
- å°ç£æ™‚é–“ 16:00 é©åˆæ‰‹å‹•åŸ·è¡Œ

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### ğŸ“¦ é›™ç‰ˆæœ¬è…³æœ¬èªªæ˜

| è…³æœ¬ç‰ˆæœ¬ | åŠŸèƒ½ç‰¹é» | é©ç”¨å ´æ™¯ |
|---------|---------|---------|
| `daily_tle_download.sh` | åŸºç¤ç‰ˆæœ¬ï¼Œæª”æ¡ˆå­˜åœ¨æ™‚è·³é | é¦–æ¬¡ä¸‹è¼‰æˆ–ç¢ºå®šä¸éœ€è¦æ›´æ–° |
| `daily_tle_download_enhanced.sh` | **æ™ºèƒ½æ›´æ–°æª¢æŸ¥ç‰ˆæœ¬** | **æ¯æ—¥ä¾‹è¡Œä¸‹è¼‰ï¼Œè‡ªå‹•æª¢æ¸¬æ›´æ–°** |

### åŸºæœ¬åŸ·è¡Œï¼ˆæ¨è–¦ä½¿ç”¨å¢å¼·ç‰ˆï¼‰
```bash
cd /home/sat/ntn-stack

# æ™ºèƒ½æ›´æ–°æ¨¡å¼ï¼ˆæ¨è–¦ï¼‰
./scripts/daily_tle_download_enhanced.sh

# åŸºç¤ç‰ˆæœ¬
./scripts/daily_tle_download.sh
```

### å¢å¼·ç‰ˆæœ¬é«˜ç´šé¸é …
```bash
# å¼·åˆ¶é‡æ–°ä¸‹è¼‰æ‰€æœ‰æª”æ¡ˆ
./scripts/daily_tle_download_enhanced.sh --force

# ä¸æª¢æŸ¥æ›´æ–°ï¼Œç›´æ¥è·³éå·²å­˜åœ¨æª”æ¡ˆï¼ˆç­‰åŒæ–¼åŸºç¤ç‰ˆæœ¬ï¼‰
./scripts/daily_tle_download_enhanced.sh --no-update-check

# ä¸å‚™ä»½ç¾æœ‰æª”æ¡ˆ
./scripts/daily_tle_download_enhanced.sh --no-backup

# æŸ¥çœ‹å¹«åŠ©
./scripts/daily_tle_download_enhanced.sh --help
```

## ğŸ“Š åŸ·è¡Œçµæœ

### æˆåŠŸåŸ·è¡Œç¯„ä¾‹
```
ğŸš€ LEO è¡›æ˜Ÿ TLE æ•¸æ“šæ¯æ—¥ä¸‹è¼‰å·¥å…·
ğŸ“… ç›®æ¨™æ—¥æœŸ: 20250728 (UTC)
ğŸ• ç•¶å‰æ™‚é–“: 2025-07-28 08:00:00 UTC

==========================================
ğŸ“Š æ¯æ—¥ TLE æ•¸æ“šä¸‹è¼‰å ±å‘Š
==========================================
âœ… Starlink: å…¨éƒ¨æˆåŠŸ
âœ… OneWeb: å…¨éƒ¨æˆåŠŸ

ğŸ“ æª”æ¡ˆçµæ§‹:
  starlink/tle/starlink_20250728.tle        1,245,678 bytes
  starlink/json/starlink_20250728.json      3,456,789 bytes
  oneweb/tle/oneweb_20250728.tle              156,234 bytes
  oneweb/json/oneweb_20250728.json            234,567 bytes

ğŸ“ˆ æ”¶é›†é€²åº¦çµ±è¨ˆ:
  starlink tle   :   1 å€‹æª”æ¡ˆ
  starlink json  :   1 å€‹æª”æ¡ˆ
  oneweb tle     :   1 å€‹æª”æ¡ˆ
  oneweb json    :   1 å€‹æª”æ¡ˆ
==========================================
```

## ğŸ“ æª”æ¡ˆå‘½åæ ¼å¼

```
tle_data/
â”œâ”€â”€ starlink/
â”‚   â”œâ”€â”€ tle/starlink_20250728.tle     # YYYYMMDD æ ¼å¼
â”‚   â””â”€â”€ json/starlink_20250728.json
â””â”€â”€ oneweb/
    â”œâ”€â”€ tle/oneweb_20250728.tle
    â””â”€â”€ json/oneweb_20250728.json
```

## ğŸ”„ æ™ºèƒ½æ›´æ–°æª¢æŸ¥æ©Ÿåˆ¶ï¼ˆå¢å¼·ç‰ˆå°ˆå±¬ï¼‰

### ğŸ“‹ æª”æ¡ˆæ›´æ–°åˆ¤æ–·é‚è¼¯
å¢å¼·ç‰ˆè…³æœ¬è§£æ±ºäº†ã€Œç•¶å¤©æª”æ¡ˆå·²å­˜åœ¨ä½†å¯èƒ½æœ‰æ›´æ–°æ•¸æ“šã€çš„å•é¡Œï¼š

1. **HTTP æ¨™é ­æª¢æŸ¥**ï¼šæ¯”è¼ƒé ç«¯æª”æ¡ˆçš„ `Last-Modified` å’Œ `Content-Length`
2. **æœ¬åœ°æª”æ¡ˆæ¯”å°**ï¼šæª¢æŸ¥æœ¬åœ°æª”æ¡ˆå¤§å°å’Œä¿®æ”¹æ™‚é–“
3. **æ™ºèƒ½æ±ºç­–**ï¼š
   - æª”æ¡ˆå¤§å°ä¸åŒ â†’ ç«‹å³æ›´æ–°
   - é ç«¯æª”æ¡ˆè¼ƒæ–° â†’ ç«‹å³æ›´æ–°  
   - æª”æ¡ˆç›¸åŒä¸”æœ€æ–° â†’ è·³éä¸‹è¼‰

### ğŸ›¡ï¸ å®‰å…¨å‚™ä»½æ©Ÿåˆ¶
- **è‡ªå‹•å‚™ä»½**ï¼šæ›´æ–°å‰å‚™ä»½ç¾æœ‰æª”æ¡ˆåˆ° `tle_data/backups/YYYYMMDD/`
- **åŸå­æ“ä½œ**ï¼šå…ˆä¸‹è¼‰åˆ°è‡¨æ™‚æª”æ¡ˆï¼Œé©—è­‰é€šéå¾Œæ‰è¦†è“‹
- **å¤±æ•—æ¢å¾©**ï¼šé©—è­‰å¤±æ•—æ™‚è‡ªå‹•æ¢å¾©å‚™ä»½æª”æ¡ˆ

### ğŸ¯ å¯¦éš›æ‡‰ç”¨å ´æ™¯
```bash
# å ´æ™¯1ï¼šæ—©ä¸Š8é»é¦–æ¬¡ä¸‹è¼‰
./scripts/daily_tle_download_enhanced.sh
# çµæœï¼šä¸‹è¼‰æ–°æª”æ¡ˆ

# å ´æ™¯2ï¼šä¸‹åˆå†æ¬¡åŸ·è¡Œï¼ŒCelesTrakæœ‰æ›´æ–°
./scripts/daily_tle_download_enhanced.sh  
# çµæœï¼šæª¢æ¸¬åˆ°æ›´æ–°ï¼Œå‚™ä»½èˆŠæª”æ¡ˆä¸¦ä¸‹è¼‰æ–°ç‰ˆæœ¬

# å ´æ™¯3ï¼šæ™šä¸Šå†æ¬¡åŸ·è¡Œï¼Œç„¡æ›´æ–°
./scripts/daily_tle_download_enhanced.sh
# çµæœï¼šæª¢æ¸¬åˆ°æª”æ¡ˆæœ€æ–°ï¼Œè·³éä¸‹è¼‰
```

## ğŸ” æ•¸æ“šé©—è­‰æ©Ÿåˆ¶

### TLE æ•¸æ“šé©—è­‰
- æª¢æŸ¥æª”æ¡ˆæ ¼å¼ï¼ˆç¬¬2ã€3è¡Œå¿…é ˆä»¥"1 "å’Œ"2 "é–‹é ­ï¼‰
- é©—è­‰ epoch å¹´ä»½æ˜¯å¦åˆç†
- ç¢ºèªè¡›æ˜Ÿæ•¸é‡ > 0
- æª¢æŸ¥æª”æ¡ˆå¤§å° > 100 bytes

### JSON æ•¸æ“šé©—è­‰
- é©—è­‰ JSON æ ¼å¼æ­£ç¢ºæ€§
- ç¢ºèªæ•¸çµ„é•·åº¦ > 0
- æª¢æŸ¥ç¬¬ä¸€å€‹å…ƒç´ çš„ EPOCH æ¬„ä½
- ç¢ºèªæª”æ¡ˆå¤§å°åˆç†

## ğŸ“ æ—¥èªŒåŠŸèƒ½

### æ—¥èªŒä½ç½®
```
/home/sat/ntn-stack/logs/tle_download.log
```

### æ—¥èªŒå…§å®¹
- ä¸‹è¼‰é–‹å§‹/çµæŸæ™‚é–“
- æˆåŠŸ/å¤±æ•—ç‹€æ…‹
- æª”æ¡ˆå¤§å°å’Œè¡›æ˜Ÿæ•¸é‡
- éŒ¯èª¤è¨Šæ¯å’Œè­¦å‘Š

### æŸ¥çœ‹æ—¥èªŒ
```bash
# æŸ¥çœ‹æœ€æ–°æ—¥èªŒ
tail -f /home/sat/ntn-stack/logs/tle_download.log

# æŸ¥çœ‹ä»Šå¤©çš„æ—¥èªŒ
grep "$(date -u '+%Y-%m-%d')" /home/sat/ntn-stack/logs/tle_download.log

# æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ
grep "ERROR" /home/sat/ntn-stack/logs/tle_download.log
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### 1. ç¶²è·¯é€£æ¥å¤±æ•—
```bash
# æª¢æŸ¥ç¶²è·¯é€£æ¥
ping celestrak.org
curl -I https://celestrak.org
```

#### 2. æª”æ¡ˆæ›´æ–°æª¢æŸ¥ï¼ˆå¢å¼·ç‰ˆï¼‰
```bash
# å¦‚æœæ‡·ç–‘æ›´æ–°æª¢æŸ¥æœ‰å•é¡Œï¼Œå¯ä»¥ï¼š

# å¼·åˆ¶é‡æ–°ä¸‹è¼‰
./scripts/daily_tle_download_enhanced.sh --force

# æ‰‹å‹•æª¢æŸ¥é ç«¯æª”æ¡ˆä¿¡æ¯
curl -I https://celestrak.org/NORAD/elements/gp.php?GROUP=starlink&FORMAT=tle

# æ¯”è¼ƒæœ¬åœ°æª”æ¡ˆæ™‚é–“
stat tle_data/starlink/tle/starlink_$(date -u '+%Y%m%d').tle
```

#### 3. æª”æ¡ˆå·²å­˜åœ¨ï¼ˆåŸºç¤ç‰ˆï¼‰
- åŸºç¤ç‰ˆè…³æœ¬æœƒè‡ªå‹•è·³éå·²å­˜åœ¨çš„æª”æ¡ˆ
- å¦‚éœ€é‡æ–°ä¸‹è¼‰ï¼Œè«‹æ‰‹å‹•åˆªé™¤æª”æ¡ˆæˆ–ä½¿ç”¨å¢å¼·ç‰ˆ

#### 4. æ•¸æ“šé©—è­‰å¤±æ•—
- è…³æœ¬æœƒè‡ªå‹•åˆªé™¤é©—è­‰å¤±æ•—çš„æª”æ¡ˆ
- æª¢æŸ¥æ—¥èªŒäº†è§£å…·é«”å¤±æ•—åŸå› 

#### 5. æ¬Šé™å•é¡Œ
```bash
# ç¢ºä¿è…³æœ¬å¯åŸ·è¡Œ
chmod +x /home/sat/ntn-stack/scripts/daily_tle_download.sh
chmod +x /home/sat/ntn-stack/scripts/daily_tle_download_enhanced.sh

# ç¢ºä¿ç›®éŒ„å¯å¯«
chmod 755 /home/sat/ntn-stack/tle_data
```

## ğŸ“ˆ ä½¿ç”¨å»ºè­°

### æ¯æ—¥åŸ·è¡Œæµç¨‹ï¼ˆæ¨è–¦ä½¿ç”¨å¢å¼·ç‰ˆï¼‰
1. **UTC 08:00** åŸ·è¡Œå¢å¼·ç‰ˆè…³æœ¬ `./scripts/daily_tle_download_enhanced.sh`
2. æª¢æŸ¥åŸ·è¡Œå ±å‘Šç¢ºèªæˆåŠŸ
3. å¦‚æœ‰å¤±æ•—ï¼ŒæŸ¥çœ‹æ—¥èªŒä¸¦é‡æ–°åŸ·è¡Œ  
4. **å¯é‡è¤‡åŸ·è¡Œ**ï¼šä¸€å¤©å…§å¤šæ¬¡åŸ·è¡Œæœƒè‡ªå‹•æª¢æŸ¥æ›´æ–°
5. å®šæœŸå‚™ä»½ tle_data ç›®éŒ„ï¼ˆå¢å¼·ç‰ˆæœ‰è‡ªå‹•å‚™ä»½åŠŸèƒ½ï¼‰

### è‡ªå‹•åŒ–é¸é …
å¯ä»¥è¨­å®š cron job è‡ªå‹•åŸ·è¡Œï¼š
```bash
# ç·¨è¼¯ crontab
crontab -e

# æ¨è–¦ï¼šä½¿ç”¨å¢å¼·ç‰ˆè‡ªå‹•åŸ·è¡Œ
0 8 * * * /home/sat/ntn-stack/scripts/daily_tle_download_enhanced.sh >> /home/sat/ntn-stack/logs/cron.log 2>&1

# æˆ–è€…ï¼šåŸºç¤ç‰ˆæœ¬
# 0 8 * * * /home/sat/ntn-stack/scripts/daily_tle_download.sh >> /home/sat/ntn-stack/logs/cron.log 2>&1
```

### æ•¸æ“šå‚™ä»½
```bash
# æ¯é€±å‚™ä»½æ•¸æ“š
tar -czf "tle_backup_$(date +%Y%m%d).tar.gz" tle_data/

# åŒæ­¥åˆ°é ç«¯
rsync -av tle_data/ backup_server:/path/to/backup/
```

## ğŸ¯ ä¸‹ä¸€æ­¥

åŸ·è¡Œè…³æœ¬å¾Œï¼Œæ”¶é›†çš„æ•¸æ“šå°‡è‡ªå‹•æ”¯æ´ï¼š
- RL å¼·åŒ–å­¸ç¿’è¨“ç·´æ•¸æ“šç”Ÿæˆ
- è»Œé“æ¼”åŒ–åˆ†æ
- Starlink vs OneWeb å°æ¯”ç ”ç©¶
- å­¸è¡“è«–æ–‡æ•¸æ“šä¾†æº

---

**ğŸ¯ ç›®æ¨™**: æ¯å¤©æ”¶é›†é«˜å“è³ªçš„ LEO è¡›æ˜Ÿè»Œé“æ•¸æ“šï¼Œæ”¯æ´æ›æ‰‹å„ªåŒ–ç ”ç©¶