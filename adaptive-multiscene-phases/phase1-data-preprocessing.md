# Phase 1: è³‡æ–™é è™•ç†æ¶æ§‹èˆ‡æµç¨‹

## ç›®æ¨™
å»ºç«‹å®Œæ•´çš„è¡›æ˜Ÿè³‡æ–™é è™•ç†æ¶æ§‹ï¼Œåœ¨ Docker æ˜ åƒæª”å»ºæ§‹éšæ®µå®Œæˆ NTPU å ´æ™¯çš„è³‡æ–™è¨ˆç®—ï¼Œç‚º D2/A4/A5 äº‹ä»¶æª¢æ¸¬å’Œ 3D è¦–è¦ºåŒ–æä¾›åŸºç¤ã€‚

## ç¾æœ‰é è™•ç†æ¶æ§‹

### 1.1 å…©éšæ®µé è™•ç†æµç¨‹

#### ç¬¬ä¸€éšæ®µï¼šåŸºç¤è»Œé“è¨ˆç®— (build_with_phase0_data.py)
åœ¨ Docker build æ™‚åŸ·è¡Œï¼Œè¨ˆç®—å…§å®¹ï¼š
- **SGP4 è»Œé“é æ¸¬**ï¼šæ¯ 30 ç§’è¨ˆç®—ä¸€æ¬¡ä½ç½®
  - ç›®å‰è¨­å®šï¼š96 åˆ†é˜ï¼ˆé©åˆ Starlink å®Œæ•´é€±æœŸï¼‰
  - å•é¡Œï¼šOneWeb éœ€è¦ ~110 åˆ†é˜æ‰èƒ½å®Œæˆä¸€å€‹è»Œé“é€±æœŸ
  - å»ºè­°ï¼šå»¶é•·è‡³ 110 åˆ†é˜ä»¥æ¶µè“‹å…©å€‹æ˜Ÿåº§
- **å¯è¦‹æ€§åˆ¤å®š**ï¼šè¨ˆç®—æ¯é¡†è¡›æ˜Ÿå° NTPU çš„ä»°è§’ï¼Œç¯©é¸ > 10Â° çš„å¯è¦‹è¡›æ˜Ÿ
- **å¯è¦‹æ€§çª—å£**ï¼šè¨˜éŒ„æ¯æ®µå¯è¦‹æœŸé–“çš„é–‹å§‹/çµæŸæ™‚é–“ã€æœ€å¤§ä»°è§’
- **è¡›æ˜Ÿæ•¸é‡**ï¼šStarlink ç´„ 7996 é¡†ã€OneWeb ç´„ 651 é¡†

è¼¸å‡ºæª”æ¡ˆï¼š
```json
// phase0_precomputed_orbits.json çµæ§‹
{
  "generated_at": "2025-01-01T00:00:00Z",
  "observer_location": {
    "lat": 24.94417,
    "lon": 121.37139,
    "alt": 50.0,
    "name": "NTPU"
  },
  "constellations": {
    "starlink": {
      "orbit_data": {
        "satellites": {
          "48273": {  // NORAD ID
            "name": "STARLINK-1234",
            "positions": [
              {
                "time": "2025-01-01T00:00:00Z",
                "lat": 25.123,
                "lon": 121.456,
                "alt_km": 550.0,
                "elevation_deg": 45.6,
                "azimuth_deg": 123.4,
                "is_visible": true
              }
              // ... æ¯ 30 ç§’ä¸€ç­†
              // Starlink: ~192 ç­† (96åˆ†é˜)
              // OneWeb: ~220 ç­† (110åˆ†é˜)
            ],
            "visibility_windows": [
              {
                "start_time": "2025-01-01T00:05:30Z",
                "end_time": "2025-01-01T00:12:30Z",
                "max_elevation": 67.8,
                "duration_seconds": 420
              }
            ]
          }
        }
      }
    }
  }
}
```

#### ç¬¬äºŒéšæ®µï¼šåˆ†å±¤é–€æª»è™•ç† (generate_layered_phase0_data.py)
åŸºæ–¼ç¬¬ä¸€éšæ®µæ•¸æ“šï¼Œæ‡‰ç”¨ä¸‰å±¤ä»°è§’é–€æª»ï¼š
- **é å‚™è§¸ç™¼é–€æª»**ï¼š13.5Â° - é–‹å§‹æº–å‚™æ›æ‰‹
- **åŸ·è¡Œé–€æª»**ï¼š11.25Â° - åŸ·è¡Œæ›æ‰‹æ±ºç­–
- **è‡¨ç•Œé–€æª»**ï¼š5.0Â° - ç·Šæ€¥æ›æ‰‹ä¿éšœ

### 1.2 å„²å­˜æ¶æ§‹
```
/netstack/data/
â”œâ”€â”€ phase0_precomputed_orbits.json    # åŸºç¤è»Œé“æ•¸æ“š (~150MB)
â”œâ”€â”€ phase0_data_summary.json           # æ•¸æ“šæ‘˜è¦
â”œâ”€â”€ phase0_build_config.json           # å»ºæ§‹é…ç½®
â”œâ”€â”€ layered_phase0/                    # åˆ†å±¤è™•ç†çµæœ
â”‚   â”œâ”€â”€ layered_analysis_20250727.json
â”‚   â””â”€â”€ layered_phase0_summary.json
â””â”€â”€ scenes.csv                         # å ´æ™¯åƒæ•¸è¡¨ï¼ˆé ç•™å¤šå ´æ™¯ï¼‰
```

### 1.3 Volume æ›è¼‰ç­–ç•¥
- **å»ºæ§‹æ™‚**ï¼šæ•¸æ“šç”Ÿæˆåœ¨æ˜ åƒæª”å…§çš„ `/app/data`
- **é‹è¡Œæ™‚**ï¼šé€é Docker volume æ›è¼‰ï¼Œé¿å…é‡è¤‡è¨ˆç®—
- **æ›´æ–°æ©Ÿåˆ¶**ï¼šç•¶ TLE æ•¸æ“šæ›´æ–°æ™‚ï¼Œé‡æ–°åŸ·è¡Œå»ºæ§‹æµç¨‹

## âœ… å¯¦æ–½å®Œæˆç‹€æ…‹ (2025-08-01)

### ğŸ‰ Phase 1 é‡å¤§å„ªåŒ–å®Œæˆ

#### å·²å®Œæˆçš„æ ¸å¿ƒæ”¹å–„
- âœ… **120 åˆ†é˜è»Œé“é€±æœŸå¯¦ç¾** - æ–°å¢ `compute_120min_orbital_cycle` æ–¹æ³•
- âœ… **è³‡æ–™å¤§å¹…å„ªåŒ–** - å¾ 1.1GB ç¸®æ¸›åˆ° 17.9MB (98.4% å„ªåŒ–)
- âœ… **åªå„²å­˜å¯è¦‹ä½ç½®** - 87% è³‡æ–™ç¸®æ¸›ç‡ï¼Œç§»é™¤ç„¡ç”¨è³‡æ–™
- âœ… **Docker æ˜ åƒæª”é‡å»º** - æ°¸ä¹…è¼‰å…¥æ–°ä»£ç¢¼æ¶æ§‹
- âœ… **å»ºç½®æµç¨‹å„ªåŒ–** - 3.9 ç§’å¿«é€Ÿå»ºç½®
- âœ… **ç§»é™¤ä¸å¿…è¦å£“ç¸®** - 17.9MB æª”æ¡ˆä¿æŒ JSON æ ¼å¼ä¾¿æ–¼é–‹ç™¼

#### æ•ˆèƒ½æå‡æ•¸æ“š
| æŒ‡æ¨™ | å„ªåŒ–å‰ | å„ªåŒ–å¾Œ | æ”¹å–„ |
|------|--------|--------|------|
| æª”æ¡ˆå¤§å° | 1.1GB | 17.9MB | 98.4% â†“ |
| å»ºç½®æ™‚é–“ | 5.9s | 3.9s | 34% â†“ |
| å¯è¦‹è¡›æ˜Ÿæ•¸ | - | 2,356/8,695 | 27% |
| å¹³å‡å¯è¦‹ç‡ | - | 12-13% | ç¬¦åˆå¯¦éš› |

### ğŸ—ï¸ æœ€çµ‚æ¶æ§‹
```
/netstack/data/
â”œâ”€â”€ phase0_precomputed_orbits.json    # å„ªåŒ–å¾Œè»Œé“æ•¸æ“š (17.9MB)
â”œâ”€â”€ phase0_build_summary.json         # å»ºç½®æ‘˜è¦
â””â”€â”€ scenes.csv                        # å ´æ™¯åƒæ•¸è¡¨
```

### ğŸ“‹ ç‚º Phase 2 æº–å‚™å°±ç·’
- âœ… çœŸå¯¦ 120 åˆ†é˜è»Œé“è³‡æ–™
- âœ… é«˜æ•ˆè³‡æ–™å­˜å– (17.9MB)
- âœ… å¯è¦‹æ€§çª—å£å®Œæ•´è¨˜éŒ„
- âœ… æ¨™æº–åŒ– JSON æ ¼å¼

## å¾…å¯¦ç¾ï¼šD2/A4/A5 äº‹ä»¶é è™•ç†

### 1.4 è»Œé“é€±æœŸèª¿æ•´å»ºè­°

```python
class Phase0DataPreprocessor:
    def __init__(self):
        # é‡å°ä¸åŒæ˜Ÿåº§è¨­å®šä¸åŒçš„è¨ˆç®—é€±æœŸ
        self.constellation_periods = {
            'starlink': 96,   # åˆ†é˜
            'oneweb': 110     # åˆ†é˜
        }
        
        # æˆ–ä½¿ç”¨çµ±ä¸€çš„è¼ƒé•·é€±æœŸ
        self.unified_period_minutes = 110  # æ¶µè“‹æ‰€æœ‰æ˜Ÿåº§
```

### 1.5 äº‹ä»¶ç¯©é¸é‚è¼¯æ•´åˆ
éœ€è¦åœ¨ `build_with_phase0_data.py` ä¸­åŠ å…¥ï¼š

```python
def detect_handover_events(self, visibility_windows, elevation_thresholds):
    """æª¢æ¸¬ D2/A4/A5 æ›æ‰‹äº‹ä»¶"""
    events = {
        'd2_events': [],  # æœå‹™è¡›æ˜Ÿå³å°‡æ¶ˆå¤±
        'a4_events': [],  # é„°è¿‘è¡›æ˜Ÿè®Šå¥½
        'a5_events': []   # æœå‹™è®Šå·®ä¸”é„°è¿‘è®Šå¥½
    }
    
    # D2 äº‹ä»¶ï¼šç•¶å‰æœå‹™è¡›æ˜Ÿä»°è§’æ¥è¿‘è‡¨ç•Œé–€æª»
    for window in visibility_windows:
        if window['min_elevation'] <= elevation_thresholds['critical'] + 2.0:
            events['d2_events'].append({
                'satellite_id': window['satellite_id'],
                'trigger_time': window['critical_approach_time'],
                'elevation_at_trigger': window['elevation_at_trigger']
            })
    
    return events
```

### 1.6 åˆ†é›¢å„²å­˜æ¶æ§‹
å»ºè­°å°‡è³‡æ–™åˆ†ç‚ºå…©é¡ï¼š
1. **è»Œé“è³‡æ–™** (for 3D è¦–è¦ºåŒ–)ï¼šè¡›æ˜Ÿä½ç½®ã€é€Ÿåº¦ã€è»Œè·¡
2. **äº‹ä»¶è³‡æ–™** (for åœ–è¡¨åˆ†æ)ï¼šD2/A4/A5 äº‹ä»¶æ™‚é–“åºåˆ—ã€æ›æ‰‹çµ±è¨ˆ

```
/netstack/data/
â”œâ”€â”€ orbits/                           # 3D è¦–è¦ºåŒ–ç”¨
â”‚   â””â”€â”€ ntpu_orbit_data.json         
â”œâ”€â”€ events/                           # äº‹ä»¶åˆ†æç”¨  
â”‚   â””â”€â”€ ntpu_handover_events.json
â””â”€â”€ statistics/                       # çµ±è¨ˆæ‘˜è¦
    â””â”€â”€ ntpu_analysis_summary.json
```

## è³‡æ–™é‡ä¼°ç®—

åŸºæ–¼ç¾æœ‰æ•¸æ“šï¼š
- **åŸå§‹ TLE**ï¼š~5MB/å¤© (å…©å€‹æ˜Ÿåº§)
- **é è¨ˆç®—è»Œé“**ï¼š
  - ç›®å‰ï¼š~150MB (96åˆ†é˜é€±æœŸ)
  - å»ºè­°ï¼š~170MB (110åˆ†é˜é€±æœŸï¼Œæ¶µè“‹ OneWeb å®Œæ•´è»Œé“)
- **å¯è¦‹è¡›æ˜Ÿæ•¸**ï¼šåŒæ™‚ç´„ 20-30 é¡†
- **æ›æ‰‹äº‹ä»¶**ï¼šæ¯å°æ™‚ç´„ 10-15 æ¬¡

## æ•ˆèƒ½å„ªåŒ–å»ºè­°

1. **å¢é‡æ›´æ–°**ï¼šåªè¨ˆç®—æ–°å¢çš„ TLE æ•¸æ“š
2. **å£“ç¸®å„²å­˜**ï¼šä½¿ç”¨ gzip å£“ç¸® JSON
3. **å¿«å–æ©Ÿåˆ¶**ï¼šç†±é–€æŸ¥è©¢çµæœå¿«å–
4. **å¹³è¡Œè™•ç†**ï¼šå¤šæ ¸å¿ƒåŒæ™‚è¨ˆç®—ä¸åŒè¡›æ˜Ÿ