# 🚨 Phase 1: 緊急修復計劃 (Week 1)

## 📋 概述

**目標**: 修復當前致命 bug，阻止假數據流入下游系統  
**時程**: 1週內完成  
**優先級**: 🔴 P0 - 阻斷性問題  

## 🎯 核心問題

### 🚨 [BLOCKER] OneWeb ECI 座標全零問題
**現象**: 651 顆 OneWeb 衛星 SGP4 計算結果全為 (0,0,0)  
**影響**: 學術造假，論文研究無效化  
**根本原因**: SGP4 計算錯誤但被靜默忽略  

### 🔴 [CRITICAL] 驗證快照統計錯誤
**現象**: extract_key_metrics 方法回傳 0 顆衛星統計  
**影響**: 驗證機制完全失效，假陽性通過  
**根本原因**: 數據結構不匹配，參數傳遞錯誤  

### ⚠️ [HIGH] 處理時間異常
**現象**: 32 秒完成 8,837 顆衛星計算 (應為 4-5 分鐘)  
**影響**: 數據可信度質疑  
**根本原因**: 大量計算被跳過或簡化  

## 🛠️ 修復任務清單

### Task 1: 修復 OneWeb SGP4 計算錯誤
**檔案**: `/netstack/src/services/satellite/coordinate_specific_orbit_engine.py`  
**方法**: `compute_109min_orbital_cycle`  

**修復步驟**:
1. [ ] 檢查 OneWeb TLE 數據完整性  
2. [ ] 修復 SGP4 參數傳遞錯誤  
3. [ ] 加入強制 ECI 座標零值檢測  
4. [ ] 實施 OneWeb 專用錯誤處理  

**驗收標準**:
- ✅ OneWeb 衛星 ECI 座標非零  
- ✅ 座標值符合軌道範圍 (-42000 ~ +42000 km)  
- ✅ 所有 651 顆衛星都有有效計算結果  

### Task 2: 修復驗證快照統計邏輯
**檔案**: `/netstack/src/stages/orbital_calculation_processor.py`  
**方法**: `extract_key_metrics`, `_validate_academic_standards_compliance`  

**修復步驟**:
1. [ ] 修正數據結構處理邏輯  
2. [ ] 修復參數傳遞錯誤  
3. [ ] 加入數據完整性檢查  
4. [ ] 實施強制零值檢測  

**驗收標準**:
- ✅ 正確回傳衛星總數 (應為 8,837)  
- ✅ 正確統計各星座數量  
- ✅ 檢測到 OneWeb 零值問題並報錯  

### Task 3: 實施 ECI 座標零值自動檢測
**新增功能**: 學術標準強制檢查器  

**實施步驟**:
1. [ ] 建立 `ECI_ZERO_VALUE_DETECTOR` 類別  
2. [ ] 實施星座別零值統計  
3. [ ] 加入閾值設定 (>1% 零值 = 失敗)  
4. [ ] 整合到驗證流程  

**驗收標準**:
- ✅ 自動檢測 OneWeb 100% 零值問題  
- ✅ 產生詳細錯誤報告  
- ✅ 阻止假數據進入後續階段  

### Task 4: 修復處理時間異常
**分析重點**: 找出計算被跳過的原因  

**調查步驟**:
1. [ ] 加入詳細計時日誌  
2. [ ] 檢查並發處理邏輯  
3. [ ] 驗證所有衛星都被完整處理  
4. [ ] 確保 SGP4 計算量符合預期  

**驗收標準**:
- ✅ 處理時間回復到 4-5 分鐘範圍  
- ✅ 每顆衛星都有完整計算記錄  
- ✅ 計算量與文檔一致  

## 📊 驗證標準

### 🎯 修復完成檢查清單
**數據品質檢查**:
- [ ] OneWeb 衛星 ECI 座標 100% 非零  
- [ ] Starlink 衛星數據維持品質  
- [ ] 處理時間符合預期範圍  
- [ ] 驗證快照統計正確  

**學術標準合規**:
- [ ] 符合 Grade A 數據要求  
- [ ] 無任何假設值或模擬數據  
- [ ] 所有計算有物理依據  
- [ ] 錯誤處理不回退到假值  

**系統整合測試**:
- [ ] Stage 1 完整執行無錯誤  
- [ ] 輸出文件格式正確  
- [ ] 下游階段可正常讀取  
- [ ] 驗證快照機制正常運作  

## 🚦 風險管控

### ⚠️ 主要風險
1. **技術風險**: SGP4 計算修復可能影響 Starlink 數據  
2. **時程風險**: 深層 bug 修復可能需要重構  
3. **數據風險**: 修復過程可能暴露更多問題  

### 🛡️ 緩解措施
1. **備份策略**: 修改前完整備份當前狀態  
2. **漸進修復**: 先修復驗證邏輯，再修復計算邏輯  
3. **測試優先**: 每個修復都有對應測試案例  

## 📈 成功指標

### 🎯 量化目標
- **OneWeb 零值比例**: 0% (當前 100%)  
- **處理時間**: 4-5 分鐘 (當前 32 秒)  
- **驗證準確率**: 100% (當前假陽性)  
- **學術標準合規率**: 100%  

### 🏆 里程碑
- **Day 1-2**: OneWeb SGP4 修復完成  
- **Day 3-4**: 驗證快照邏輯修復  
- **Day 5-6**: 自動檢測器實施  
- **Day 7**: 整合測試與驗收  

## 📞 緊急聯絡

**技術負責人**: NTN Stack 研究團隊  
**升級路徑**: 學術標準違規立即上報  
**支援時間**: 24/7 全天候支援  

---

**⚡ 核心原則**: 零容忍假數據 > 系統穩定性 > 開發效率  
**🎯 成功定義**: OneWeb ECI 座標問題完全解決，驗證機制重新有效  

*建立日期: 2025-09-09*  
*責任歸屬: Phase 1 緊急修復小組*