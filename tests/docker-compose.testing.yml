version: '3.8'

services:
  stage4-testing:
    build:
      context: ..
      dockerfile: tests/Dockerfile.testing
    container_name: ntn-stage4-testing
    volumes:
      - .:/tests/src
      - ./results:/tests/results
    environment:
      - PYTHONPATH=/tests/src
      - NETSTACK_URL=http://netstack-api:8080
      - SIMWORLD_URL=http://simworld_backend:8888
    networks:
      - netstack-core  # é€£æ¥åˆ°NetStackç¶²è·¯
      - sionna-net     # é€£æ¥åˆ°SimWorldç¶²è·¯
    depends_on:
      - netstack-api
      - simworld_backend
    command: >
      bash -c "
        echo 'ğŸš€ é–‹å§‹éšæ®µå››æ¸¬è©¦ç’°å¢ƒåˆå§‹åŒ–...'
        cd /tests/src
        python docker_test_runner.py
      "

networks:
  netstack-core:
    external: true
  sionna-net:
    external: true