# AI æ±ºç­–å¼•æ“å‘Šè­¦è¦å‰‡
# éšæ®µ8ï¼šAIæ±ºç­–ç³»çµ±å°ˆç”¨ç›£æ§å‘Šè­¦

groups:
  - name: ai_decision_engine
    interval: 10s
    rules:
      # ğŸ”¥ AIæ±ºç­–å»¶é²éé«˜
      - alert: AIDecisionHighLatency
        expr: histogram_quantile(0.95, rate(ai_decision_latency_seconds_bucket[5m])) > 0.1
        for: 2m
        labels:
          severity: critical
          component: ai-decision-engine
          subsystem: latency
        annotations:
          summary: "AIæ±ºç­–å»¶é²éé«˜"
          description: "AIæ±ºç­–å¼•æ“95%ä½å»¶é²é”åˆ° {{ printf \"%.3fs\" $value }}ï¼Œè¶…é100msé–¾å€¼"
          action_required: "æª¢æŸ¥AIæ¨¡å‹æ¨ç†æ€§èƒ½å’ŒGPUè³‡æº"

      # ğŸš¨ AIæ±ºç­–å»¶é²è­¦å‘Š
      - alert: AIDecisionModerateLatency
        expr: histogram_quantile(0.95, rate(ai_decision_latency_seconds_bucket[5m])) > 0.05
        for: 5m
        labels:
          severity: warning
          component: ai-decision-engine
          subsystem: latency
        annotations:
          summary: "AIæ±ºç­–å»¶é²åé«˜"
          description: "AIæ±ºç­–å¼•æ“95%ä½å»¶é²é”åˆ° {{ printf \"%.3fs\" $value }}ï¼Œè¶…é50msè­¦å‘Šç·š"

      # ğŸ”¥ AIæ±ºç­–éŒ¯èª¤ç‡éé«˜
      - alert: AIDecisionHighErrorRate
        expr:  < /dev/null | 
          (
            rate(ai_decision_errors_total[5m]) /
            rate(ai_decision_requests_total[5m])
          ) * 100 > 5
        for: 3m
        labels:
          severity: critical
          component: ai-decision-engine
          subsystem: errors
        annotations:
          summary: "AIæ±ºç­–éŒ¯èª¤ç‡éé«˜"
          description: "AIæ±ºç­–å¼•æ“éŒ¯èª¤ç‡é”åˆ° {{ printf \"%.1f%%\" $value }}ï¼Œè¶…é5%è‡¨ç•Œå€¼"
          action_required: "ç«‹å³æª¢æŸ¥AIæ¨¡å‹ç‹€æ…‹å’Œè¼¸å…¥æ•¸æ“šè³ªé‡"

      # ğŸš¨ AIæ±ºç­–éŒ¯èª¤ç‡è­¦å‘Š
      - alert: AIDecisionModerateErrorRate
        expr: |
          (
            rate(ai_decision_errors_total[5m]) /
            rate(ai_decision_requests_total[5m])
          ) * 100 > 1
        for: 10m
        labels:
          severity: warning
          component: ai-decision-engine
          subsystem: errors
        annotations:
          summary: "AIæ±ºç­–éŒ¯èª¤ç‡åé«˜"
          description: "AIæ±ºç­–å¼•æ“éŒ¯èª¤ç‡é”åˆ° {{ printf \"%.1f%%\" $value }}ï¼Œè¶…é1%è­¦å‘Šç·š"

      # ğŸ”¥ AIæ±ºç­–ååé‡éä½
      - alert: AIDecisionLowThroughput
        expr: rate(ai_decision_requests_total[5m]) < 10
        for: 5m
        labels:
          severity: critical
          component: ai-decision-engine
          subsystem: throughput
        annotations:
          summary: "AIæ±ºç­–ååé‡éä½"
          description: "AIæ±ºç­–å¼•æ“æ¯ç§’è™•ç†è«‹æ±‚æ•¸åƒ… {{ printf \"%.1f\" $value }}ï¼Œä½æ–¼10 RPSæœ€ä½è¦æ±‚"
          action_required: "æª¢æŸ¥AIæ±ºç­–å¼•æ“è² è¼‰å’Œè³‡æºé…ç½®"

      # ğŸš¨ AIæ±ºç­–ç½®ä¿¡åº¦éä½
      - alert: AIDecisionLowConfidence
        expr: avg_over_time(ai_decision_confidence_score[5m]) < 0.7
        for: 5m
        labels:
          severity: warning
          component: ai-decision-engine
          subsystem: confidence
        annotations:
          summary: "AIæ±ºç­–ç½®ä¿¡åº¦éä½"
          description: "AIæ±ºç­–å¹³å‡ç½®ä¿¡åº¦ {{ printf \"%.2f\" $value }}ï¼Œä½æ–¼0.7é–¾å€¼"

      # ğŸ”¥ AIæ±ºç­–æ¨¡å‹ç•°å¸¸
      - alert: AIDecisionModelAnomaly
        expr: increase(ai_decision_model_reload_total[30m]) > 3
        for: 1m
        labels:
          severity: critical
          component: ai-decision-engine
          subsystem: model
        annotations:
          summary: "AIæ±ºç­–æ¨¡å‹é »ç¹é‡è¼‰"
          description: "AIæ±ºç­–æ¨¡å‹åœ¨30åˆ†é˜å…§é‡è¼‰ {{ $value }} æ¬¡ï¼Œå¯èƒ½å­˜åœ¨æ¨¡å‹ç©©å®šæ€§å•é¡Œ"
          action_required: "æª¢æŸ¥AIæ¨¡å‹æ–‡ä»¶å®Œæ•´æ€§å’ŒåŠ è¼‰éç¨‹"

  - name: handover_performance
    interval: 15s
    rules:
      # ğŸ”¥ åˆ‡æ›æˆåŠŸç‡éä½
      - alert: HandoverSuccessRateLow
        expr: |
          (
            rate(handover_success_total[5m]) /
            (rate(handover_success_total[5m]) + rate(handover_failure_total[5m]))
          ) * 100 < 95
        for: 3m
        labels:
          severity: critical
          component: handover-system
          subsystem: success-rate
        annotations:
          summary: "åˆ‡æ›æˆåŠŸç‡éä½"
          description: "è¡›æ˜Ÿåˆ‡æ›æˆåŠŸç‡åƒ… {{ printf \"%.1f%%\" $value }}ï¼Œä½æ–¼95%è¦æ±‚"
          action_required: "æª¢æŸ¥è¡›æ˜Ÿä¿¡è™Ÿè³ªé‡å’Œåˆ‡æ›ç®—æ³•"

      # ğŸš¨ åˆ‡æ›å»¶é²éé«˜
      - alert: HandoverLatencyHigh
        expr: histogram_quantile(0.95, rate(handover_latency_seconds_bucket[5m])) > 2.0
        for: 5m
        labels:
          severity: warning
          component: handover-system
          subsystem: latency
        annotations:
          summary: "åˆ‡æ›å»¶é²éé«˜"
          description: "è¡›æ˜Ÿåˆ‡æ›95%ä½å»¶é²é”åˆ° {{ printf \"%.2fs\" $value }}ï¼Œè¶…é2ç§’é–¾å€¼"

      # ğŸ”¥ åˆ‡æ›å¤±æ•—ç‡éé«˜
      - alert: HandoverFailureRateHigh
        expr: rate(handover_failure_total[5m]) > 0.5
        for: 2m
        labels:
          severity: critical
          component: handover-system
          subsystem: failure-rate
        annotations:
          summary: "åˆ‡æ›å¤±æ•—ç‡éé«˜"
          description: "è¡›æ˜Ÿåˆ‡æ›å¤±æ•—ç‡é”åˆ° {{ printf \"%.1f\" $value }} æ¬¡/ç§’ï¼Œè¶…é0.5æ¬¡/ç§’è‡¨ç•Œå€¼"
          action_required: "ç«‹å³æª¢æŸ¥è¡›æ˜Ÿå¯ç”¨æ€§å’Œç¶²è·¯ç‹€æ…‹"

      # ğŸš¨ ä¿¡è™Ÿè³ªé‡ä¸‹é™
      - alert: SignalQualityDegraded
        expr: avg_over_time(satellite_signal_quality_score[5m]) < 0.6
        for: 5m
        labels:
          severity: warning
          component: satellite-system
          subsystem: signal-quality
        annotations:
          summary: "è¡›æ˜Ÿä¿¡è™Ÿè³ªé‡ä¸‹é™"
          description: "è¡›æ˜Ÿä¿¡è™Ÿè³ªé‡è©•åˆ† {{ printf \"%.2f\" $value }}ï¼Œä½æ–¼0.6æœ€ä½è¦æ±‚"

      # ğŸ”¥ å¯ç”¨è¡›æ˜Ÿæ•¸é‡éå°‘
      - alert: AvailableSatellitesLow
        expr: available_satellites_count < 3
        for: 2m
        labels:
          severity: critical
          component: satellite-system
          subsystem: availability
        annotations:
          summary: "å¯ç”¨è¡›æ˜Ÿæ•¸é‡éå°‘"
          description: "ç•¶å‰å¯ç”¨è¡›æ˜Ÿæ•¸é‡åƒ… {{ $value }} é¡†ï¼Œä½æ–¼3é¡†æœ€ä½è¦æ±‚"
          action_required: "æª¢æŸ¥è¡›æ˜Ÿæ˜Ÿåº§ç‹€æ…‹å’Œè»Œé“è¨ˆç®—"

  - name: rl_training_monitor
    interval: 30s
    rules:
      # ğŸ”¥ RLè¨“ç·´æ”¶æ–‚ç•°å¸¸
      - alert: RLTrainingConvergenceIssue
        expr: |
          (
            avg_over_time(rl_training_reward_mean[10m]) -
            avg_over_time(rl_training_reward_mean[10m] offset 10m)
          ) < 0.01
        for: 10m
        labels:
          severity: critical
          component: rl-training
          subsystem: convergence
        annotations:
          summary: "RLè¨“ç·´æ”¶æ–‚ç•°å¸¸"
          description: "RLè¨“ç·´å¹³å‡çå‹µåœ¨10åˆ†é˜å…§æ”¹å–„å¹…åº¦åƒ… {{ printf \"%.4f\" $value }}ï¼Œå¯èƒ½å­˜åœ¨æ”¶æ–‚å•é¡Œ"
          action_required: "æª¢æŸ¥RLè¨“ç·´åƒæ•¸å’Œç’°å¢ƒç‹€æ…‹"

      # ğŸš¨ RLè¨“ç·´æå¤±éé«˜
      - alert: RLTrainingHighLoss
        expr: avg_over_time(rl_training_loss[5m]) > 1.0
        for: 5m
        labels:
          severity: warning
          component: rl-training
          subsystem: loss
        annotations:
          summary: "RLè¨“ç·´æå¤±éé«˜"
          description: "RLè¨“ç·´å¹³å‡æå¤± {{ printf \"%.3f\" $value }}ï¼Œè¶…é1.0è­¦å‘Šç·š"

      # ğŸ”¥ RLè¨“ç·´åœæ»¯
      - alert: RLTrainingStalled
        expr: increase(rl_training_episodes_total[15m]) == 0
        for: 1m
        labels:
          severity: critical
          component: rl-training
          subsystem: progress
        annotations:
          summary: "RLè¨“ç·´åœæ»¯"
          description: "RLè¨“ç·´åœ¨15åˆ†é˜å…§æ²’æœ‰å®Œæˆä»»ä½•æ–°çš„episodesï¼Œå¯èƒ½å·²åœæ»¯"
          action_required: "æª¢æŸ¥RLè¨“ç·´é€²ç¨‹ç‹€æ…‹å’Œè³‡æºå¯ç”¨æ€§"

      # ğŸš¨ RLè¨“ç·´GPUåˆ©ç”¨ç‡éä½
      - alert: RLTrainingLowGPUUtilization
        expr: avg_over_time(rl_training_gpu_utilization_percent[5m]) < 50
        for: 5m
        labels:
          severity: warning
          component: rl-training
          subsystem: gpu
        annotations:
          summary: "RLè¨“ç·´GPUåˆ©ç”¨ç‡éä½"
          description: "RLè¨“ç·´GPUåˆ©ç”¨ç‡åƒ… {{ printf \"%.1f%%\" $value }}ï¼Œä½æ–¼50%æ•ˆç‡è­¦å‘Šç·š"

      # ğŸ”¥ RLè¨“ç·´å…§å­˜ä¸è¶³
      - alert: RLTrainingMemoryPressure
        expr: |
          (
            rl_training_memory_used_bytes /
            rl_training_memory_total_bytes
          ) * 100 > 90
        for: 2m
        labels:
          severity: critical
          component: rl-training
          subsystem: memory
        annotations:
          summary: "RLè¨“ç·´å…§å­˜å£“åŠ›"
          description: "RLè¨“ç·´å…§å­˜ä½¿ç”¨ç‡é”åˆ° {{ printf \"%.1f%%\" $value }}ï¼Œè¶…é90%è‡¨ç•Œå€¼"
          action_required: "å¢åŠ å…§å­˜é…ç½®æˆ–å„ªåŒ–è¨“ç·´æ‰¹æ¬¡å¤§å°"

  - name: ntn_network_performance
    interval: 20s
    rules:
      # ğŸ”¥ NTNç¶²è·¯ä¸ŸåŒ…ç‡éé«˜
      - alert: NTNHighPacketLoss
        expr: |
          (
            rate(ntn_packets_dropped_total[5m]) /
            rate(ntn_packets_total[5m])
          ) * 100 > 1
        for: 3m
        labels:
          severity: critical
          component: ntn-network
          subsystem: packet-loss
        annotations:
          summary: "NTNç¶²è·¯ä¸ŸåŒ…ç‡éé«˜"
          description: "NTNç¶²è·¯ä¸ŸåŒ…ç‡é”åˆ° {{ printf \"%.2f%%\" $value }}ï¼Œè¶…é1%è‡¨ç•Œå€¼"
          action_required: "æª¢æŸ¥è¡›æ˜Ÿéˆè·¯è³ªé‡å’Œç¶²è·¯é…ç½®"

      # ğŸš¨ NTNç«¯åˆ°ç«¯å»¶é²éé«˜
      - alert: NTNHighEndToEndLatency
        expr: histogram_quantile(0.95, rate(ntn_end_to_end_latency_seconds_bucket[5m])) > 0.6
        for: 5m
        labels:
          severity: warning
          component: ntn-network
          subsystem: e2e-latency
        annotations:
          summary: "NTNç«¯åˆ°ç«¯å»¶é²éé«˜"
          description: "NTNç«¯åˆ°ç«¯95%ä½å»¶é²é”åˆ° {{ printf \"%.3fs\" $value }}ï¼Œè¶…é600msè­¦å‘Šç·š"

      # ğŸ”¥ NTNååé‡éä½
      - alert: NTNLowThroughput
        expr: rate(ntn_bytes_transmitted_total[5m]) < 1024 * 1024  # 1MB/s
        for: 5m
        labels:
          severity: critical
          component: ntn-network
          subsystem: throughput
        annotations:
          summary: "NTNç¶²è·¯ååé‡éä½"
          description: "NTNç¶²è·¯å‚³è¼¸é€Ÿç‡åƒ… {{ printf \"%.2f\" $value }} bytes/sï¼Œä½æ–¼1MB/sæœ€ä½è¦æ±‚"
          action_required: "æª¢æŸ¥è¡›æ˜Ÿéˆè·¯å®¹é‡å’Œç¶²è·¯å„ªåŒ–"

      # ğŸš¨ NTNé€£æ¥ä¸ç©©å®š
      - alert: NTNConnectionInstability
        expr: rate(ntn_connection_drops_total[5m]) > 0.1
        for: 2m
        labels:
          severity: warning
          component: ntn-network
          subsystem: connection-stability
        annotations:
          summary: "NTNé€£æ¥ä¸ç©©å®š"
          description: "NTNé€£æ¥æ–·é–‹ç‡é”åˆ° {{ printf \"%.2f\" $value }} æ¬¡/ç§’ï¼Œè¶…é0.1æ¬¡/ç§’è­¦å‘Šç·š"

      # ğŸ”¥ NTNè¦†è“‹ç‡ä¸è¶³
      - alert: NTNCoverageLow
        expr: ntn_coverage_percentage < 95
        for: 3m
        labels:
          severity: critical
          component: ntn-network
          subsystem: coverage
        annotations:
          summary: "NTNè¦†è“‹ç‡ä¸è¶³"
          description: "NTNç¶²è·¯è¦†è“‹ç‡åƒ… {{ printf \"%.1f%%\" $value }}ï¼Œä½æ–¼95%æœå‹™è¦æ±‚"
          action_required: "æª¢æŸ¥è¡›æ˜Ÿæ˜Ÿåº§é…ç½®å’Œè»Œé“è¦†è“‹"

  - name: system_integration
    interval: 30s
    rules:
      # ğŸ”¥ ç³»çµ±æ•´åˆç•°å¸¸
      - alert: SystemIntegrationFailure
        expr: |
          (
            rate(system_integration_errors_total[5m]) /
            rate(system_integration_requests_total[5m])
          ) * 100 > 2
        for: 3m
        labels:
          severity: critical
          component: system-integration
          subsystem: error-rate
        annotations:
          summary: "ç³»çµ±æ•´åˆç•°å¸¸"
          description: "ç³»çµ±æ•´åˆéŒ¯èª¤ç‡é”åˆ° {{ printf \"%.1f%%\" $value }}ï¼Œè¶…é2%è‡¨ç•Œå€¼"
          action_required: "æª¢æŸ¥NetStackèˆ‡SimWorldé–“çš„APIé€šä¿¡"

      # ğŸš¨ WebSocketé€£æ¥å•é¡Œ
      - alert: WebSocketConnectionIssues
        expr: websocket_active_connections < 5
        for: 2m
        labels:
          severity: warning
          component: websocket
          subsystem: connections
        annotations:
          summary: "WebSocketé€£æ¥æ•¸éå°‘"
          description: "WebSocketæ´»èºé€£æ¥æ•¸åƒ… {{ $value }}ï¼Œä½æ–¼5å€‹æœ€ä½è¦æ±‚"

      # ğŸ”¥ ç›£æ§æ•¸æ“šä¸Ÿå¤±
      - alert: MonitoringDataLoss
        expr: |
          (
            (time() - prometheus_last_scrape_timestamp_seconds) > 120
          ) and on() up
        for: 1m
        labels:
          severity: critical
          component: monitoring
          subsystem: data-collection
        annotations:
          summary: "ç›£æ§æ•¸æ“šä¸Ÿå¤±"
          description: "ç›£æ§ç›®æ¨™ {{ $labels.instance }} è¶…é2åˆ†é˜æœªæ”¶åˆ°æ•¸æ“š"
          action_required: "æª¢æŸ¥ç›£æ§ç›®æ¨™å¯ç”¨æ€§å’Œç¶²è·¯é€£æ¥"
